import{b as mu,b9 as st,ba as t_,bb as br,bc as hr,bd as Zc,aQ as Dn,be as r_,aP as ii,bf as jl,b4 as i_}from"./index.eea9c5b1.js";import{e as lr}from"./index.5e84a666.js";import{c as n_,r as s_}from"./index.8f6a47a3.js";import{t as si}from"./tslib.f95155b7.js";const o_=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,a_=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,c_=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function u_(n,e){if(n==="__proto__"||n==="constructor"&&e&&typeof e=="object"&&"prototype"in e){h_(n);return}return e}function h_(n){console.warn(`[destr] Dropping "${n}" key to prevent prototype pollution.`)}function Uo(n,e={}){if(typeof n!="string")return n;const r=n.trim();if(n[0]==='"'&&n.at(-1)==='"'&&!n.includes("\\"))return r.slice(1,-1);if(r.length<=9){const s=r.toLowerCase();if(s==="true")return!0;if(s==="false")return!1;if(s==="undefined")return;if(s==="null")return null;if(s==="nan")return Number.NaN;if(s==="infinity")return Number.POSITIVE_INFINITY;if(s==="-infinity")return Number.NEGATIVE_INFINITY}if(!c_.test(n)){if(e.strict)throw new SyntaxError("[destr] Invalid JSON");return n}try{if(o_.test(n)||a_.test(n)){if(e.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(n,u_)}return JSON.parse(n)}catch(s){if(e.strict)throw s;return n}}function l_(n){return!n||typeof n.then!="function"?Promise.resolve(n):n}function Gt(n,...e){try{return l_(n(...e))}catch(r){return Promise.reject(r)}}function f_(n){const e=typeof n;return n===null||e!=="object"&&e!=="function"}function d_(n){const e=Object.getPrototypeOf(n);return!e||e.isPrototypeOf(Object)}function Ko(n){if(f_(n))return String(n);if(d_(n)||Array.isArray(n))return JSON.stringify(n);if(typeof n.toJSON=="function")return Ko(n.toJSON());throw new Error("[unstorage] Cannot stringify value!")}function vd(){if(typeof mu.Buffer===void 0)throw new TypeError("[unstorage] Buffer is not supported!")}const eu="base64:";function p_(n){if(typeof n=="string")return n;vd();const e=mu.Buffer.from(n).toString("base64");return eu+e}function g_(n){return typeof n!="string"||!n.startsWith(eu)?n:(vd(),mu.Buffer.from(n.slice(eu.length),"base64"))}function _r(n){return n?n.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function v_(...n){return _r(n.join(":"))}function Mo(n){return n=_r(n),n?n+":":""}const y_="memory",m_=()=>{const n=new Map;return{name:y_,options:{},hasItem(e){return n.has(e)},getItem(e){var r;return(r=n.get(e))!=null?r:null},getItemRaw(e){var r;return(r=n.get(e))!=null?r:null},setItem(e,r){n.set(e,r)},setItemRaw(e,r){n.set(e,r)},removeItem(e){n.delete(e)},getKeys(){return Array.from(n.keys())},clear(){n.clear()},dispose(){n.clear()}}};function __(n={}){const e={mounts:{"":n.driver||m_()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},r=g=>{for(const _ of e.mountpoints)if(g.startsWith(_))return{base:_,relativeKey:g.slice(_.length),driver:e.mounts[_]};return{base:"",relativeKey:g,driver:e.mounts[""]}},s=(g,_)=>e.mountpoints.filter(I=>I.startsWith(g)||_&&g.startsWith(I)).map(I=>({relativeBase:g.length>I.length?g.slice(I.length):void 0,mountpoint:I,driver:e.mounts[I]})),a=(g,_)=>{if(!!e.watching){_=_r(_);for(const I of e.watchListeners)I(g,_)}},l=async()=>{if(!e.watching){e.watching=!0;for(const g in e.mounts)e.unwatch[g]=await ql(e.mounts[g],a,g)}},p=async()=>{if(!!e.watching){for(const g in e.unwatch)await e.unwatch[g]();e.unwatch={},e.watching=!1}},f=(g,_,I)=>{const P=new Map,A=L=>{let K=P.get(L.base);return K||(K={driver:L.driver,base:L.base,items:[]},P.set(L.base,K)),K};for(const L of g){const K=typeof L=="string",B=_r(K?L:L.key),ne=K?void 0:L.value,T=K||!L.options?_:{..._,...L.options},M=r(B);A(M).items.push({key:B,value:ne,relativeKey:M.relativeKey,options:T})}return Promise.all([...P.values()].map(L=>I(L))).then(L=>L.flat())},v={hasItem(g,_={}){g=_r(g);const{relativeKey:I,driver:P}=r(g);return Gt(P.hasItem,I,_)},getItem(g,_={}){g=_r(g);const{relativeKey:I,driver:P}=r(g);return Gt(P.getItem,I,_).then(A=>Uo(A))},getItems(g,_){return f(g,_,I=>I.driver.getItems?Gt(I.driver.getItems,I.items.map(P=>({key:P.relativeKey,options:P.options})),_).then(P=>P.map(A=>({key:v_(I.base,A.key),value:Uo(A.value)}))):Promise.all(I.items.map(P=>Gt(I.driver.getItem,P.relativeKey,P.options).then(A=>({key:P.key,value:Uo(A)})))))},getItemRaw(g,_={}){g=_r(g);const{relativeKey:I,driver:P}=r(g);return P.getItemRaw?Gt(P.getItemRaw,I,_):Gt(P.getItem,I,_).then(A=>g_(A))},async setItem(g,_,I={}){if(_===void 0)return v.removeItem(g);g=_r(g);const{relativeKey:P,driver:A}=r(g);!A.setItem||(await Gt(A.setItem,P,Ko(_),I),A.watch||a("update",g))},async setItems(g,_){await f(g,_,async I=>{I.driver.setItems&&await Gt(I.driver.setItems,I.items.map(P=>({key:P.relativeKey,value:Ko(P.value),options:P.options})),_),I.driver.setItem&&await Promise.all(I.items.map(P=>Gt(I.driver.setItem,P.relativeKey,Ko(P.value),P.options)))})},async setItemRaw(g,_,I={}){if(_===void 0)return v.removeItem(g,I);g=_r(g);const{relativeKey:P,driver:A}=r(g);if(A.setItemRaw)await Gt(A.setItemRaw,P,_,I);else if(A.setItem)await Gt(A.setItem,P,p_(_),I);else return;A.watch||a("update",g)},async removeItem(g,_={}){typeof _=="boolean"&&(_={removeMeta:_}),g=_r(g);const{relativeKey:I,driver:P}=r(g);!P.removeItem||(await Gt(P.removeItem,I,_),(_.removeMeta||_.removeMata)&&await Gt(P.removeItem,I+"$",_),P.watch||a("remove",g))},async getMeta(g,_={}){typeof _=="boolean"&&(_={nativeOnly:_}),g=_r(g);const{relativeKey:I,driver:P}=r(g),A=Object.create(null);if(P.getMeta&&Object.assign(A,await Gt(P.getMeta,I,_)),!_.nativeOnly){const L=await Gt(P.getItem,I+"$",_).then(K=>Uo(K));L&&typeof L=="object"&&(typeof L.atime=="string"&&(L.atime=new Date(L.atime)),typeof L.mtime=="string"&&(L.mtime=new Date(L.mtime)),Object.assign(A,L))}return A},setMeta(g,_,I={}){return this.setItem(g+"$",_,I)},removeMeta(g,_={}){return this.removeItem(g+"$",_)},async getKeys(g,_={}){g=Mo(g);const I=s(g,!0);let P=[];const A=[];for(const L of I){const B=(await Gt(L.driver.getKeys,L.relativeBase,_)).map(ne=>L.mountpoint+_r(ne)).filter(ne=>!P.some(T=>ne.startsWith(T)));A.push(...B),P=[L.mountpoint,...P.filter(ne=>!ne.startsWith(L.mountpoint))]}return g?A.filter(L=>L.startsWith(g)&&!L.endsWith("$")):A.filter(L=>!L.endsWith("$"))},async clear(g,_={}){g=Mo(g),await Promise.all(s(g,!1).map(async I=>{if(I.driver.clear)return Gt(I.driver.clear,I.relativeBase,_);if(I.driver.removeItem){const P=await I.driver.getKeys(I.relativeBase||"",_);return Promise.all(P.map(A=>I.driver.removeItem(A,_)))}}))},async dispose(){await Promise.all(Object.values(e.mounts).map(g=>Hl(g)))},async watch(g){return await l(),e.watchListeners.push(g),async()=>{e.watchListeners=e.watchListeners.filter(_=>_!==g),e.watchListeners.length===0&&await p()}},async unwatch(){e.watchListeners=[],await p()},mount(g,_){if(g=Mo(g),g&&e.mounts[g])throw new Error(`already mounted at ${g}`);return g&&(e.mountpoints.push(g),e.mountpoints.sort((I,P)=>P.length-I.length)),e.mounts[g]=_,e.watching&&Promise.resolve(ql(_,a,g)).then(I=>{e.unwatch[g]=I}).catch(console.error),v},async unmount(g,_=!0){g=Mo(g),!(!g||!e.mounts[g])&&(e.watching&&g in e.unwatch&&(e.unwatch[g](),delete e.unwatch[g]),_&&await Hl(e.mounts[g]),e.mountpoints=e.mountpoints.filter(I=>I!==g),delete e.mounts[g])},getMount(g=""){g=_r(g)+":";const _=r(g);return{driver:_.driver,base:_.base}},getMounts(g="",_={}){return g=_r(g),s(g,_.parents).map(P=>({driver:P.driver,base:P.mountpoint}))}};return v}function ql(n,e,r){return n.watch?n.watch((s,a)=>e(s,r+a)):()=>{}}async function Hl(n){typeof n.dispose=="function"&&await Gt(n.dispose)}function cn(n){return new Promise((e,r)=>{n.oncomplete=n.onsuccess=()=>e(n.result),n.onabort=n.onerror=()=>r(n.error)})}function yd(n,e){const r=indexedDB.open(n);r.onupgradeneeded=()=>r.result.createObjectStore(e);const s=cn(r);return(a,l)=>s.then(p=>l(p.transaction(e,a).objectStore(e)))}let Cc;function Ps(){return Cc||(Cc=yd("keyval-store","keyval")),Cc}function zl(n,e=Ps()){return e("readonly",r=>cn(r.get(n)))}function w_(n,e,r=Ps()){return r("readwrite",s=>(s.put(e,n),cn(s.transaction)))}function b_(n,e=Ps()){return e("readwrite",r=>(r.delete(n),cn(r.transaction)))}function E_(n=Ps()){return n("readwrite",e=>(e.clear(),cn(e.transaction)))}function I_(n,e){return n.openCursor().onsuccess=function(){!this.result||(e(this.result),this.result.continue())},cn(n.transaction)}function S_(n=Ps()){return n("readonly",e=>{if(e.getAllKeys)return cn(e.getAllKeys());const r=[];return I_(e,s=>r.push(s.key)).then(()=>r)})}const x_=n=>JSON.stringify(n,(e,r)=>typeof r=="bigint"?r.toString()+"n":r),P_=n=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=n.replace(e,'$1"$2n"$3');return JSON.parse(r,(s,a)=>typeof a=="string"&&a.match(/^\d+n$/)?BigInt(a.substring(0,a.length-1)):a)};function Os(n){if(typeof n!="string")throw new Error(`Cannot safe json parse value of type ${typeof n}`);try{return P_(n)}catch{return n}}function an(n){return typeof n=="string"?n:x_(n)||""}const O_="idb-keyval";var A_=(n={})=>{const e=n.base&&n.base.length>0?`${n.base}:`:"",r=a=>e+a;let s;return n.dbName&&n.storeName&&(s=yd(n.dbName,n.storeName)),{name:O_,options:n,async hasItem(a){return!(typeof await zl(r(a),s)>"u")},async getItem(a){var l;return(l=await zl(r(a),s))!=null?l:null},setItem(a,l){return w_(r(a),l,s)},removeItem(a){return b_(r(a),s)},getKeys(){return S_(s)},clear(){return E_(s)}}};const N_="WALLET_CONNECT_V2_INDEXED_DB",R_="keyvaluestorage";class T_{constructor(){this.indexedDb=__({driver:A_({dbName:N_,storeName:R_})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(e=>[e.key,e.value])}async getItem(e){const r=await this.indexedDb.getItem(e);if(r!==null)return r}async setItem(e,r){await this.indexedDb.setItem(e,an(r))}async removeItem(e){await this.indexedDb.removeItem(e)}}var Lc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof st<"u"?st:typeof self<"u"?self:{},Bo={exports:{}};(function(){let n;function e(){}n=e,n.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},n.prototype.setItem=function(r,s){this[r]=String(s)},n.prototype.removeItem=function(r){delete this[r]},n.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(s){r[s]=void 0,delete r[s]})},n.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},n.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Lc<"u"&&Lc.localStorage?Bo.exports=Lc.localStorage:typeof window<"u"&&window.localStorage?Bo.exports=window.localStorage:Bo.exports=new e})();function C_(n){var e;return[n[0],Os((e=n[1])!=null?e:"")]}class L_{constructor(){this.localStorage=Bo.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(C_)}async getItem(e){const r=this.localStorage.getItem(e);if(r!==null)return Os(r)}async setItem(e,r){this.localStorage.setItem(e,an(r))}async removeItem(e){this.localStorage.removeItem(e)}}const $_="wc_storage_version",Kl=1,F_=async(n,e,r)=>{const s=$_,a=await e.getItem(s);if(a&&a>=Kl){r(e);return}const l=await n.getKeys();if(!l.length){r(e);return}const p=[];for(;l.length;){const f=l.shift();if(!f)continue;const v=f.toLowerCase();if(v.includes("wc@")||v.includes("walletconnect")||v.includes("wc_")||v.includes("wallet_connect")){const g=await n.getItem(f);await e.setItem(f,g),p.push(f)}}await e.setItem(s,Kl),r(e),D_(n,p)},D_=async(n,e)=>{e.length&&e.forEach(async r=>{await n.removeItem(r)})};class U_{constructor(){this.initialized=!1,this.setInitialized=r=>{this.storage=r,this.initialized=!0};const e=new L_;this.storage=e;try{const r=new T_;F_(e,r,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,r){return await this.initialize(),this.storage.setItem(e,r)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{const r=setInterval(()=>{this.initialized&&(clearInterval(r),e())},20)})}}var qn={},ls={},ye={},$c={},fs={},Bl;function M_(){if(Bl)return fs;Bl=1,Object.defineProperty(fs,"__esModule",{value:!0}),fs.delay=void 0;function n(e){return new Promise(r=>{setTimeout(()=>{r(!0)},e)})}return fs.delay=n,fs}var tn={},Fc={},rn={},kl;function j_(){return kl||(kl=1,Object.defineProperty(rn,"__esModule",{value:!0}),rn.ONE_THOUSAND=rn.ONE_HUNDRED=void 0,rn.ONE_HUNDRED=100,rn.ONE_THOUSAND=1e3),rn}var Dc={},Vl;function q_(){return Vl||(Vl=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.ONE_YEAR=n.FOUR_WEEKS=n.THREE_WEEKS=n.TWO_WEEKS=n.ONE_WEEK=n.THIRTY_DAYS=n.SEVEN_DAYS=n.FIVE_DAYS=n.THREE_DAYS=n.ONE_DAY=n.TWENTY_FOUR_HOURS=n.TWELVE_HOURS=n.SIX_HOURS=n.THREE_HOURS=n.ONE_HOUR=n.SIXTY_MINUTES=n.THIRTY_MINUTES=n.TEN_MINUTES=n.FIVE_MINUTES=n.ONE_MINUTE=n.SIXTY_SECONDS=n.THIRTY_SECONDS=n.TEN_SECONDS=n.FIVE_SECONDS=n.ONE_SECOND=void 0,n.ONE_SECOND=1,n.FIVE_SECONDS=5,n.TEN_SECONDS=10,n.THIRTY_SECONDS=30,n.SIXTY_SECONDS=60,n.ONE_MINUTE=n.SIXTY_SECONDS,n.FIVE_MINUTES=n.ONE_MINUTE*5,n.TEN_MINUTES=n.ONE_MINUTE*10,n.THIRTY_MINUTES=n.ONE_MINUTE*30,n.SIXTY_MINUTES=n.ONE_MINUTE*60,n.ONE_HOUR=n.SIXTY_MINUTES,n.THREE_HOURS=n.ONE_HOUR*3,n.SIX_HOURS=n.ONE_HOUR*6,n.TWELVE_HOURS=n.ONE_HOUR*12,n.TWENTY_FOUR_HOURS=n.ONE_HOUR*24,n.ONE_DAY=n.TWENTY_FOUR_HOURS,n.THREE_DAYS=n.ONE_DAY*3,n.FIVE_DAYS=n.ONE_DAY*5,n.SEVEN_DAYS=n.ONE_DAY*7,n.THIRTY_DAYS=n.ONE_DAY*30,n.ONE_WEEK=n.SEVEN_DAYS,n.TWO_WEEKS=n.ONE_WEEK*2,n.THREE_WEEKS=n.ONE_WEEK*3,n.FOUR_WEEKS=n.ONE_WEEK*4,n.ONE_YEAR=n.ONE_DAY*365}(Dc)),Dc}var Gl;function md(){return Gl||(Gl=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const e=si.exports;e.__exportStar(j_(),n),e.__exportStar(q_(),n)}(Fc)),Fc}var Wl;function H_(){if(Wl)return tn;Wl=1,Object.defineProperty(tn,"__esModule",{value:!0}),tn.fromMiliseconds=tn.toMiliseconds=void 0;const n=md();function e(s){return s*n.ONE_THOUSAND}tn.toMiliseconds=e;function r(s){return Math.floor(s/n.ONE_THOUSAND)}return tn.fromMiliseconds=r,tn}var Yl;function z_(){return Yl||(Yl=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const e=si.exports;e.__exportStar(M_(),n),e.__exportStar(H_(),n)}($c)),$c}var Ln={},Jl;function K_(){if(Jl)return Ln;Jl=1,Object.defineProperty(Ln,"__esModule",{value:!0}),Ln.Watch=void 0;class n{constructor(){this.timestamps=new Map}start(r){if(this.timestamps.has(r))throw new Error(`Watch already started for label: ${r}`);this.timestamps.set(r,{started:Date.now()})}stop(r){const s=this.get(r);if(typeof s.elapsed<"u")throw new Error(`Watch already stopped for label: ${r}`);const a=Date.now()-s.started;this.timestamps.set(r,{started:s.started,elapsed:a})}get(r){const s=this.timestamps.get(r);if(typeof s>"u")throw new Error(`No timestamp found for label: ${r}`);return s}elapsed(r){const s=this.get(r);return s.elapsed||Date.now()-s.started}}return Ln.Watch=n,Ln.default=n,Ln}var Uc={},ds={},Ql;function B_(){if(Ql)return ds;Ql=1,Object.defineProperty(ds,"__esModule",{value:!0}),ds.IWatch=void 0;class n{}return ds.IWatch=n,ds}var Xl;function k_(){return Xl||(Xl=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),si.exports.__exportStar(B_(),n)}(Uc)),Uc}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const e=si.exports;e.__exportStar(z_(),n),e.__exportStar(K_(),n),e.__exportStar(k_(),n),e.__exportStar(md(),n)})(ye);var Mc={},ps={};class un{}const V_=Object.freeze(Object.defineProperty({__proto__:null,IEvents:un},Symbol.toStringTag,{value:"Module"})),G_=t_(V_);var Zl;function W_(){if(Zl)return ps;Zl=1,Object.defineProperty(ps,"__esModule",{value:!0}),ps.IHeartBeat=void 0;const n=G_;class e extends n.IEvents{constructor(s){super()}}return ps.IHeartBeat=e,ps}var ef;function _d(){return ef||(ef=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),si.exports.__exportStar(W_(),n)}(Mc)),Mc}var jc={},nn={},tf;function Y_(){if(tf)return nn;tf=1,Object.defineProperty(nn,"__esModule",{value:!0}),nn.HEARTBEAT_EVENTS=nn.HEARTBEAT_INTERVAL=void 0;const n=ye;return nn.HEARTBEAT_INTERVAL=n.FIVE_SECONDS,nn.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},nn}var rf;function wd(){return rf||(rf=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),si.exports.__exportStar(Y_(),n)}(jc)),jc}var nf;function J_(){if(nf)return ls;nf=1,Object.defineProperty(ls,"__esModule",{value:!0}),ls.HeartBeat=void 0;const n=si.exports,e=lr.exports,r=ye,s=_d(),a=wd();class l extends s.IHeartBeat{constructor(f){super(f),this.events=new e.EventEmitter,this.interval=a.HEARTBEAT_INTERVAL,this.interval=(f==null?void 0:f.interval)||a.HEARTBEAT_INTERVAL}static init(f){return n.__awaiter(this,void 0,void 0,function*(){const v=new l(f);return yield v.init(),v})}init(){return n.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(f,v){this.events.on(f,v)}once(f,v){this.events.once(f,v)}off(f,v){this.events.off(f,v)}removeListener(f,v){this.events.removeListener(f,v)}initialize(){return n.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(a.HEARTBEAT_EVENTS.pulse)}}return ls.HeartBeat=l,ls}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const e=si.exports;e.__exportStar(J_(),n),e.__exportStar(_d(),n),e.__exportStar(wd(),n)})(qn);var Ze={},qc,sf;function Q_(){if(sf)return qc;sf=1;function n(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}qc=e;function e(r,s,a){var l=a&&a.stringify||n,p=1;if(typeof r=="object"&&r!==null){var f=s.length+p;if(f===1)return r;var v=new Array(f);v[0]=l(r);for(var g=1;g<f;g++)v[g]=l(s[g]);return v.join(" ")}if(typeof r!="string")return r;var _=s.length;if(_===0)return r;for(var I="",P=1-p,A=-1,L=r&&r.length||0,K=0;K<L;){if(r.charCodeAt(K)===37&&K+1<L){switch(A=A>-1?A:0,r.charCodeAt(K+1)){case 100:case 102:if(P>=_||s[P]==null)break;A<K&&(I+=r.slice(A,K)),I+=Number(s[P]),A=K+2,K++;break;case 105:if(P>=_||s[P]==null)break;A<K&&(I+=r.slice(A,K)),I+=Math.floor(Number(s[P])),A=K+2,K++;break;case 79:case 111:case 106:if(P>=_||s[P]===void 0)break;A<K&&(I+=r.slice(A,K));var B=typeof s[P];if(B==="string"){I+="'"+s[P]+"'",A=K+2,K++;break}if(B==="function"){I+=s[P].name||"<anonymous>",A=K+2,K++;break}I+=l(s[P]),A=K+2,K++;break;case 115:if(P>=_)break;A<K&&(I+=r.slice(A,K)),I+=String(s[P]),A=K+2,K++;break;case 37:A<K&&(I+=r.slice(A,K)),I+="%",A=K+2,K++,P--;break}++P}++K}return A===-1?r:(A<L&&(I+=r.slice(A)),I)}return qc}var Hc,of;function X_(){if(of)return Hc;of=1;const n=Q_();Hc=a;const e=R().console||{},r={mapHttpRequest:L,mapHttpResponse:L,wrapRequestSerializer:K,wrapResponseSerializer:K,wrapErrorSerializer:K,req:L,res:L,err:P};function s(b,u){return Array.isArray(b)?b.filter(function(G){return G!=="!stdSerializers.err"}):b===!0?Object.keys(u):!1}function a(b){b=b||{},b.browser=b.browser||{};const u=b.browser.transmit;if(u&&typeof u.send!="function")throw Error("pino: transmit option must have a send function");const w=b.browser.write||e;b.browser.write&&(b.browser.asObject=!0);const G=b.serializers||{},V=s(b.browser.serialize,G);let oe=b.browser.serialize;Array.isArray(b.browser.serialize)&&b.browser.serialize.indexOf("!stdSerializers.err")>-1&&(oe=!1);const ue=["error","fatal","warn","info","debug","trace"];typeof w=="function"&&(w.error=w.fatal=w.warn=w.info=w.debug=w.trace=w),b.enabled===!1&&(b.level="silent");const ge=b.level||"info",$=Object.create(w);$.log||($.log=B),Object.defineProperty($,"levelVal",{get:le}),Object.defineProperty($,"level",{get:te,set:W});const H={transmit:u,serialize:V,asObject:b.browser.asObject,levels:ue,timestamp:A(b)};$.levels=a.levels,$.level=ge,$.setMaxListeners=$.getMaxListeners=$.emit=$.addListener=$.on=$.prependListener=$.once=$.prependOnceListener=$.removeListener=$.removeAllListeners=$.listeners=$.listenerCount=$.eventNames=$.write=$.flush=B,$.serializers=G,$._serialize=V,$._stdErrSerialize=oe,$.child=ee,u&&($._logEvent=I());function le(){return this.level==="silent"?1/0:this.levels.values[this.level]}function te(){return this._level}function W(Y){if(Y!=="silent"&&!this.levels.values[Y])throw Error("unknown level "+Y);this._level=Y,l(H,$,"error","log"),l(H,$,"fatal","error"),l(H,$,"warn","error"),l(H,$,"info","log"),l(H,$,"debug","log"),l(H,$,"trace","log")}function ee(Y,re){if(!Y)throw new Error("missing bindings for child Pino");re=re||{},V&&Y.serializers&&(re.serializers=Y.serializers);const Pe=re.serializers;if(V&&Pe){var ie=Object.assign({},G,Pe),we=b.browser.serialize===!0?Object.keys(ie):V;delete Y.serializers,v([Y],we,ie,this._stdErrSerialize)}function he(me){this._childLevel=(me._childLevel|0)+1,this.error=g(me,Y,"error"),this.fatal=g(me,Y,"fatal"),this.warn=g(me,Y,"warn"),this.info=g(me,Y,"info"),this.debug=g(me,Y,"debug"),this.trace=g(me,Y,"trace"),ie&&(this.serializers=ie,this._serialize=we),u&&(this._logEvent=I([].concat(me._logEvent.bindings,Y)))}return he.prototype=this,new he(this)}return $}a.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},a.stdSerializers=r,a.stdTimeFunctions=Object.assign({},{nullTime:ne,epochTime:T,unixTime:M,isoTime:x});function l(b,u,w,G){const V=Object.getPrototypeOf(u);u[w]=u.levelVal>u.levels.values[w]?B:V[w]?V[w]:e[w]||e[G]||B,p(b,u,w)}function p(b,u,w){!b.transmit&&u[w]===B||(u[w]=function(G){return function(){const oe=b.timestamp(),ue=new Array(arguments.length),ge=Object.getPrototypeOf&&Object.getPrototypeOf(this)===e?e:this;for(var $=0;$<ue.length;$++)ue[$]=arguments[$];if(b.serialize&&!b.asObject&&v(ue,this._serialize,this.serializers,this._stdErrSerialize),b.asObject?G.call(ge,f(this,w,ue,oe)):G.apply(ge,ue),b.transmit){const H=b.transmit.level||u.level,le=a.levels.values[H],te=a.levels.values[w];if(te<le)return;_(this,{ts:oe,methodLevel:w,methodValue:te,transmitLevel:H,transmitValue:a.levels.values[b.transmit.level||u.level],send:b.transmit.send,val:u.levelVal},ue)}}}(u[w]))}function f(b,u,w,G){b._serialize&&v(w,b._serialize,b.serializers,b._stdErrSerialize);const V=w.slice();let oe=V[0];const ue={};G&&(ue.time=G),ue.level=a.levels.values[u];let ge=(b._childLevel|0)+1;if(ge<1&&(ge=1),oe!==null&&typeof oe=="object"){for(;ge--&&typeof V[0]=="object";)Object.assign(ue,V.shift());oe=V.length?n(V.shift(),V):void 0}else typeof oe=="string"&&(oe=n(V.shift(),V));return oe!==void 0&&(ue.msg=oe),ue}function v(b,u,w,G){for(const V in b)if(G&&b[V]instanceof Error)b[V]=a.stdSerializers.err(b[V]);else if(typeof b[V]=="object"&&!Array.isArray(b[V]))for(const oe in b[V])u&&u.indexOf(oe)>-1&&oe in w&&(b[V][oe]=w[oe](b[V][oe]))}function g(b,u,w){return function(){const G=new Array(1+arguments.length);G[0]=u;for(var V=1;V<G.length;V++)G[V]=arguments[V-1];return b[w].apply(this,G)}}function _(b,u,w){const G=u.send,V=u.ts,oe=u.methodLevel,ue=u.methodValue,ge=u.val,$=b._logEvent.bindings;v(w,b._serialize||Object.keys(b.serializers),b.serializers,b._stdErrSerialize===void 0?!0:b._stdErrSerialize),b._logEvent.ts=V,b._logEvent.messages=w.filter(function(H){return $.indexOf(H)===-1}),b._logEvent.level.label=oe,b._logEvent.level.value=ue,G(oe,b._logEvent,ge),b._logEvent=I($)}function I(b){return{ts:0,messages:[],bindings:b||[],level:{label:"",value:0}}}function P(b){const u={type:b.constructor.name,msg:b.message,stack:b.stack};for(const w in b)u[w]===void 0&&(u[w]=b[w]);return u}function A(b){return typeof b.timestamp=="function"?b.timestamp:b.timestamp===!1?ne:T}function L(){return{}}function K(b){return b}function B(){}function ne(){return!1}function T(){return Date.now()}function M(){return Math.round(Date.now()/1e3)}function x(){return new Date(Date.now()).toISOString()}function R(){function b(u){return typeof u<"u"&&u}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return b(self)||b(window)||b(this)||{}}}return Hc}var sn={},af;function bd(){return af||(af=1,Object.defineProperty(sn,"__esModule",{value:!0}),sn.PINO_CUSTOM_CONTEXT_KEY=sn.PINO_LOGGER_DEFAULTS=void 0,sn.PINO_LOGGER_DEFAULTS={level:"info"},sn.PINO_CUSTOM_CONTEXT_KEY="custom_context"),sn}var ar={},cf;function Z_(){if(cf)return ar;cf=1,Object.defineProperty(ar,"__esModule",{value:!0}),ar.generateChildLogger=ar.formatChildLoggerContext=ar.getLoggerContext=ar.setBrowserLoggerContext=ar.getBrowserLoggerContext=ar.getDefaultLoggerOptions=void 0;const n=bd();function e(f){return Object.assign(Object.assign({},f),{level:(f==null?void 0:f.level)||n.PINO_LOGGER_DEFAULTS.level})}ar.getDefaultLoggerOptions=e;function r(f,v=n.PINO_CUSTOM_CONTEXT_KEY){return f[v]||""}ar.getBrowserLoggerContext=r;function s(f,v,g=n.PINO_CUSTOM_CONTEXT_KEY){return f[g]=v,f}ar.setBrowserLoggerContext=s;function a(f,v=n.PINO_CUSTOM_CONTEXT_KEY){let g="";return typeof f.bindings>"u"?g=r(f,v):g=f.bindings().context||"",g}ar.getLoggerContext=a;function l(f,v,g=n.PINO_CUSTOM_CONTEXT_KEY){const _=a(f,g);return _.trim()?`${_}/${v}`:v}ar.formatChildLoggerContext=l;function p(f,v,g=n.PINO_CUSTOM_CONTEXT_KEY){const _=l(f,v,g),I=f.child({context:_});return s(I,_,g)}return ar.generateChildLogger=p,ar}(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.pino=void 0;const e=si.exports,r=e.__importDefault(X_());Object.defineProperty(n,"pino",{enumerable:!0,get:function(){return r.default}}),e.__exportStar(bd(),n),e.__exportStar(Z_(),n)})(Ze);class ew extends un{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}class tw extends un{constructor(e,r){super(),this.core=e,this.logger=r,this.records=new Map}}class rw{constructor(e,r){this.logger=e,this.core=r}}class iw extends un{constructor(e,r){super(),this.relayer=e,this.logger=r}}class nw extends un{constructor(e){super()}}class sw{constructor(e,r,s,a){this.core=e,this.logger=r,this.name=s}}class ow extends un{constructor(e,r){super(),this.relayer=e,this.logger=r}}class aw extends un{constructor(e,r){super(),this.core=e,this.logger=r}}class cw{constructor(e,r){this.projectId=e,this.logger=r}}class uw{constructor(e){this.opts=e,this.protocol="wc",this.version=2}}class hw{constructor(e){this.client=e}}var _u={},Hn={},Zo={},ea={};Object.defineProperty(ea,"__esModule",{value:!0});ea.BrowserRandomSource=void 0;const uf=65536;class lw{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues!==void 0&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const r=new Uint8Array(e);for(let s=0;s<r.length;s+=uf)this._crypto.getRandomValues(r.subarray(s,s+Math.min(r.length-s,uf)));return r}}ea.BrowserRandomSource=lw;var ta={},Nr={};Object.defineProperty(Nr,"__esModule",{value:!0});function fw(n){for(var e=0;e<n.length;e++)n[e]=0;return n}Nr.wipe=fw;Object.defineProperty(ta,"__esModule",{value:!0});ta.NodeRandomSource=void 0;const dw=Nr;class pw{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof n_<"u"){const e=s_();e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let r=this._crypto.randomBytes(e);if(r.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const s=new Uint8Array(e);for(let a=0;a<s.length;a++)s[a]=r[a];return(0,dw.wipe)(r),s}}ta.NodeRandomSource=pw;Object.defineProperty(Zo,"__esModule",{value:!0});Zo.SystemRandomSource=void 0;const gw=ea,vw=ta;class yw{constructor(){if(this.isAvailable=!1,this.name="",this._source=new gw.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new vw.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}Zo.SystemRandomSource=yw;var De={},Ed={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});function e(f,v){var g=f>>>16&65535,_=f&65535,I=v>>>16&65535,P=v&65535;return _*P+(g*P+_*I<<16>>>0)|0}n.mul=Math.imul||e;function r(f,v){return f+v|0}n.add=r;function s(f,v){return f-v|0}n.sub=s;function a(f,v){return f<<v|f>>>32-v}n.rotl=a;function l(f,v){return f<<32-v|f>>>v}n.rotr=l;function p(f){return typeof f=="number"&&isFinite(f)&&Math.floor(f)===f}n.isInteger=Number.isInteger||p,n.MAX_SAFE_INTEGER=9007199254740991,n.isSafeInteger=function(f){return n.isInteger(f)&&f>=-n.MAX_SAFE_INTEGER&&f<=n.MAX_SAFE_INTEGER}})(Ed);Object.defineProperty(De,"__esModule",{value:!0});var Id=Ed;function mw(n,e){return e===void 0&&(e=0),(n[e+0]<<8|n[e+1])<<16>>16}De.readInt16BE=mw;function _w(n,e){return e===void 0&&(e=0),(n[e+0]<<8|n[e+1])>>>0}De.readUint16BE=_w;function ww(n,e){return e===void 0&&(e=0),(n[e+1]<<8|n[e])<<16>>16}De.readInt16LE=ww;function bw(n,e){return e===void 0&&(e=0),(n[e+1]<<8|n[e])>>>0}De.readUint16LE=bw;function Sd(n,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=n>>>8,e[r+1]=n>>>0,e}De.writeUint16BE=Sd;De.writeInt16BE=Sd;function xd(n,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=n>>>0,e[r+1]=n>>>8,e}De.writeUint16LE=xd;De.writeInt16LE=xd;function tu(n,e){return e===void 0&&(e=0),n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3]}De.readInt32BE=tu;function ru(n,e){return e===void 0&&(e=0),(n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3])>>>0}De.readUint32BE=ru;function iu(n,e){return e===void 0&&(e=0),n[e+3]<<24|n[e+2]<<16|n[e+1]<<8|n[e]}De.readInt32LE=iu;function nu(n,e){return e===void 0&&(e=0),(n[e+3]<<24|n[e+2]<<16|n[e+1]<<8|n[e])>>>0}De.readUint32LE=nu;function Go(n,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=n>>>24,e[r+1]=n>>>16,e[r+2]=n>>>8,e[r+3]=n>>>0,e}De.writeUint32BE=Go;De.writeInt32BE=Go;function Wo(n,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=n>>>0,e[r+1]=n>>>8,e[r+2]=n>>>16,e[r+3]=n>>>24,e}De.writeUint32LE=Wo;De.writeInt32LE=Wo;function Ew(n,e){e===void 0&&(e=0);var r=tu(n,e),s=tu(n,e+4);return r*4294967296+s-(s>>31)*4294967296}De.readInt64BE=Ew;function Iw(n,e){e===void 0&&(e=0);var r=ru(n,e),s=ru(n,e+4);return r*4294967296+s}De.readUint64BE=Iw;function Sw(n,e){e===void 0&&(e=0);var r=iu(n,e),s=iu(n,e+4);return s*4294967296+r-(r>>31)*4294967296}De.readInt64LE=Sw;function xw(n,e){e===void 0&&(e=0);var r=nu(n,e),s=nu(n,e+4);return s*4294967296+r}De.readUint64LE=xw;function Pd(n,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),Go(n/4294967296>>>0,e,r),Go(n>>>0,e,r+4),e}De.writeUint64BE=Pd;De.writeInt64BE=Pd;function Od(n,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),Wo(n>>>0,e,r),Wo(n/4294967296>>>0,e,r+4),e}De.writeUint64LE=Od;De.writeInt64LE=Od;function Pw(n,e,r){if(r===void 0&&(r=0),n%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(n/8>e.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var s=0,a=1,l=n/8+r-1;l>=r;l--)s+=e[l]*a,a*=256;return s}De.readUintBE=Pw;function Ow(n,e,r){if(r===void 0&&(r=0),n%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(n/8>e.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var s=0,a=1,l=r;l<r+n/8;l++)s+=e[l]*a,a*=256;return s}De.readUintLE=Ow;function Aw(n,e,r,s){if(r===void 0&&(r=new Uint8Array(n/8)),s===void 0&&(s=0),n%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!Id.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var a=1,l=n/8+s-1;l>=s;l--)r[l]=e/a&255,a*=256;return r}De.writeUintBE=Aw;function Nw(n,e,r,s){if(r===void 0&&(r=new Uint8Array(n/8)),s===void 0&&(s=0),n%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!Id.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var a=1,l=s;l<s+n/8;l++)r[l]=e/a&255,a*=256;return r}De.writeUintLE=Nw;function Rw(n,e){e===void 0&&(e=0);var r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getFloat32(e)}De.readFloat32BE=Rw;function Tw(n,e){e===void 0&&(e=0);var r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getFloat32(e,!0)}De.readFloat32LE=Tw;function Cw(n,e){e===void 0&&(e=0);var r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getFloat64(e)}De.readFloat64BE=Cw;function Lw(n,e){e===void 0&&(e=0);var r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getFloat64(e,!0)}De.readFloat64LE=Lw;function $w(n,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat32(r,n),e}De.writeFloat32BE=$w;function Fw(n,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat32(r,n,!0),e}De.writeFloat32LE=Fw;function Dw(n,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat64(r,n),e}De.writeFloat64BE=Dw;function Uw(n,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat64(r,n,!0),e}De.writeFloat64LE=Uw;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.randomStringForEntropy=n.randomString=n.randomUint32=n.randomBytes=n.defaultRandomSource=void 0;const e=Zo,r=De,s=Nr;n.defaultRandomSource=new e.SystemRandomSource;function a(g,_=n.defaultRandomSource){return _.randomBytes(g)}n.randomBytes=a;function l(g=n.defaultRandomSource){const _=a(4,g),I=(0,r.readUint32LE)(_);return(0,s.wipe)(_),I}n.randomUint32=l;const p="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function f(g,_=p,I=n.defaultRandomSource){if(_.length<2)throw new Error("randomString charset is too short");if(_.length>256)throw new Error("randomString charset is too long");let P="";const A=_.length,L=256-256%A;for(;g>0;){const K=a(Math.ceil(g*256/L),I);for(let B=0;B<K.length&&g>0;B++){const ne=K[B];ne<L&&(P+=_.charAt(ne%A),g--)}(0,s.wipe)(K)}return P}n.randomString=f;function v(g,_=p,I=n.defaultRandomSource){const P=Math.ceil(g/(Math.log(_.length)/Math.LN2));return f(P,_,I)}n.randomStringForEntropy=v})(Hn);var Ad={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});var e=De,r=Nr;n.DIGEST_LENGTH=64,n.BLOCK_SIZE=128;var s=function(){function f(){this.digestLength=n.DIGEST_LENGTH,this.blockSize=n.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return f.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},f.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},f.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},f.prototype.update=function(v,g){if(g===void 0&&(g=v.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var _=0;if(this._bytesHashed+=g,this._bufferLength>0){for(;this._bufferLength<n.BLOCK_SIZE&&g>0;)this._buffer[this._bufferLength++]=v[_++],g--;this._bufferLength===this.blockSize&&(l(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(g>=this.blockSize&&(_=l(this._tempHi,this._tempLo,this._stateHi,this._stateLo,v,_,g),g%=this.blockSize);g>0;)this._buffer[this._bufferLength++]=v[_++],g--;return this},f.prototype.finish=function(v){if(!this._finished){var g=this._bytesHashed,_=this._bufferLength,I=g/536870912|0,P=g<<3,A=g%128<112?128:256;this._buffer[_]=128;for(var L=_+1;L<A-8;L++)this._buffer[L]=0;e.writeUint32BE(I,this._buffer,A-8),e.writeUint32BE(P,this._buffer,A-4),l(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,A),this._finished=!0}for(var L=0;L<this.digestLength/8;L++)e.writeUint32BE(this._stateHi[L],v,L*8),e.writeUint32BE(this._stateLo[L],v,L*8+4);return this},f.prototype.digest=function(){var v=new Uint8Array(this.digestLength);return this.finish(v),v},f.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},f.prototype.restoreState=function(v){return this._stateHi.set(v.stateHi),this._stateLo.set(v.stateLo),this._bufferLength=v.bufferLength,v.buffer&&this._buffer.set(v.buffer),this._bytesHashed=v.bytesHashed,this._finished=!1,this},f.prototype.cleanSavedState=function(v){r.wipe(v.stateHi),r.wipe(v.stateLo),v.buffer&&r.wipe(v.buffer),v.bufferLength=0,v.bytesHashed=0},f}();n.SHA512=s;var a=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function l(f,v,g,_,I,P,A){for(var L=g[0],K=g[1],B=g[2],ne=g[3],T=g[4],M=g[5],x=g[6],R=g[7],b=_[0],u=_[1],w=_[2],G=_[3],V=_[4],oe=_[5],ue=_[6],ge=_[7],$,H,le,te,W,ee,Y,re;A>=128;){for(var Pe=0;Pe<16;Pe++){var ie=8*Pe+P;f[Pe]=e.readUint32BE(I,ie),v[Pe]=e.readUint32BE(I,ie+4)}for(var Pe=0;Pe<80;Pe++){var we=L,he=K,me=B,q=ne,j=T,C=M,h=x,O=R,se=b,fe=u,Se=w,ze=G,ke=V,Ue=oe,gt=ue,vt=ge;if($=R,H=ge,W=H&65535,ee=H>>>16,Y=$&65535,re=$>>>16,$=(T>>>14|V<<32-14)^(T>>>18|V<<32-18)^(V>>>41-32|T<<32-(41-32)),H=(V>>>14|T<<32-14)^(V>>>18|T<<32-18)^(T>>>41-32|V<<32-(41-32)),W+=H&65535,ee+=H>>>16,Y+=$&65535,re+=$>>>16,$=T&M^~T&x,H=V&oe^~V&ue,W+=H&65535,ee+=H>>>16,Y+=$&65535,re+=$>>>16,$=a[Pe*2],H=a[Pe*2+1],W+=H&65535,ee+=H>>>16,Y+=$&65535,re+=$>>>16,$=f[Pe%16],H=v[Pe%16],W+=H&65535,ee+=H>>>16,Y+=$&65535,re+=$>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,le=Y&65535|re<<16,te=W&65535|ee<<16,$=le,H=te,W=H&65535,ee=H>>>16,Y=$&65535,re=$>>>16,$=(L>>>28|b<<32-28)^(b>>>34-32|L<<32-(34-32))^(b>>>39-32|L<<32-(39-32)),H=(b>>>28|L<<32-28)^(L>>>34-32|b<<32-(34-32))^(L>>>39-32|b<<32-(39-32)),W+=H&65535,ee+=H>>>16,Y+=$&65535,re+=$>>>16,$=L&K^L&B^K&B,H=b&u^b&w^u&w,W+=H&65535,ee+=H>>>16,Y+=$&65535,re+=$>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,O=Y&65535|re<<16,vt=W&65535|ee<<16,$=q,H=ze,W=H&65535,ee=H>>>16,Y=$&65535,re=$>>>16,$=le,H=te,W+=H&65535,ee+=H>>>16,Y+=$&65535,re+=$>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,q=Y&65535|re<<16,ze=W&65535|ee<<16,K=we,B=he,ne=me,T=q,M=j,x=C,R=h,L=O,u=se,w=fe,G=Se,V=ze,oe=ke,ue=Ue,ge=gt,b=vt,Pe%16===15)for(var ie=0;ie<16;ie++)$=f[ie],H=v[ie],W=H&65535,ee=H>>>16,Y=$&65535,re=$>>>16,$=f[(ie+9)%16],H=v[(ie+9)%16],W+=H&65535,ee+=H>>>16,Y+=$&65535,re+=$>>>16,le=f[(ie+1)%16],te=v[(ie+1)%16],$=(le>>>1|te<<32-1)^(le>>>8|te<<32-8)^le>>>7,H=(te>>>1|le<<32-1)^(te>>>8|le<<32-8)^(te>>>7|le<<32-7),W+=H&65535,ee+=H>>>16,Y+=$&65535,re+=$>>>16,le=f[(ie+14)%16],te=v[(ie+14)%16],$=(le>>>19|te<<32-19)^(te>>>61-32|le<<32-(61-32))^le>>>6,H=(te>>>19|le<<32-19)^(le>>>61-32|te<<32-(61-32))^(te>>>6|le<<32-6),W+=H&65535,ee+=H>>>16,Y+=$&65535,re+=$>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,f[ie]=Y&65535|re<<16,v[ie]=W&65535|ee<<16}$=L,H=b,W=H&65535,ee=H>>>16,Y=$&65535,re=$>>>16,$=g[0],H=_[0],W+=H&65535,ee+=H>>>16,Y+=$&65535,re+=$>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,g[0]=L=Y&65535|re<<16,_[0]=b=W&65535|ee<<16,$=K,H=u,W=H&65535,ee=H>>>16,Y=$&65535,re=$>>>16,$=g[1],H=_[1],W+=H&65535,ee+=H>>>16,Y+=$&65535,re+=$>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,g[1]=K=Y&65535|re<<16,_[1]=u=W&65535|ee<<16,$=B,H=w,W=H&65535,ee=H>>>16,Y=$&65535,re=$>>>16,$=g[2],H=_[2],W+=H&65535,ee+=H>>>16,Y+=$&65535,re+=$>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,g[2]=B=Y&65535|re<<16,_[2]=w=W&65535|ee<<16,$=ne,H=G,W=H&65535,ee=H>>>16,Y=$&65535,re=$>>>16,$=g[3],H=_[3],W+=H&65535,ee+=H>>>16,Y+=$&65535,re+=$>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,g[3]=ne=Y&65535|re<<16,_[3]=G=W&65535|ee<<16,$=T,H=V,W=H&65535,ee=H>>>16,Y=$&65535,re=$>>>16,$=g[4],H=_[4],W+=H&65535,ee+=H>>>16,Y+=$&65535,re+=$>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,g[4]=T=Y&65535|re<<16,_[4]=V=W&65535|ee<<16,$=M,H=oe,W=H&65535,ee=H>>>16,Y=$&65535,re=$>>>16,$=g[5],H=_[5],W+=H&65535,ee+=H>>>16,Y+=$&65535,re+=$>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,g[5]=M=Y&65535|re<<16,_[5]=oe=W&65535|ee<<16,$=x,H=ue,W=H&65535,ee=H>>>16,Y=$&65535,re=$>>>16,$=g[6],H=_[6],W+=H&65535,ee+=H>>>16,Y+=$&65535,re+=$>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,g[6]=x=Y&65535|re<<16,_[6]=ue=W&65535|ee<<16,$=R,H=ge,W=H&65535,ee=H>>>16,Y=$&65535,re=$>>>16,$=g[7],H=_[7],W+=H&65535,ee+=H>>>16,Y+=$&65535,re+=$>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,g[7]=R=Y&65535|re<<16,_[7]=ge=W&65535|ee<<16,P+=128,A-=128}return P}function p(f){var v=new s;v.update(f);var g=v.digest();return v.clean(),g}n.hash=p})(Ad);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.convertSecretKeyToX25519=n.convertPublicKeyToX25519=n.verify=n.sign=n.extractPublicKeyFromSecretKey=n.generateKeyPair=n.generateKeyPairFromSeed=n.SEED_LENGTH=n.SECRET_KEY_LENGTH=n.PUBLIC_KEY_LENGTH=n.SIGNATURE_LENGTH=void 0;const e=Hn,r=Ad,s=Nr;n.SIGNATURE_LENGTH=64,n.PUBLIC_KEY_LENGTH=32,n.SECRET_KEY_LENGTH=64,n.SEED_LENGTH=32;function a(q){const j=new Float64Array(16);if(q)for(let C=0;C<q.length;C++)j[C]=q[C];return j}const l=new Uint8Array(32);l[0]=9;const p=a(),f=a([1]),v=a([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),g=a([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),_=a([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),I=a([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),P=a([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function A(q,j){for(let C=0;C<16;C++)q[C]=j[C]|0}function L(q){let j=1;for(let C=0;C<16;C++){let h=q[C]+j+65535;j=Math.floor(h/65536),q[C]=h-j*65536}q[0]+=j-1+37*(j-1)}function K(q,j,C){const h=~(C-1);for(let O=0;O<16;O++){const se=h&(q[O]^j[O]);q[O]^=se,j[O]^=se}}function B(q,j){const C=a(),h=a();for(let O=0;O<16;O++)h[O]=j[O];L(h),L(h),L(h);for(let O=0;O<2;O++){C[0]=h[0]-65517;for(let fe=1;fe<15;fe++)C[fe]=h[fe]-65535-(C[fe-1]>>16&1),C[fe-1]&=65535;C[15]=h[15]-32767-(C[14]>>16&1);const se=C[15]>>16&1;C[14]&=65535,K(h,C,1-se)}for(let O=0;O<16;O++)q[2*O]=h[O]&255,q[2*O+1]=h[O]>>8}function ne(q,j){let C=0;for(let h=0;h<32;h++)C|=q[h]^j[h];return(1&C-1>>>8)-1}function T(q,j){const C=new Uint8Array(32),h=new Uint8Array(32);return B(C,q),B(h,j),ne(C,h)}function M(q){const j=new Uint8Array(32);return B(j,q),j[0]&1}function x(q,j){for(let C=0;C<16;C++)q[C]=j[2*C]+(j[2*C+1]<<8);q[15]&=32767}function R(q,j,C){for(let h=0;h<16;h++)q[h]=j[h]+C[h]}function b(q,j,C){for(let h=0;h<16;h++)q[h]=j[h]-C[h]}function u(q,j,C){let h,O,se=0,fe=0,Se=0,ze=0,ke=0,Ue=0,gt=0,vt=0,je=0,xe=0,Le=0,$e=0,qe=0,Ae=0,Fe=0,Ie=0,Ne=0,Ke=0,Oe=0,Ve=0,We=0,et=0,tt=0,Je=0,tr=0,fr=0,Yr=0,rr=0,oi=0,xi=0,Hi=0,It=C[0],yt=C[1],St=C[2],xt=C[3],bt=C[4],mt=C[5],Ft=C[6],Dt=C[7],Pt=C[8],Ut=C[9],Ot=C[10],Rt=C[11],At=C[12],lt=C[13],Mt=C[14],jt=C[15];h=j[0],se+=h*It,fe+=h*yt,Se+=h*St,ze+=h*xt,ke+=h*bt,Ue+=h*mt,gt+=h*Ft,vt+=h*Dt,je+=h*Pt,xe+=h*Ut,Le+=h*Ot,$e+=h*Rt,qe+=h*At,Ae+=h*lt,Fe+=h*Mt,Ie+=h*jt,h=j[1],fe+=h*It,Se+=h*yt,ze+=h*St,ke+=h*xt,Ue+=h*bt,gt+=h*mt,vt+=h*Ft,je+=h*Dt,xe+=h*Pt,Le+=h*Ut,$e+=h*Ot,qe+=h*Rt,Ae+=h*At,Fe+=h*lt,Ie+=h*Mt,Ne+=h*jt,h=j[2],Se+=h*It,ze+=h*yt,ke+=h*St,Ue+=h*xt,gt+=h*bt,vt+=h*mt,je+=h*Ft,xe+=h*Dt,Le+=h*Pt,$e+=h*Ut,qe+=h*Ot,Ae+=h*Rt,Fe+=h*At,Ie+=h*lt,Ne+=h*Mt,Ke+=h*jt,h=j[3],ze+=h*It,ke+=h*yt,Ue+=h*St,gt+=h*xt,vt+=h*bt,je+=h*mt,xe+=h*Ft,Le+=h*Dt,$e+=h*Pt,qe+=h*Ut,Ae+=h*Ot,Fe+=h*Rt,Ie+=h*At,Ne+=h*lt,Ke+=h*Mt,Oe+=h*jt,h=j[4],ke+=h*It,Ue+=h*yt,gt+=h*St,vt+=h*xt,je+=h*bt,xe+=h*mt,Le+=h*Ft,$e+=h*Dt,qe+=h*Pt,Ae+=h*Ut,Fe+=h*Ot,Ie+=h*Rt,Ne+=h*At,Ke+=h*lt,Oe+=h*Mt,Ve+=h*jt,h=j[5],Ue+=h*It,gt+=h*yt,vt+=h*St,je+=h*xt,xe+=h*bt,Le+=h*mt,$e+=h*Ft,qe+=h*Dt,Ae+=h*Pt,Fe+=h*Ut,Ie+=h*Ot,Ne+=h*Rt,Ke+=h*At,Oe+=h*lt,Ve+=h*Mt,We+=h*jt,h=j[6],gt+=h*It,vt+=h*yt,je+=h*St,xe+=h*xt,Le+=h*bt,$e+=h*mt,qe+=h*Ft,Ae+=h*Dt,Fe+=h*Pt,Ie+=h*Ut,Ne+=h*Ot,Ke+=h*Rt,Oe+=h*At,Ve+=h*lt,We+=h*Mt,et+=h*jt,h=j[7],vt+=h*It,je+=h*yt,xe+=h*St,Le+=h*xt,$e+=h*bt,qe+=h*mt,Ae+=h*Ft,Fe+=h*Dt,Ie+=h*Pt,Ne+=h*Ut,Ke+=h*Ot,Oe+=h*Rt,Ve+=h*At,We+=h*lt,et+=h*Mt,tt+=h*jt,h=j[8],je+=h*It,xe+=h*yt,Le+=h*St,$e+=h*xt,qe+=h*bt,Ae+=h*mt,Fe+=h*Ft,Ie+=h*Dt,Ne+=h*Pt,Ke+=h*Ut,Oe+=h*Ot,Ve+=h*Rt,We+=h*At,et+=h*lt,tt+=h*Mt,Je+=h*jt,h=j[9],xe+=h*It,Le+=h*yt,$e+=h*St,qe+=h*xt,Ae+=h*bt,Fe+=h*mt,Ie+=h*Ft,Ne+=h*Dt,Ke+=h*Pt,Oe+=h*Ut,Ve+=h*Ot,We+=h*Rt,et+=h*At,tt+=h*lt,Je+=h*Mt,tr+=h*jt,h=j[10],Le+=h*It,$e+=h*yt,qe+=h*St,Ae+=h*xt,Fe+=h*bt,Ie+=h*mt,Ne+=h*Ft,Ke+=h*Dt,Oe+=h*Pt,Ve+=h*Ut,We+=h*Ot,et+=h*Rt,tt+=h*At,Je+=h*lt,tr+=h*Mt,fr+=h*jt,h=j[11],$e+=h*It,qe+=h*yt,Ae+=h*St,Fe+=h*xt,Ie+=h*bt,Ne+=h*mt,Ke+=h*Ft,Oe+=h*Dt,Ve+=h*Pt,We+=h*Ut,et+=h*Ot,tt+=h*Rt,Je+=h*At,tr+=h*lt,fr+=h*Mt,Yr+=h*jt,h=j[12],qe+=h*It,Ae+=h*yt,Fe+=h*St,Ie+=h*xt,Ne+=h*bt,Ke+=h*mt,Oe+=h*Ft,Ve+=h*Dt,We+=h*Pt,et+=h*Ut,tt+=h*Ot,Je+=h*Rt,tr+=h*At,fr+=h*lt,Yr+=h*Mt,rr+=h*jt,h=j[13],Ae+=h*It,Fe+=h*yt,Ie+=h*St,Ne+=h*xt,Ke+=h*bt,Oe+=h*mt,Ve+=h*Ft,We+=h*Dt,et+=h*Pt,tt+=h*Ut,Je+=h*Ot,tr+=h*Rt,fr+=h*At,Yr+=h*lt,rr+=h*Mt,oi+=h*jt,h=j[14],Fe+=h*It,Ie+=h*yt,Ne+=h*St,Ke+=h*xt,Oe+=h*bt,Ve+=h*mt,We+=h*Ft,et+=h*Dt,tt+=h*Pt,Je+=h*Ut,tr+=h*Ot,fr+=h*Rt,Yr+=h*At,rr+=h*lt,oi+=h*Mt,xi+=h*jt,h=j[15],Ie+=h*It,Ne+=h*yt,Ke+=h*St,Oe+=h*xt,Ve+=h*bt,We+=h*mt,et+=h*Ft,tt+=h*Dt,Je+=h*Pt,tr+=h*Ut,fr+=h*Ot,Yr+=h*Rt,rr+=h*At,oi+=h*lt,xi+=h*Mt,Hi+=h*jt,se+=38*Ne,fe+=38*Ke,Se+=38*Oe,ze+=38*Ve,ke+=38*We,Ue+=38*et,gt+=38*tt,vt+=38*Je,je+=38*tr,xe+=38*fr,Le+=38*Yr,$e+=38*rr,qe+=38*oi,Ae+=38*xi,Fe+=38*Hi,O=1,h=se+O+65535,O=Math.floor(h/65536),se=h-O*65536,h=fe+O+65535,O=Math.floor(h/65536),fe=h-O*65536,h=Se+O+65535,O=Math.floor(h/65536),Se=h-O*65536,h=ze+O+65535,O=Math.floor(h/65536),ze=h-O*65536,h=ke+O+65535,O=Math.floor(h/65536),ke=h-O*65536,h=Ue+O+65535,O=Math.floor(h/65536),Ue=h-O*65536,h=gt+O+65535,O=Math.floor(h/65536),gt=h-O*65536,h=vt+O+65535,O=Math.floor(h/65536),vt=h-O*65536,h=je+O+65535,O=Math.floor(h/65536),je=h-O*65536,h=xe+O+65535,O=Math.floor(h/65536),xe=h-O*65536,h=Le+O+65535,O=Math.floor(h/65536),Le=h-O*65536,h=$e+O+65535,O=Math.floor(h/65536),$e=h-O*65536,h=qe+O+65535,O=Math.floor(h/65536),qe=h-O*65536,h=Ae+O+65535,O=Math.floor(h/65536),Ae=h-O*65536,h=Fe+O+65535,O=Math.floor(h/65536),Fe=h-O*65536,h=Ie+O+65535,O=Math.floor(h/65536),Ie=h-O*65536,se+=O-1+37*(O-1),O=1,h=se+O+65535,O=Math.floor(h/65536),se=h-O*65536,h=fe+O+65535,O=Math.floor(h/65536),fe=h-O*65536,h=Se+O+65535,O=Math.floor(h/65536),Se=h-O*65536,h=ze+O+65535,O=Math.floor(h/65536),ze=h-O*65536,h=ke+O+65535,O=Math.floor(h/65536),ke=h-O*65536,h=Ue+O+65535,O=Math.floor(h/65536),Ue=h-O*65536,h=gt+O+65535,O=Math.floor(h/65536),gt=h-O*65536,h=vt+O+65535,O=Math.floor(h/65536),vt=h-O*65536,h=je+O+65535,O=Math.floor(h/65536),je=h-O*65536,h=xe+O+65535,O=Math.floor(h/65536),xe=h-O*65536,h=Le+O+65535,O=Math.floor(h/65536),Le=h-O*65536,h=$e+O+65535,O=Math.floor(h/65536),$e=h-O*65536,h=qe+O+65535,O=Math.floor(h/65536),qe=h-O*65536,h=Ae+O+65535,O=Math.floor(h/65536),Ae=h-O*65536,h=Fe+O+65535,O=Math.floor(h/65536),Fe=h-O*65536,h=Ie+O+65535,O=Math.floor(h/65536),Ie=h-O*65536,se+=O-1+37*(O-1),q[0]=se,q[1]=fe,q[2]=Se,q[3]=ze,q[4]=ke,q[5]=Ue,q[6]=gt,q[7]=vt,q[8]=je,q[9]=xe,q[10]=Le,q[11]=$e,q[12]=qe,q[13]=Ae,q[14]=Fe,q[15]=Ie}function w(q,j){u(q,j,j)}function G(q,j){const C=a();let h;for(h=0;h<16;h++)C[h]=j[h];for(h=253;h>=0;h--)w(C,C),h!==2&&h!==4&&u(C,C,j);for(h=0;h<16;h++)q[h]=C[h]}function V(q,j){const C=a();let h;for(h=0;h<16;h++)C[h]=j[h];for(h=250;h>=0;h--)w(C,C),h!==1&&u(C,C,j);for(h=0;h<16;h++)q[h]=C[h]}function oe(q,j){const C=a(),h=a(),O=a(),se=a(),fe=a(),Se=a(),ze=a(),ke=a(),Ue=a();b(C,q[1],q[0]),b(Ue,j[1],j[0]),u(C,C,Ue),R(h,q[0],q[1]),R(Ue,j[0],j[1]),u(h,h,Ue),u(O,q[3],j[3]),u(O,O,g),u(se,q[2],j[2]),R(se,se,se),b(fe,h,C),b(Se,se,O),R(ze,se,O),R(ke,h,C),u(q[0],fe,Se),u(q[1],ke,ze),u(q[2],ze,Se),u(q[3],fe,ke)}function ue(q,j,C){for(let h=0;h<4;h++)K(q[h],j[h],C)}function ge(q,j){const C=a(),h=a(),O=a();G(O,j[2]),u(C,j[0],O),u(h,j[1],O),B(q,h),q[31]^=M(C)<<7}function $(q,j,C){A(q[0],p),A(q[1],f),A(q[2],f),A(q[3],p);for(let h=255;h>=0;--h){const O=C[h/8|0]>>(h&7)&1;ue(q,j,O),oe(j,q),oe(q,q),ue(q,j,O)}}function H(q,j){const C=[a(),a(),a(),a()];A(C[0],_),A(C[1],I),A(C[2],f),u(C[3],_,I),$(q,C,j)}function le(q){if(q.length!==n.SEED_LENGTH)throw new Error(`ed25519: seed must be ${n.SEED_LENGTH} bytes`);const j=(0,r.hash)(q);j[0]&=248,j[31]&=127,j[31]|=64;const C=new Uint8Array(32),h=[a(),a(),a(),a()];H(h,j),ge(C,h);const O=new Uint8Array(64);return O.set(q),O.set(C,32),{publicKey:C,secretKey:O}}n.generateKeyPairFromSeed=le;function te(q){const j=(0,e.randomBytes)(32,q),C=le(j);return(0,s.wipe)(j),C}n.generateKeyPair=te;function W(q){if(q.length!==n.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${n.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(q.subarray(32))}n.extractPublicKeyFromSecretKey=W;const ee=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function Y(q,j){let C,h,O,se;for(h=63;h>=32;--h){for(C=0,O=h-32,se=h-12;O<se;++O)j[O]+=C-16*j[h]*ee[O-(h-32)],C=Math.floor((j[O]+128)/256),j[O]-=C*256;j[O]+=C,j[h]=0}for(C=0,O=0;O<32;O++)j[O]+=C-(j[31]>>4)*ee[O],C=j[O]>>8,j[O]&=255;for(O=0;O<32;O++)j[O]-=C*ee[O];for(h=0;h<32;h++)j[h+1]+=j[h]>>8,q[h]=j[h]&255}function re(q){const j=new Float64Array(64);for(let C=0;C<64;C++)j[C]=q[C];for(let C=0;C<64;C++)q[C]=0;Y(q,j)}function Pe(q,j){const C=new Float64Array(64),h=[a(),a(),a(),a()],O=(0,r.hash)(q.subarray(0,32));O[0]&=248,O[31]&=127,O[31]|=64;const se=new Uint8Array(64);se.set(O.subarray(32),32);const fe=new r.SHA512;fe.update(se.subarray(32)),fe.update(j);const Se=fe.digest();fe.clean(),re(Se),H(h,Se),ge(se,h),fe.reset(),fe.update(se.subarray(0,32)),fe.update(q.subarray(32)),fe.update(j);const ze=fe.digest();re(ze);for(let ke=0;ke<32;ke++)C[ke]=Se[ke];for(let ke=0;ke<32;ke++)for(let Ue=0;Ue<32;Ue++)C[ke+Ue]+=ze[ke]*O[Ue];return Y(se.subarray(32),C),se}n.sign=Pe;function ie(q,j){const C=a(),h=a(),O=a(),se=a(),fe=a(),Se=a(),ze=a();return A(q[2],f),x(q[1],j),w(O,q[1]),u(se,O,v),b(O,O,q[2]),R(se,q[2],se),w(fe,se),w(Se,fe),u(ze,Se,fe),u(C,ze,O),u(C,C,se),V(C,C),u(C,C,O),u(C,C,se),u(C,C,se),u(q[0],C,se),w(h,q[0]),u(h,h,se),T(h,O)&&u(q[0],q[0],P),w(h,q[0]),u(h,h,se),T(h,O)?-1:(M(q[0])===j[31]>>7&&b(q[0],p,q[0]),u(q[3],q[0],q[1]),0)}function we(q,j,C){const h=new Uint8Array(32),O=[a(),a(),a(),a()],se=[a(),a(),a(),a()];if(C.length!==n.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${n.SIGNATURE_LENGTH} bytes`);if(ie(se,q))return!1;const fe=new r.SHA512;fe.update(C.subarray(0,32)),fe.update(q),fe.update(j);const Se=fe.digest();return re(Se),$(O,se,Se),H(se,C.subarray(32)),oe(O,se),ge(h,O),!ne(C,h)}n.verify=we;function he(q){let j=[a(),a(),a(),a()];if(ie(j,q))throw new Error("Ed25519: invalid public key");let C=a(),h=a(),O=j[1];R(C,f,O),b(h,f,O),G(h,h),u(C,C,h);let se=new Uint8Array(32);return B(se,C),se}n.convertPublicKeyToX25519=he;function me(q){const j=(0,r.hash)(q.subarray(0,32));j[0]&=248,j[31]&=127,j[31]|=64;const C=new Uint8Array(j.subarray(0,32));return(0,s.wipe)(j),C}n.convertSecretKeyToX25519=me})(_u);const Mw="EdDSA",jw="JWT",Nd=".",Rd="base64url",qw="utf8",Hw="utf8",zw=":",Kw="did",Bw="key",hf="base58btc",kw="z",Vw="K36",Gw=32;function Yo(n){return hr(br(an(n),qw),Rd)}function Td(n){const e=br(Vw,hf),r=kw+hr(Zc([e,n]),hf);return[Kw,Bw,r].join(zw)}function Ww(n){return hr(n,Rd)}function Yw(n){return br([Yo(n.header),Yo(n.payload)].join(Nd),Hw)}function Jw(n){return[Yo(n.header),Yo(n.payload),Ww(n.signature)].join(Nd)}function lf(n=Hn.randomBytes(Gw)){return _u.generateKeyPairFromSeed(n)}async function Qw(n,e,r,s,a=ye.fromMiliseconds(Date.now())){const l={alg:Mw,typ:jw},p=Td(s.publicKey),f=a+r,v={iss:p,sub:n,aud:e,iat:a,exp:f},g=Yw({header:l,payload:v}),_=_u.sign(s.secretKey,g);return Jw({header:l,payload:v,signature:_})}var wu={},ra={};Object.defineProperty(ra,"__esModule",{value:!0});var Zt=De,su=Nr,Xw=20;function Zw(n,e,r){for(var s=1634760805,a=857760878,l=2036477234,p=1797285236,f=r[3]<<24|r[2]<<16|r[1]<<8|r[0],v=r[7]<<24|r[6]<<16|r[5]<<8|r[4],g=r[11]<<24|r[10]<<16|r[9]<<8|r[8],_=r[15]<<24|r[14]<<16|r[13]<<8|r[12],I=r[19]<<24|r[18]<<16|r[17]<<8|r[16],P=r[23]<<24|r[22]<<16|r[21]<<8|r[20],A=r[27]<<24|r[26]<<16|r[25]<<8|r[24],L=r[31]<<24|r[30]<<16|r[29]<<8|r[28],K=e[3]<<24|e[2]<<16|e[1]<<8|e[0],B=e[7]<<24|e[6]<<16|e[5]<<8|e[4],ne=e[11]<<24|e[10]<<16|e[9]<<8|e[8],T=e[15]<<24|e[14]<<16|e[13]<<8|e[12],M=s,x=a,R=l,b=p,u=f,w=v,G=g,V=_,oe=I,ue=P,ge=A,$=L,H=K,le=B,te=ne,W=T,ee=0;ee<Xw;ee+=2)M=M+u|0,H^=M,H=H>>>32-16|H<<16,oe=oe+H|0,u^=oe,u=u>>>32-12|u<<12,x=x+w|0,le^=x,le=le>>>32-16|le<<16,ue=ue+le|0,w^=ue,w=w>>>32-12|w<<12,R=R+G|0,te^=R,te=te>>>32-16|te<<16,ge=ge+te|0,G^=ge,G=G>>>32-12|G<<12,b=b+V|0,W^=b,W=W>>>32-16|W<<16,$=$+W|0,V^=$,V=V>>>32-12|V<<12,R=R+G|0,te^=R,te=te>>>32-8|te<<8,ge=ge+te|0,G^=ge,G=G>>>32-7|G<<7,b=b+V|0,W^=b,W=W>>>32-8|W<<8,$=$+W|0,V^=$,V=V>>>32-7|V<<7,x=x+w|0,le^=x,le=le>>>32-8|le<<8,ue=ue+le|0,w^=ue,w=w>>>32-7|w<<7,M=M+u|0,H^=M,H=H>>>32-8|H<<8,oe=oe+H|0,u^=oe,u=u>>>32-7|u<<7,M=M+w|0,W^=M,W=W>>>32-16|W<<16,ge=ge+W|0,w^=ge,w=w>>>32-12|w<<12,x=x+G|0,H^=x,H=H>>>32-16|H<<16,$=$+H|0,G^=$,G=G>>>32-12|G<<12,R=R+V|0,le^=R,le=le>>>32-16|le<<16,oe=oe+le|0,V^=oe,V=V>>>32-12|V<<12,b=b+u|0,te^=b,te=te>>>32-16|te<<16,ue=ue+te|0,u^=ue,u=u>>>32-12|u<<12,R=R+V|0,le^=R,le=le>>>32-8|le<<8,oe=oe+le|0,V^=oe,V=V>>>32-7|V<<7,b=b+u|0,te^=b,te=te>>>32-8|te<<8,ue=ue+te|0,u^=ue,u=u>>>32-7|u<<7,x=x+G|0,H^=x,H=H>>>32-8|H<<8,$=$+H|0,G^=$,G=G>>>32-7|G<<7,M=M+w|0,W^=M,W=W>>>32-8|W<<8,ge=ge+W|0,w^=ge,w=w>>>32-7|w<<7;Zt.writeUint32LE(M+s|0,n,0),Zt.writeUint32LE(x+a|0,n,4),Zt.writeUint32LE(R+l|0,n,8),Zt.writeUint32LE(b+p|0,n,12),Zt.writeUint32LE(u+f|0,n,16),Zt.writeUint32LE(w+v|0,n,20),Zt.writeUint32LE(G+g|0,n,24),Zt.writeUint32LE(V+_|0,n,28),Zt.writeUint32LE(oe+I|0,n,32),Zt.writeUint32LE(ue+P|0,n,36),Zt.writeUint32LE(ge+A|0,n,40),Zt.writeUint32LE($+L|0,n,44),Zt.writeUint32LE(H+K|0,n,48),Zt.writeUint32LE(le+B|0,n,52),Zt.writeUint32LE(te+ne|0,n,56),Zt.writeUint32LE(W+T|0,n,60)}function Cd(n,e,r,s,a){if(a===void 0&&(a=0),n.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(s.length<r.length)throw new Error("ChaCha: destination is shorter than source");var l,p;if(a===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");l=new Uint8Array(16),p=l.length-e.length,l.set(e,p)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");l=e,p=a}for(var f=new Uint8Array(64),v=0;v<r.length;v+=64){Zw(f,l,n);for(var g=v;g<v+64&&g<r.length;g++)s[g]=r[g]^f[g-v];tb(l,0,p)}return su.wipe(f),a===0&&su.wipe(l),s}ra.streamXOR=Cd;function eb(n,e,r,s){return s===void 0&&(s=0),su.wipe(r),Cd(n,e,r,r,s)}ra.stream=eb;function tb(n,e,r){for(var s=1;r--;)s=s+(n[e]&255)|0,n[e]=s&255,s>>>=8,e++;if(s>0)throw new Error("ChaCha: counter overflow")}var Ld={},ji={};Object.defineProperty(ji,"__esModule",{value:!0});function rb(n,e,r){return~(n-1)&e|n-1&r}ji.select=rb;function ib(n,e){return(n|0)-(e|0)-1>>>31&1}ji.lessOrEqual=ib;function $d(n,e){if(n.length!==e.length)return 0;for(var r=0,s=0;s<n.length;s++)r|=n[s]^e[s];return 1&r-1>>>8}ji.compare=$d;function nb(n,e){return n.length===0||e.length===0?!1:$d(n,e)!==0}ji.equal=nb;(function(n){Object.defineProperty(n,"__esModule",{value:!0});var e=ji,r=Nr;n.DIGEST_LENGTH=16;var s=function(){function p(f){this.digestLength=n.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var v=f[0]|f[1]<<8;this._r[0]=v&8191;var g=f[2]|f[3]<<8;this._r[1]=(v>>>13|g<<3)&8191;var _=f[4]|f[5]<<8;this._r[2]=(g>>>10|_<<6)&7939;var I=f[6]|f[7]<<8;this._r[3]=(_>>>7|I<<9)&8191;var P=f[8]|f[9]<<8;this._r[4]=(I>>>4|P<<12)&255,this._r[5]=P>>>1&8190;var A=f[10]|f[11]<<8;this._r[6]=(P>>>14|A<<2)&8191;var L=f[12]|f[13]<<8;this._r[7]=(A>>>11|L<<5)&8065;var K=f[14]|f[15]<<8;this._r[8]=(L>>>8|K<<8)&8191,this._r[9]=K>>>5&127,this._pad[0]=f[16]|f[17]<<8,this._pad[1]=f[18]|f[19]<<8,this._pad[2]=f[20]|f[21]<<8,this._pad[3]=f[22]|f[23]<<8,this._pad[4]=f[24]|f[25]<<8,this._pad[5]=f[26]|f[27]<<8,this._pad[6]=f[28]|f[29]<<8,this._pad[7]=f[30]|f[31]<<8}return p.prototype._blocks=function(f,v,g){for(var _=this._fin?0:2048,I=this._h[0],P=this._h[1],A=this._h[2],L=this._h[3],K=this._h[4],B=this._h[5],ne=this._h[6],T=this._h[7],M=this._h[8],x=this._h[9],R=this._r[0],b=this._r[1],u=this._r[2],w=this._r[3],G=this._r[4],V=this._r[5],oe=this._r[6],ue=this._r[7],ge=this._r[8],$=this._r[9];g>=16;){var H=f[v+0]|f[v+1]<<8;I+=H&8191;var le=f[v+2]|f[v+3]<<8;P+=(H>>>13|le<<3)&8191;var te=f[v+4]|f[v+5]<<8;A+=(le>>>10|te<<6)&8191;var W=f[v+6]|f[v+7]<<8;L+=(te>>>7|W<<9)&8191;var ee=f[v+8]|f[v+9]<<8;K+=(W>>>4|ee<<12)&8191,B+=ee>>>1&8191;var Y=f[v+10]|f[v+11]<<8;ne+=(ee>>>14|Y<<2)&8191;var re=f[v+12]|f[v+13]<<8;T+=(Y>>>11|re<<5)&8191;var Pe=f[v+14]|f[v+15]<<8;M+=(re>>>8|Pe<<8)&8191,x+=Pe>>>5|_;var ie=0,we=ie;we+=I*R,we+=P*(5*$),we+=A*(5*ge),we+=L*(5*ue),we+=K*(5*oe),ie=we>>>13,we&=8191,we+=B*(5*V),we+=ne*(5*G),we+=T*(5*w),we+=M*(5*u),we+=x*(5*b),ie+=we>>>13,we&=8191;var he=ie;he+=I*b,he+=P*R,he+=A*(5*$),he+=L*(5*ge),he+=K*(5*ue),ie=he>>>13,he&=8191,he+=B*(5*oe),he+=ne*(5*V),he+=T*(5*G),he+=M*(5*w),he+=x*(5*u),ie+=he>>>13,he&=8191;var me=ie;me+=I*u,me+=P*b,me+=A*R,me+=L*(5*$),me+=K*(5*ge),ie=me>>>13,me&=8191,me+=B*(5*ue),me+=ne*(5*oe),me+=T*(5*V),me+=M*(5*G),me+=x*(5*w),ie+=me>>>13,me&=8191;var q=ie;q+=I*w,q+=P*u,q+=A*b,q+=L*R,q+=K*(5*$),ie=q>>>13,q&=8191,q+=B*(5*ge),q+=ne*(5*ue),q+=T*(5*oe),q+=M*(5*V),q+=x*(5*G),ie+=q>>>13,q&=8191;var j=ie;j+=I*G,j+=P*w,j+=A*u,j+=L*b,j+=K*R,ie=j>>>13,j&=8191,j+=B*(5*$),j+=ne*(5*ge),j+=T*(5*ue),j+=M*(5*oe),j+=x*(5*V),ie+=j>>>13,j&=8191;var C=ie;C+=I*V,C+=P*G,C+=A*w,C+=L*u,C+=K*b,ie=C>>>13,C&=8191,C+=B*R,C+=ne*(5*$),C+=T*(5*ge),C+=M*(5*ue),C+=x*(5*oe),ie+=C>>>13,C&=8191;var h=ie;h+=I*oe,h+=P*V,h+=A*G,h+=L*w,h+=K*u,ie=h>>>13,h&=8191,h+=B*b,h+=ne*R,h+=T*(5*$),h+=M*(5*ge),h+=x*(5*ue),ie+=h>>>13,h&=8191;var O=ie;O+=I*ue,O+=P*oe,O+=A*V,O+=L*G,O+=K*w,ie=O>>>13,O&=8191,O+=B*u,O+=ne*b,O+=T*R,O+=M*(5*$),O+=x*(5*ge),ie+=O>>>13,O&=8191;var se=ie;se+=I*ge,se+=P*ue,se+=A*oe,se+=L*V,se+=K*G,ie=se>>>13,se&=8191,se+=B*w,se+=ne*u,se+=T*b,se+=M*R,se+=x*(5*$),ie+=se>>>13,se&=8191;var fe=ie;fe+=I*$,fe+=P*ge,fe+=A*ue,fe+=L*oe,fe+=K*V,ie=fe>>>13,fe&=8191,fe+=B*G,fe+=ne*w,fe+=T*u,fe+=M*b,fe+=x*R,ie+=fe>>>13,fe&=8191,ie=(ie<<2)+ie|0,ie=ie+we|0,we=ie&8191,ie=ie>>>13,he+=ie,I=we,P=he,A=me,L=q,K=j,B=C,ne=h,T=O,M=se,x=fe,v+=16,g-=16}this._h[0]=I,this._h[1]=P,this._h[2]=A,this._h[3]=L,this._h[4]=K,this._h[5]=B,this._h[6]=ne,this._h[7]=T,this._h[8]=M,this._h[9]=x},p.prototype.finish=function(f,v){v===void 0&&(v=0);var g=new Uint16Array(10),_,I,P,A;if(this._leftover){for(A=this._leftover,this._buffer[A++]=1;A<16;A++)this._buffer[A]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(_=this._h[1]>>>13,this._h[1]&=8191,A=2;A<10;A++)this._h[A]+=_,_=this._h[A]>>>13,this._h[A]&=8191;for(this._h[0]+=_*5,_=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=_,_=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=_,g[0]=this._h[0]+5,_=g[0]>>>13,g[0]&=8191,A=1;A<10;A++)g[A]=this._h[A]+_,_=g[A]>>>13,g[A]&=8191;for(g[9]-=1<<13,I=(_^1)-1,A=0;A<10;A++)g[A]&=I;for(I=~I,A=0;A<10;A++)this._h[A]=this._h[A]&I|g[A];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,P=this._h[0]+this._pad[0],this._h[0]=P&65535,A=1;A<8;A++)P=(this._h[A]+this._pad[A]|0)+(P>>>16)|0,this._h[A]=P&65535;return f[v+0]=this._h[0]>>>0,f[v+1]=this._h[0]>>>8,f[v+2]=this._h[1]>>>0,f[v+3]=this._h[1]>>>8,f[v+4]=this._h[2]>>>0,f[v+5]=this._h[2]>>>8,f[v+6]=this._h[3]>>>0,f[v+7]=this._h[3]>>>8,f[v+8]=this._h[4]>>>0,f[v+9]=this._h[4]>>>8,f[v+10]=this._h[5]>>>0,f[v+11]=this._h[5]>>>8,f[v+12]=this._h[6]>>>0,f[v+13]=this._h[6]>>>8,f[v+14]=this._h[7]>>>0,f[v+15]=this._h[7]>>>8,this._finished=!0,this},p.prototype.update=function(f){var v=0,g=f.length,_;if(this._leftover){_=16-this._leftover,_>g&&(_=g);for(var I=0;I<_;I++)this._buffer[this._leftover+I]=f[v+I];if(g-=_,v+=_,this._leftover+=_,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(g>=16&&(_=g-g%16,this._blocks(f,v,_),v+=_,g-=_),g){for(var I=0;I<g;I++)this._buffer[this._leftover+I]=f[v+I];this._leftover+=g}return this},p.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var f=new Uint8Array(16);return this.finish(f),f},p.prototype.clean=function(){return r.wipe(this._buffer),r.wipe(this._r),r.wipe(this._h),r.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},p}();n.Poly1305=s;function a(p,f){var v=new s(p);v.update(f);var g=v.digest();return v.clean(),g}n.oneTimeAuth=a;function l(p,f){return p.length!==n.DIGEST_LENGTH||f.length!==n.DIGEST_LENGTH?!1:e.equal(p,f)}n.equal=l})(Ld);(function(n){Object.defineProperty(n,"__esModule",{value:!0});var e=ra,r=Ld,s=Nr,a=De,l=ji;n.KEY_LENGTH=32,n.NONCE_LENGTH=12,n.TAG_LENGTH=16;var p=new Uint8Array(16),f=function(){function v(g){if(this.nonceLength=n.NONCE_LENGTH,this.tagLength=n.TAG_LENGTH,g.length!==n.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(g)}return v.prototype.seal=function(g,_,I,P){if(g.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var A=new Uint8Array(16);A.set(g,A.length-g.length);var L=new Uint8Array(32);e.stream(this._key,A,L,4);var K=_.length+this.tagLength,B;if(P){if(P.length!==K)throw new Error("ChaCha20Poly1305: incorrect destination length");B=P}else B=new Uint8Array(K);return e.streamXOR(this._key,A,_,B,4),this._authenticate(B.subarray(B.length-this.tagLength,B.length),L,B.subarray(0,B.length-this.tagLength),I),s.wipe(A),B},v.prototype.open=function(g,_,I,P){if(g.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(_.length<this.tagLength)return null;var A=new Uint8Array(16);A.set(g,A.length-g.length);var L=new Uint8Array(32);e.stream(this._key,A,L,4);var K=new Uint8Array(this.tagLength);if(this._authenticate(K,L,_.subarray(0,_.length-this.tagLength),I),!l.equal(K,_.subarray(_.length-this.tagLength,_.length)))return null;var B=_.length-this.tagLength,ne;if(P){if(P.length!==B)throw new Error("ChaCha20Poly1305: incorrect destination length");ne=P}else ne=new Uint8Array(B);return e.streamXOR(this._key,A,_.subarray(0,_.length-this.tagLength),ne,4),s.wipe(A),ne},v.prototype.clean=function(){return s.wipe(this._key),this},v.prototype._authenticate=function(g,_,I,P){var A=new r.Poly1305(_);P&&(A.update(P),P.length%16>0&&A.update(p.subarray(P.length%16))),A.update(I),I.length%16>0&&A.update(p.subarray(I.length%16));var L=new Uint8Array(8);P&&a.writeUint64LE(P.length,L),A.update(L),a.writeUint64LE(I.length,L),A.update(L);for(var K=A.digest(),B=0;B<K.length;B++)g[B]=K[B];A.clean(),s.wipe(K),s.wipe(L)},v}();n.ChaCha20Poly1305=f})(wu);var Fd={},As={},bu={};Object.defineProperty(bu,"__esModule",{value:!0});function sb(n){return typeof n.saveState<"u"&&typeof n.restoreState<"u"&&typeof n.cleanSavedState<"u"}bu.isSerializableHash=sb;Object.defineProperty(As,"__esModule",{value:!0});var ti=bu,ob=ji,ab=Nr,Dd=function(){function n(e,r){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var s=new Uint8Array(this.blockSize);r.length>this.blockSize?this._inner.update(r).finish(s).clean():s.set(r);for(var a=0;a<s.length;a++)s[a]^=54;this._inner.update(s);for(var a=0;a<s.length;a++)s[a]^=106;this._outer.update(s),ti.isSerializableHash(this._inner)&&ti.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),ab.wipe(s)}return n.prototype.reset=function(){if(!ti.isSerializableHash(this._inner)||!ti.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},n.prototype.clean=function(){ti.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),ti.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},n.prototype.update=function(e){return this._inner.update(e),this},n.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},n.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},n.prototype.saveState=function(){if(!ti.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},n.prototype.restoreState=function(e){if(!ti.isSerializableHash(this._inner)||!ti.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},n.prototype.cleanSavedState=function(e){if(!ti.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},n}();As.HMAC=Dd;function cb(n,e,r){var s=new Dd(n,e);s.update(r);var a=s.digest();return s.clean(),a}As.hmac=cb;As.equal=ob.equal;Object.defineProperty(Fd,"__esModule",{value:!0});var ff=As,df=Nr,ub=function(){function n(e,r,s,a){s===void 0&&(s=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=a;var l=ff.hmac(this._hash,s,r);this._hmac=new ff.HMAC(e,l),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return n.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},n.prototype.expand=function(e){for(var r=new Uint8Array(e),s=0;s<r.length;s++)this._bufpos===this._buffer.length&&this._fillBuffer(),r[s]=this._buffer[this._bufpos++];return r},n.prototype.clean=function(){this._hmac.clean(),df.wipe(this._buffer),df.wipe(this._counter),this._bufpos=0},n}(),hb=Fd.HKDF=ub,ia={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});var e=De,r=Nr;n.DIGEST_LENGTH=32,n.BLOCK_SIZE=64;var s=function(){function f(){this.digestLength=n.DIGEST_LENGTH,this.blockSize=n.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return f.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},f.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},f.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._temp),this.reset()},f.prototype.update=function(v,g){if(g===void 0&&(g=v.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var _=0;if(this._bytesHashed+=g,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&g>0;)this._buffer[this._bufferLength++]=v[_++],g--;this._bufferLength===this.blockSize&&(l(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(g>=this.blockSize&&(_=l(this._temp,this._state,v,_,g),g%=this.blockSize);g>0;)this._buffer[this._bufferLength++]=v[_++],g--;return this},f.prototype.finish=function(v){if(!this._finished){var g=this._bytesHashed,_=this._bufferLength,I=g/536870912|0,P=g<<3,A=g%64<56?64:128;this._buffer[_]=128;for(var L=_+1;L<A-8;L++)this._buffer[L]=0;e.writeUint32BE(I,this._buffer,A-8),e.writeUint32BE(P,this._buffer,A-4),l(this._temp,this._state,this._buffer,0,A),this._finished=!0}for(var L=0;L<this.digestLength/4;L++)e.writeUint32BE(this._state[L],v,L*4);return this},f.prototype.digest=function(){var v=new Uint8Array(this.digestLength);return this.finish(v),v},f.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},f.prototype.restoreState=function(v){return this._state.set(v.state),this._bufferLength=v.bufferLength,v.buffer&&this._buffer.set(v.buffer),this._bytesHashed=v.bytesHashed,this._finished=!1,this},f.prototype.cleanSavedState=function(v){r.wipe(v.state),v.buffer&&r.wipe(v.buffer),v.bufferLength=0,v.bytesHashed=0},f}();n.SHA256=s;var a=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function l(f,v,g,_,I){for(;I>=64;){for(var P=v[0],A=v[1],L=v[2],K=v[3],B=v[4],ne=v[5],T=v[6],M=v[7],x=0;x<16;x++){var R=_+x*4;f[x]=e.readUint32BE(g,R)}for(var x=16;x<64;x++){var b=f[x-2],u=(b>>>17|b<<32-17)^(b>>>19|b<<32-19)^b>>>10;b=f[x-15];var w=(b>>>7|b<<32-7)^(b>>>18|b<<32-18)^b>>>3;f[x]=(u+f[x-7]|0)+(w+f[x-16]|0)}for(var x=0;x<64;x++){var u=(((B>>>6|B<<26)^(B>>>11|B<<21)^(B>>>25|B<<7))+(B&ne^~B&T)|0)+(M+(a[x]+f[x]|0)|0)|0,w=((P>>>2|P<<32-2)^(P>>>13|P<<32-13)^(P>>>22|P<<32-22))+(P&A^P&L^A&L)|0;M=T,T=ne,ne=B,B=K+u|0,K=L,L=A,A=P,P=u+w|0}v[0]+=P,v[1]+=A,v[2]+=L,v[3]+=K,v[4]+=B,v[5]+=ne,v[6]+=T,v[7]+=M,_+=64,I-=64}return _}function p(f){var v=new s;v.update(f);var g=v.digest();return v.clean(),g}n.hash=p})(ia);var Eu={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.sharedKey=n.generateKeyPair=n.generateKeyPairFromSeed=n.scalarMultBase=n.scalarMult=n.SHARED_KEY_LENGTH=n.SECRET_KEY_LENGTH=n.PUBLIC_KEY_LENGTH=void 0;const e=Hn,r=Nr;n.PUBLIC_KEY_LENGTH=32,n.SECRET_KEY_LENGTH=32,n.SHARED_KEY_LENGTH=32;function s(x){const R=new Float64Array(16);if(x)for(let b=0;b<x.length;b++)R[b]=x[b];return R}const a=new Uint8Array(32);a[0]=9;const l=s([56129,1]);function p(x){let R=1;for(let b=0;b<16;b++){let u=x[b]+R+65535;R=Math.floor(u/65536),x[b]=u-R*65536}x[0]+=R-1+37*(R-1)}function f(x,R,b){const u=~(b-1);for(let w=0;w<16;w++){const G=u&(x[w]^R[w]);x[w]^=G,R[w]^=G}}function v(x,R){const b=s(),u=s();for(let w=0;w<16;w++)u[w]=R[w];p(u),p(u),p(u);for(let w=0;w<2;w++){b[0]=u[0]-65517;for(let V=1;V<15;V++)b[V]=u[V]-65535-(b[V-1]>>16&1),b[V-1]&=65535;b[15]=u[15]-32767-(b[14]>>16&1);const G=b[15]>>16&1;b[14]&=65535,f(u,b,1-G)}for(let w=0;w<16;w++)x[2*w]=u[w]&255,x[2*w+1]=u[w]>>8}function g(x,R){for(let b=0;b<16;b++)x[b]=R[2*b]+(R[2*b+1]<<8);x[15]&=32767}function _(x,R,b){for(let u=0;u<16;u++)x[u]=R[u]+b[u]}function I(x,R,b){for(let u=0;u<16;u++)x[u]=R[u]-b[u]}function P(x,R,b){let u,w,G=0,V=0,oe=0,ue=0,ge=0,$=0,H=0,le=0,te=0,W=0,ee=0,Y=0,re=0,Pe=0,ie=0,we=0,he=0,me=0,q=0,j=0,C=0,h=0,O=0,se=0,fe=0,Se=0,ze=0,ke=0,Ue=0,gt=0,vt=0,je=b[0],xe=b[1],Le=b[2],$e=b[3],qe=b[4],Ae=b[5],Fe=b[6],Ie=b[7],Ne=b[8],Ke=b[9],Oe=b[10],Ve=b[11],We=b[12],et=b[13],tt=b[14],Je=b[15];u=R[0],G+=u*je,V+=u*xe,oe+=u*Le,ue+=u*$e,ge+=u*qe,$+=u*Ae,H+=u*Fe,le+=u*Ie,te+=u*Ne,W+=u*Ke,ee+=u*Oe,Y+=u*Ve,re+=u*We,Pe+=u*et,ie+=u*tt,we+=u*Je,u=R[1],V+=u*je,oe+=u*xe,ue+=u*Le,ge+=u*$e,$+=u*qe,H+=u*Ae,le+=u*Fe,te+=u*Ie,W+=u*Ne,ee+=u*Ke,Y+=u*Oe,re+=u*Ve,Pe+=u*We,ie+=u*et,we+=u*tt,he+=u*Je,u=R[2],oe+=u*je,ue+=u*xe,ge+=u*Le,$+=u*$e,H+=u*qe,le+=u*Ae,te+=u*Fe,W+=u*Ie,ee+=u*Ne,Y+=u*Ke,re+=u*Oe,Pe+=u*Ve,ie+=u*We,we+=u*et,he+=u*tt,me+=u*Je,u=R[3],ue+=u*je,ge+=u*xe,$+=u*Le,H+=u*$e,le+=u*qe,te+=u*Ae,W+=u*Fe,ee+=u*Ie,Y+=u*Ne,re+=u*Ke,Pe+=u*Oe,ie+=u*Ve,we+=u*We,he+=u*et,me+=u*tt,q+=u*Je,u=R[4],ge+=u*je,$+=u*xe,H+=u*Le,le+=u*$e,te+=u*qe,W+=u*Ae,ee+=u*Fe,Y+=u*Ie,re+=u*Ne,Pe+=u*Ke,ie+=u*Oe,we+=u*Ve,he+=u*We,me+=u*et,q+=u*tt,j+=u*Je,u=R[5],$+=u*je,H+=u*xe,le+=u*Le,te+=u*$e,W+=u*qe,ee+=u*Ae,Y+=u*Fe,re+=u*Ie,Pe+=u*Ne,ie+=u*Ke,we+=u*Oe,he+=u*Ve,me+=u*We,q+=u*et,j+=u*tt,C+=u*Je,u=R[6],H+=u*je,le+=u*xe,te+=u*Le,W+=u*$e,ee+=u*qe,Y+=u*Ae,re+=u*Fe,Pe+=u*Ie,ie+=u*Ne,we+=u*Ke,he+=u*Oe,me+=u*Ve,q+=u*We,j+=u*et,C+=u*tt,h+=u*Je,u=R[7],le+=u*je,te+=u*xe,W+=u*Le,ee+=u*$e,Y+=u*qe,re+=u*Ae,Pe+=u*Fe,ie+=u*Ie,we+=u*Ne,he+=u*Ke,me+=u*Oe,q+=u*Ve,j+=u*We,C+=u*et,h+=u*tt,O+=u*Je,u=R[8],te+=u*je,W+=u*xe,ee+=u*Le,Y+=u*$e,re+=u*qe,Pe+=u*Ae,ie+=u*Fe,we+=u*Ie,he+=u*Ne,me+=u*Ke,q+=u*Oe,j+=u*Ve,C+=u*We,h+=u*et,O+=u*tt,se+=u*Je,u=R[9],W+=u*je,ee+=u*xe,Y+=u*Le,re+=u*$e,Pe+=u*qe,ie+=u*Ae,we+=u*Fe,he+=u*Ie,me+=u*Ne,q+=u*Ke,j+=u*Oe,C+=u*Ve,h+=u*We,O+=u*et,se+=u*tt,fe+=u*Je,u=R[10],ee+=u*je,Y+=u*xe,re+=u*Le,Pe+=u*$e,ie+=u*qe,we+=u*Ae,he+=u*Fe,me+=u*Ie,q+=u*Ne,j+=u*Ke,C+=u*Oe,h+=u*Ve,O+=u*We,se+=u*et,fe+=u*tt,Se+=u*Je,u=R[11],Y+=u*je,re+=u*xe,Pe+=u*Le,ie+=u*$e,we+=u*qe,he+=u*Ae,me+=u*Fe,q+=u*Ie,j+=u*Ne,C+=u*Ke,h+=u*Oe,O+=u*Ve,se+=u*We,fe+=u*et,Se+=u*tt,ze+=u*Je,u=R[12],re+=u*je,Pe+=u*xe,ie+=u*Le,we+=u*$e,he+=u*qe,me+=u*Ae,q+=u*Fe,j+=u*Ie,C+=u*Ne,h+=u*Ke,O+=u*Oe,se+=u*Ve,fe+=u*We,Se+=u*et,ze+=u*tt,ke+=u*Je,u=R[13],Pe+=u*je,ie+=u*xe,we+=u*Le,he+=u*$e,me+=u*qe,q+=u*Ae,j+=u*Fe,C+=u*Ie,h+=u*Ne,O+=u*Ke,se+=u*Oe,fe+=u*Ve,Se+=u*We,ze+=u*et,ke+=u*tt,Ue+=u*Je,u=R[14],ie+=u*je,we+=u*xe,he+=u*Le,me+=u*$e,q+=u*qe,j+=u*Ae,C+=u*Fe,h+=u*Ie,O+=u*Ne,se+=u*Ke,fe+=u*Oe,Se+=u*Ve,ze+=u*We,ke+=u*et,Ue+=u*tt,gt+=u*Je,u=R[15],we+=u*je,he+=u*xe,me+=u*Le,q+=u*$e,j+=u*qe,C+=u*Ae,h+=u*Fe,O+=u*Ie,se+=u*Ne,fe+=u*Ke,Se+=u*Oe,ze+=u*Ve,ke+=u*We,Ue+=u*et,gt+=u*tt,vt+=u*Je,G+=38*he,V+=38*me,oe+=38*q,ue+=38*j,ge+=38*C,$+=38*h,H+=38*O,le+=38*se,te+=38*fe,W+=38*Se,ee+=38*ze,Y+=38*ke,re+=38*Ue,Pe+=38*gt,ie+=38*vt,w=1,u=G+w+65535,w=Math.floor(u/65536),G=u-w*65536,u=V+w+65535,w=Math.floor(u/65536),V=u-w*65536,u=oe+w+65535,w=Math.floor(u/65536),oe=u-w*65536,u=ue+w+65535,w=Math.floor(u/65536),ue=u-w*65536,u=ge+w+65535,w=Math.floor(u/65536),ge=u-w*65536,u=$+w+65535,w=Math.floor(u/65536),$=u-w*65536,u=H+w+65535,w=Math.floor(u/65536),H=u-w*65536,u=le+w+65535,w=Math.floor(u/65536),le=u-w*65536,u=te+w+65535,w=Math.floor(u/65536),te=u-w*65536,u=W+w+65535,w=Math.floor(u/65536),W=u-w*65536,u=ee+w+65535,w=Math.floor(u/65536),ee=u-w*65536,u=Y+w+65535,w=Math.floor(u/65536),Y=u-w*65536,u=re+w+65535,w=Math.floor(u/65536),re=u-w*65536,u=Pe+w+65535,w=Math.floor(u/65536),Pe=u-w*65536,u=ie+w+65535,w=Math.floor(u/65536),ie=u-w*65536,u=we+w+65535,w=Math.floor(u/65536),we=u-w*65536,G+=w-1+37*(w-1),w=1,u=G+w+65535,w=Math.floor(u/65536),G=u-w*65536,u=V+w+65535,w=Math.floor(u/65536),V=u-w*65536,u=oe+w+65535,w=Math.floor(u/65536),oe=u-w*65536,u=ue+w+65535,w=Math.floor(u/65536),ue=u-w*65536,u=ge+w+65535,w=Math.floor(u/65536),ge=u-w*65536,u=$+w+65535,w=Math.floor(u/65536),$=u-w*65536,u=H+w+65535,w=Math.floor(u/65536),H=u-w*65536,u=le+w+65535,w=Math.floor(u/65536),le=u-w*65536,u=te+w+65535,w=Math.floor(u/65536),te=u-w*65536,u=W+w+65535,w=Math.floor(u/65536),W=u-w*65536,u=ee+w+65535,w=Math.floor(u/65536),ee=u-w*65536,u=Y+w+65535,w=Math.floor(u/65536),Y=u-w*65536,u=re+w+65535,w=Math.floor(u/65536),re=u-w*65536,u=Pe+w+65535,w=Math.floor(u/65536),Pe=u-w*65536,u=ie+w+65535,w=Math.floor(u/65536),ie=u-w*65536,u=we+w+65535,w=Math.floor(u/65536),we=u-w*65536,G+=w-1+37*(w-1),x[0]=G,x[1]=V,x[2]=oe,x[3]=ue,x[4]=ge,x[5]=$,x[6]=H,x[7]=le,x[8]=te,x[9]=W,x[10]=ee,x[11]=Y,x[12]=re,x[13]=Pe,x[14]=ie,x[15]=we}function A(x,R){P(x,R,R)}function L(x,R){const b=s();for(let u=0;u<16;u++)b[u]=R[u];for(let u=253;u>=0;u--)A(b,b),u!==2&&u!==4&&P(b,b,R);for(let u=0;u<16;u++)x[u]=b[u]}function K(x,R){const b=new Uint8Array(32),u=new Float64Array(80),w=s(),G=s(),V=s(),oe=s(),ue=s(),ge=s();for(let te=0;te<31;te++)b[te]=x[te];b[31]=x[31]&127|64,b[0]&=248,g(u,R);for(let te=0;te<16;te++)G[te]=u[te];w[0]=oe[0]=1;for(let te=254;te>=0;--te){const W=b[te>>>3]>>>(te&7)&1;f(w,G,W),f(V,oe,W),_(ue,w,V),I(w,w,V),_(V,G,oe),I(G,G,oe),A(oe,ue),A(ge,w),P(w,V,w),P(V,G,ue),_(ue,w,V),I(w,w,V),A(G,w),I(V,oe,ge),P(w,V,l),_(w,w,oe),P(V,V,w),P(w,oe,ge),P(oe,G,u),A(G,ue),f(w,G,W),f(V,oe,W)}for(let te=0;te<16;te++)u[te+16]=w[te],u[te+32]=V[te],u[te+48]=G[te],u[te+64]=oe[te];const $=u.subarray(32),H=u.subarray(16);L($,$),P(H,H,$);const le=new Uint8Array(32);return v(le,H),le}n.scalarMult=K;function B(x){return K(x,a)}n.scalarMultBase=B;function ne(x){if(x.length!==n.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${n.SECRET_KEY_LENGTH} bytes`);const R=new Uint8Array(x);return{publicKey:B(R),secretKey:R}}n.generateKeyPairFromSeed=ne;function T(x){const R=(0,e.randomBytes)(32,x),b=ne(R);return(0,r.wipe)(R),b}n.generateKeyPair=T;function M(x,R,b=!1){if(x.length!==n.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(R.length!==n.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const u=K(x,R);if(b){let w=0;for(let G=0;G<u.length;G++)w|=u[G];if(w===0)throw new Error("X25519: invalid shared key")}return u}n.sharedKey=M})(Eu);var ft={};Object.defineProperty(ft,"__esModule",{value:!0});ft.getLocalStorage=ft.getLocalStorageOrThrow=ft.getCrypto=ft.getCryptoOrThrow=Md=ft.getLocation=ft.getLocationOrThrow=Iu=ft.getNavigator=ft.getNavigatorOrThrow=Ud=ft.getDocument=ft.getDocumentOrThrow=ft.getFromWindowOrThrow=ft.getFromWindow=void 0;function hn(n){let e;return typeof window<"u"&&typeof window[n]<"u"&&(e=window[n]),e}ft.getFromWindow=hn;function zn(n){const e=hn(n);if(!e)throw new Error(`${n} is not defined in Window`);return e}ft.getFromWindowOrThrow=zn;function lb(){return zn("document")}ft.getDocumentOrThrow=lb;function fb(){return hn("document")}var Ud=ft.getDocument=fb;function db(){return zn("navigator")}ft.getNavigatorOrThrow=db;function pb(){return hn("navigator")}var Iu=ft.getNavigator=pb;function gb(){return zn("location")}ft.getLocationOrThrow=gb;function vb(){return hn("location")}var Md=ft.getLocation=vb;function yb(){return zn("crypto")}ft.getCryptoOrThrow=yb;function mb(){return hn("crypto")}ft.getCrypto=mb;function _b(){return zn("localStorage")}ft.getLocalStorageOrThrow=_b;function wb(){return hn("localStorage")}ft.getLocalStorage=wb;var Su={};Object.defineProperty(Su,"__esModule",{value:!0});var jd=Su.getWindowMetadata=void 0;const pf=ft;function bb(){let n,e;try{n=pf.getDocumentOrThrow(),e=pf.getLocationOrThrow()}catch{return null}function r(){const I=n.getElementsByTagName("link"),P=[];for(let A=0;A<I.length;A++){const L=I[A],K=L.getAttribute("rel");if(K&&K.toLowerCase().indexOf("icon")>-1){const B=L.getAttribute("href");if(B)if(B.toLowerCase().indexOf("https:")===-1&&B.toLowerCase().indexOf("http:")===-1&&B.indexOf("//")!==0){let ne=e.protocol+"//"+e.host;if(B.indexOf("/")===0)ne+=B;else{const T=e.pathname.split("/");T.pop();const M=T.join("/");ne+=M+"/"+B}P.push(ne)}else if(B.indexOf("//")===0){const ne=e.protocol+B;P.push(ne)}else P.push(B)}}return P}function s(...I){const P=n.getElementsByTagName("meta");for(let A=0;A<P.length;A++){const L=P[A],K=["itemprop","property","name"].map(B=>L.getAttribute(B)).filter(B=>B?I.includes(B):!1);if(K.length&&K){const B=L.getAttribute("content");if(B)return B}}return""}function a(){let I=s("name","og:site_name","og:title","twitter:title");return I||(I=n.title),I}function l(){return s("description","og:description","twitter:description","keywords")}const p=a(),f=l(),v=e.origin,g=r();return{description:f,url:v,icons:g,name:p}}jd=Su.getWindowMetadata=bb;var Ss={},Eb=n=>encodeURIComponent(n).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),qd="%[a-f0-9]{2}",gf=new RegExp("("+qd+")|([^%]+?)","gi"),vf=new RegExp("("+qd+")+","gi");function ou(n,e){try{return[decodeURIComponent(n.join(""))]}catch{}if(n.length===1)return n;e=e||1;var r=n.slice(0,e),s=n.slice(e);return Array.prototype.concat.call([],ou(r),ou(s))}function Ib(n){try{return decodeURIComponent(n)}catch{for(var e=n.match(gf)||[],r=1;r<e.length;r++)n=ou(e,r).join(""),e=n.match(gf)||[];return n}}function Sb(n){for(var e={"%FE%FF":"\uFFFD\uFFFD","%FF%FE":"\uFFFD\uFFFD"},r=vf.exec(n);r;){try{e[r[0]]=decodeURIComponent(r[0])}catch{var s=Ib(r[0]);s!==r[0]&&(e[r[0]]=s)}r=vf.exec(n)}e["%C2"]="\uFFFD";for(var a=Object.keys(e),l=0;l<a.length;l++){var p=a[l];n=n.replace(new RegExp(p,"g"),e[p])}return n}var xb=function(n){if(typeof n!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof n+"`");try{return n=n.replace(/\+/g," "),decodeURIComponent(n)}catch{return Sb(n)}},Pb=(n,e)=>{if(!(typeof n=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(e==="")return[n];const r=n.indexOf(e);return r===-1?[n]:[n.slice(0,r),n.slice(r+e.length)]},Ob=function(n,e){for(var r={},s=Object.keys(n),a=Array.isArray(e),l=0;l<s.length;l++){var p=s[l],f=n[p];(a?e.indexOf(p)!==-1:e(p,f,n))&&(r[p]=f)}return r};(function(n){const e=Eb,r=xb,s=Pb,a=Ob,l=T=>T==null,p=Symbol("encodeFragmentIdentifier");function f(T){switch(T.arrayFormat){case"index":return M=>(x,R)=>{const b=x.length;return R===void 0||T.skipNull&&R===null||T.skipEmptyString&&R===""?x:R===null?[...x,[_(M,T),"[",b,"]"].join("")]:[...x,[_(M,T),"[",_(b,T),"]=",_(R,T)].join("")]};case"bracket":return M=>(x,R)=>R===void 0||T.skipNull&&R===null||T.skipEmptyString&&R===""?x:R===null?[...x,[_(M,T),"[]"].join("")]:[...x,[_(M,T),"[]=",_(R,T)].join("")];case"colon-list-separator":return M=>(x,R)=>R===void 0||T.skipNull&&R===null||T.skipEmptyString&&R===""?x:R===null?[...x,[_(M,T),":list="].join("")]:[...x,[_(M,T),":list=",_(R,T)].join("")];case"comma":case"separator":case"bracket-separator":{const M=T.arrayFormat==="bracket-separator"?"[]=":"=";return x=>(R,b)=>b===void 0||T.skipNull&&b===null||T.skipEmptyString&&b===""?R:(b=b===null?"":b,R.length===0?[[_(x,T),M,_(b,T)].join("")]:[[R,_(b,T)].join(T.arrayFormatSeparator)])}default:return M=>(x,R)=>R===void 0||T.skipNull&&R===null||T.skipEmptyString&&R===""?x:R===null?[...x,_(M,T)]:[...x,[_(M,T),"=",_(R,T)].join("")]}}function v(T){let M;switch(T.arrayFormat){case"index":return(x,R,b)=>{if(M=/\[(\d*)\]$/.exec(x),x=x.replace(/\[\d*\]$/,""),!M){b[x]=R;return}b[x]===void 0&&(b[x]={}),b[x][M[1]]=R};case"bracket":return(x,R,b)=>{if(M=/(\[\])$/.exec(x),x=x.replace(/\[\]$/,""),!M){b[x]=R;return}if(b[x]===void 0){b[x]=[R];return}b[x]=[].concat(b[x],R)};case"colon-list-separator":return(x,R,b)=>{if(M=/(:list)$/.exec(x),x=x.replace(/:list$/,""),!M){b[x]=R;return}if(b[x]===void 0){b[x]=[R];return}b[x]=[].concat(b[x],R)};case"comma":case"separator":return(x,R,b)=>{const u=typeof R=="string"&&R.includes(T.arrayFormatSeparator),w=typeof R=="string"&&!u&&I(R,T).includes(T.arrayFormatSeparator);R=w?I(R,T):R;const G=u||w?R.split(T.arrayFormatSeparator).map(V=>I(V,T)):R===null?R:I(R,T);b[x]=G};case"bracket-separator":return(x,R,b)=>{const u=/(\[\])$/.test(x);if(x=x.replace(/\[\]$/,""),!u){b[x]=R&&I(R,T);return}const w=R===null?[]:R.split(T.arrayFormatSeparator).map(G=>I(G,T));if(b[x]===void 0){b[x]=w;return}b[x]=[].concat(b[x],w)};default:return(x,R,b)=>{if(b[x]===void 0){b[x]=R;return}b[x]=[].concat(b[x],R)}}}function g(T){if(typeof T!="string"||T.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function _(T,M){return M.encode?M.strict?e(T):encodeURIComponent(T):T}function I(T,M){return M.decode?r(T):T}function P(T){return Array.isArray(T)?T.sort():typeof T=="object"?P(Object.keys(T)).sort((M,x)=>Number(M)-Number(x)).map(M=>T[M]):T}function A(T){const M=T.indexOf("#");return M!==-1&&(T=T.slice(0,M)),T}function L(T){let M="";const x=T.indexOf("#");return x!==-1&&(M=T.slice(x)),M}function K(T){T=A(T);const M=T.indexOf("?");return M===-1?"":T.slice(M+1)}function B(T,M){return M.parseNumbers&&!Number.isNaN(Number(T))&&typeof T=="string"&&T.trim()!==""?T=Number(T):M.parseBooleans&&T!==null&&(T.toLowerCase()==="true"||T.toLowerCase()==="false")&&(T=T.toLowerCase()==="true"),T}function ne(T,M){M=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},M),g(M.arrayFormatSeparator);const x=v(M),R=Object.create(null);if(typeof T!="string"||(T=T.trim().replace(/^[?#&]/,""),!T))return R;for(const b of T.split("&")){if(b==="")continue;let[u,w]=s(M.decode?b.replace(/\+/g," "):b,"=");w=w===void 0?null:["comma","separator","bracket-separator"].includes(M.arrayFormat)?w:I(w,M),x(I(u,M),w,R)}for(const b of Object.keys(R)){const u=R[b];if(typeof u=="object"&&u!==null)for(const w of Object.keys(u))u[w]=B(u[w],M);else R[b]=B(u,M)}return M.sort===!1?R:(M.sort===!0?Object.keys(R).sort():Object.keys(R).sort(M.sort)).reduce((b,u)=>{const w=R[u];return Boolean(w)&&typeof w=="object"&&!Array.isArray(w)?b[u]=P(w):b[u]=w,b},Object.create(null))}n.extract=K,n.parse=ne,n.stringify=(T,M)=>{if(!T)return"";M=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},M),g(M.arrayFormatSeparator);const x=w=>M.skipNull&&l(T[w])||M.skipEmptyString&&T[w]==="",R=f(M),b={};for(const w of Object.keys(T))x(w)||(b[w]=T[w]);const u=Object.keys(b);return M.sort!==!1&&u.sort(M.sort),u.map(w=>{const G=T[w];return G===void 0?"":G===null?_(w,M):Array.isArray(G)?G.length===0&&M.arrayFormat==="bracket-separator"?_(w,M)+"[]":G.reduce(R(w),[]).join("&"):_(w,M)+"="+_(G,M)}).filter(w=>w.length>0).join("&")},n.parseUrl=(T,M)=>{M=Object.assign({decode:!0},M);const[x,R]=s(T,"#");return Object.assign({url:x.split("?")[0]||"",query:ne(K(T),M)},M&&M.parseFragmentIdentifier&&R?{fragmentIdentifier:I(R,M)}:{})},n.stringifyUrl=(T,M)=>{M=Object.assign({encode:!0,strict:!0,[p]:!0},M);const x=A(T.url).split("?")[0]||"",R=n.extract(T.url),b=n.parse(R,{sort:!1}),u=Object.assign(b,T.query);let w=n.stringify(u,M);w&&(w=`?${w}`);let G=L(T.url);return T.fragmentIdentifier&&(G=`#${M[p]?_(T.fragmentIdentifier,M):T.fragmentIdentifier}`),`${x}${w}${G}`},n.pick=(T,M,x)=>{x=Object.assign({parseFragmentIdentifier:!0,[p]:!1},x);const{url:R,query:b,fragmentIdentifier:u}=n.parseUrl(T,x);return n.stringifyUrl({url:R,query:a(b,M),fragmentIdentifier:u},x)},n.exclude=(T,M,x)=>{const R=Array.isArray(M)?b=>!M.includes(b):(b,u)=>!M(b,u);return n.pick(T,R,x)}})(Ss);const Ab={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}},Nb=":";function Rb(n){const[e,r]=n.split(Nb);return{namespace:e,reference:r}}function Tb(n,e=[]){const r=[];return Object.keys(n).forEach(s=>{if(e.length&&!e.includes(s))return;const a=n[s];r.push(...a.accounts)}),r}function Hd(n,e){return n.includes(":")?[n]:e.chains||[]}const zd="base10",ur="base16",au="base64pad",xu="utf8",Kd=0,ln=1,Cb=0,yf=1,cu=12,Pu=32;function Lb(){const n=Eu.generateKeyPair();return{privateKey:hr(n.secretKey,ur),publicKey:hr(n.publicKey,ur)}}function uu(){const n=Hn.randomBytes(Pu);return hr(n,ur)}function $b(n,e){const r=Eu.sharedKey(br(n,ur),br(e,ur),!0),s=new hb(ia.SHA256,r).expand(Pu);return hr(s,ur)}function Fb(n){const e=ia.hash(br(n,ur));return hr(e,ur)}function Un(n){const e=ia.hash(br(n,xu));return hr(e,ur)}function Db(n){return br(`${n}`,zd)}function Ns(n){return Number(hr(n,zd))}function Ub(n){const e=Db(typeof n.type<"u"?n.type:Kd);if(Ns(e)===ln&&typeof n.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof n.senderPublicKey<"u"?br(n.senderPublicKey,ur):void 0,s=typeof n.iv<"u"?br(n.iv,ur):Hn.randomBytes(cu),a=new wu.ChaCha20Poly1305(br(n.symKey,ur)).seal(s,br(n.message,xu));return jb({type:e,sealed:a,iv:s,senderPublicKey:r})}function Mb(n){const e=new wu.ChaCha20Poly1305(br(n.symKey,ur)),{sealed:r,iv:s}=Jo(n.encoded),a=e.open(s,r);if(a===null)throw new Error("Failed to decrypt");return hr(a,xu)}function jb(n){if(Ns(n.type)===ln){if(typeof n.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return hr(Zc([n.type,n.senderPublicKey,n.iv,n.sealed]),au)}return hr(Zc([n.type,n.iv,n.sealed]),au)}function Jo(n){const e=br(n,au),r=e.slice(Cb,yf),s=yf;if(Ns(r)===ln){const f=s+Pu,v=f+cu,g=e.slice(s,f),_=e.slice(f,v),I=e.slice(v);return{type:r,sealed:I,iv:_,senderPublicKey:g}}const a=s+cu,l=e.slice(s,a),p=e.slice(a);return{type:r,sealed:p,iv:l}}function qb(n,e){const r=Jo(n);return Bd({type:Ns(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?hr(r.senderPublicKey,ur):void 0,receiverPublicKey:e==null?void 0:e.receiverPublicKey})}function Bd(n){const e=(n==null?void 0:n.type)||Kd;if(e===ln){if(typeof(n==null?void 0:n.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(n==null?void 0:n.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:n==null?void 0:n.senderPublicKey,receiverPublicKey:n==null?void 0:n.receiverPublicKey}}function mf(n){return n.type===ln&&typeof n.senderPublicKey=="string"&&typeof n.receiverPublicKey=="string"}var Hb=Object.defineProperty,_f=Object.getOwnPropertySymbols,zb=Object.prototype.hasOwnProperty,Kb=Object.prototype.propertyIsEnumerable,wf=(n,e,r)=>e in n?Hb(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,bf=(n,e)=>{for(var r in e||(e={}))zb.call(e,r)&&wf(n,r,e[r]);if(_f)for(var r of _f(e))Kb.call(e,r)&&wf(n,r,e[r]);return n};const Bb="ReactNative",Ar={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},kb="js";function Ou(){return typeof Dn.exports<"u"&&typeof Dn.exports.versions<"u"&&typeof Dn.exports.versions.node<"u"}function Kn(){return!Ud()&&!!Iu()&&navigator.product===Bb}function Bn(){return!Ou()&&!!Iu()}function Rs(){return Kn()?Ar.reactNative:Ou()?Ar.node:Bn()?Ar.browser:Ar.unknown}function Vb(){var n;try{return Kn()&&typeof st<"u"&&typeof(st==null?void 0:st.Application)<"u"?(n=st.Application)==null?void 0:n.applicationId:void 0}catch{return}}function Gb(n,e){let r=Ss.parse(n);return r=bf(bf({},r),e),n=Ss.stringify(r),n}function Wb(){return jd()||{name:"",description:"",url:"",icons:[""]}}function Yb(){if(Rs()===Ar.reactNative&&typeof st<"u"&&typeof(st==null?void 0:st.Platform)<"u"){const{OS:r,Version:s}=st.Platform;return[r,s].join("-")}const n=r_();if(n===null)return"unknown";const e=n.os?n.os.replace(" ","").toLowerCase():"unknown";return n.type==="browser"?[e,n.name,n.version].join("-"):[e,n.version].join("-")}function Jb(){var n;const e=Rs();return e===Ar.browser?[e,((n=Md())==null?void 0:n.host)||"unknown"].join(":"):e}function Qb(n,e,r){const s=Yb(),a=Jb();return[[n,e].join("-"),[kb,r].join("-"),s,a].join("/")}function Xb({protocol:n,version:e,relayUrl:r,sdkVersion:s,auth:a,projectId:l,useOnCloseEvent:p,bundleId:f}){const v=r.split("?"),g=Qb(n,e,s),_={auth:a,ua:g,projectId:l,useOnCloseEvent:p||void 0,origin:f||void 0},I=Gb(v[1]||"",_);return v[0]+"?"+I}function on(n,e){return n.filter(r=>e.includes(r)).length===n.length}function kd(n){return Object.fromEntries(n.entries())}function Vd(n){return new Map(Object.entries(n))}function $n(n=ye.FIVE_MINUTES,e){const r=ye.toMiliseconds(n||ye.FIVE_MINUTES);let s,a,l;return{resolve:p=>{l&&s&&(clearTimeout(l),s(p))},reject:p=>{l&&a&&(clearTimeout(l),a(p))},done:()=>new Promise((p,f)=>{l=setTimeout(()=>{f(new Error(e))},r),s=p,a=f})}}function xs(n,e,r){return new Promise(async(s,a)=>{const l=setTimeout(()=>a(new Error(r)),e);try{const p=await n;s(p)}catch(p){a(p)}clearTimeout(l)})}function Gd(n,e){if(typeof e=="string"&&e.startsWith(`${n}:`))return e;if(n.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(n.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${n}`)}function Zb(n){return Gd("topic",n)}function eE(n){return Gd("id",n)}function Wd(n){const[e,r]=n.split(":"),s={id:void 0,topic:void 0};if(e==="topic"&&typeof r=="string")s.topic=r;else if(e==="id"&&Number.isInteger(Number(r)))s.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${r}`);return s}function Gr(n,e){return ye.fromMiliseconds((e||Date.now())+ye.toMiliseconds(n))}function Di(n){return Date.now()>=ye.toMiliseconds(n)}function zt(n,e){return`${n}${e?`:${e}`:""}`}function zc(n=[],e=[]){return[...new Set([...n,...e])]}async function tE({id:n,topic:e,wcDeepLink:r}){try{if(!r)return;const s=typeof r=="string"?JSON.parse(r):r;let a=s==null?void 0:s.href;if(typeof a!="string")return;a.endsWith("/")&&(a=a.slice(0,-1));const l=`${a}/wc?requestId=${n}&sessionTopic=${e}`,p=Rs();p===Ar.browser?l.startsWith("https://")?window.open(l,"_blank","noreferrer noopener"):window.open(l,"_self","noreferrer noopener"):p===Ar.reactNative&&typeof(st==null?void 0:st.Linking)<"u"&&await st.Linking.openURL(l)}catch(s){console.error(s)}}async function rE(n,e){try{return await n.getItem(e)||(Bn()?localStorage.getItem(e):void 0)}catch(r){console.error(r)}}const iE="irn";function hu(n){return(n==null?void 0:n.relay)||{protocol:iE}}function ko(n){const e=Ab[n];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${n}`);return e}var nE=Object.defineProperty,Ef=Object.getOwnPropertySymbols,sE=Object.prototype.hasOwnProperty,oE=Object.prototype.propertyIsEnumerable,If=(n,e,r)=>e in n?nE(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,aE=(n,e)=>{for(var r in e||(e={}))sE.call(e,r)&&If(n,r,e[r]);if(Ef)for(var r of Ef(e))oE.call(e,r)&&If(n,r,e[r]);return n};function cE(n,e="-"){const r={},s="relay"+e;return Object.keys(n).forEach(a=>{if(a.startsWith(s)){const l=a.replace(s,""),p=n[a];r[l]=p}}),r}function Sf(n){n=n.includes("wc://")?n.replace("wc://",""):n,n=n.includes("wc:")?n.replace("wc:",""):n;const e=n.indexOf(":"),r=n.indexOf("?")!==-1?n.indexOf("?"):void 0,s=n.substring(0,e),a=n.substring(e+1,r).split("@"),l=typeof r<"u"?n.substring(r):"",p=Ss.parse(l);return{protocol:s,topic:uE(a[0]),version:parseInt(a[1],10),symKey:p.symKey,relay:cE(p)}}function uE(n){return n.startsWith("//")?n.substring(2):n}function hE(n,e="-"){const r="relay",s={};return Object.keys(n).forEach(a=>{const l=r+e+a;n[a]&&(s[l]=n[a])}),s}function lE(n){return`${n.protocol}:${n.topic}@${n.version}?`+Ss.stringify(aE({symKey:n.symKey},hE(n.relay)))}function kn(n){const e=[];return n.forEach(r=>{const[s,a]=r.split(":");e.push(`${s}:${a}`)}),e}function fE(n){const e=[];return Object.values(n).forEach(r=>{e.push(...kn(r.accounts))}),e}function dE(n,e){const r=[];return Object.values(n).forEach(s=>{kn(s.accounts).includes(e)&&r.push(...s.methods)}),r}function pE(n,e){const r=[];return Object.values(n).forEach(s=>{kn(s.accounts).includes(e)&&r.push(...s.events)}),r}function gE(n,e){const r=Vo(n,e);if(r)throw new Error(r.message);const s={};for(const[a,l]of Object.entries(n))s[a]={methods:l.methods,events:l.events,chains:l.accounts.map(p=>`${p.split(":")[0]}:${p.split(":")[1]}`)};return s}function Au(n){return n.includes(":")}function ws(n){return Au(n)?n.split(":")[0]:n}const vE={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},yE={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function ae(n,e){const{message:r,code:s}=yE[n];return{message:e?`${r} ${e}`:r,code:s}}function $t(n,e){const{message:r,code:s}=vE[n];return{message:e?`${r} ${e}`:r,code:s}}function ni(n,e){return Array.isArray(n)?typeof e<"u"&&n.length?n.every(e):!0:!1}function Mn(n){return Object.getPrototypeOf(n)===Object.prototype&&Object.keys(n).length}function cr(n){return typeof n>"u"}function Wt(n,e){return e&&cr(n)?!0:typeof n=="string"&&!!n.trim().length}function Nu(n,e){return e&&cr(n)?!0:typeof n=="number"&&!isNaN(n)}function mE(n,e){const{requiredNamespaces:r}=e,s=Object.keys(n.namespaces),a=Object.keys(r);let l=!0;return on(a,s)?(s.forEach(p=>{const{accounts:f,methods:v,events:g}=n.namespaces[p],_=kn(f),I=r[p];(!on(Hd(p,I),_)||!on(I.methods,v)||!on(I.events,g))&&(l=!1)}),l):!1}function Qo(n){return Wt(n,!1)&&n.includes(":")?n.split(":").length===2:!1}function _E(n){if(Wt(n,!1)&&n.includes(":")){const e=n.split(":");if(e.length===3){const r=e[0]+":"+e[1];return!!e[2]&&Qo(r)}}return!1}function wE(n){if(Wt(n,!1))try{return typeof new URL(n)<"u"}catch{return!1}return!1}function bE(n){var e;return(e=n==null?void 0:n.proposer)==null?void 0:e.publicKey}function EE(n){return n==null?void 0:n.topic}function IE(n,e){let r=null;return Wt(n==null?void 0:n.publicKey,!1)||(r=ae("MISSING_OR_INVALID",`${e} controller public key should be a string`)),r}function xf(n){let e=!0;return ni(n)?n.length&&(e=n.every(r=>Wt(r,!1))):e=!1,e}function SE(n,e,r){let s=null;return ni(e)&&e.length?e.forEach(a=>{s||Qo(a)||(s=$t("UNSUPPORTED_CHAINS",`${r}, chain ${a} should be a string and conform to "namespace:chainId" format`))}):Qo(n)||(s=$t("UNSUPPORTED_CHAINS",`${r}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),s}function xE(n,e,r){let s=null;return Object.entries(n).forEach(([a,l])=>{if(s)return;const p=SE(a,Hd(a,l),`${e} ${r}`);p&&(s=p)}),s}function PE(n,e){let r=null;return ni(n)?n.forEach(s=>{r||_E(s)||(r=$t("UNSUPPORTED_ACCOUNTS",`${e}, account ${s} should be a string and conform to "namespace:chainId:address" format`))}):r=$t("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function OE(n,e){let r=null;return Object.values(n).forEach(s=>{if(r)return;const a=PE(s==null?void 0:s.accounts,`${e} namespace`);a&&(r=a)}),r}function AE(n,e){let r=null;return xf(n==null?void 0:n.methods)?xf(n==null?void 0:n.events)||(r=$t("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):r=$t("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),r}function Yd(n,e){let r=null;return Object.values(n).forEach(s=>{if(r)return;const a=AE(s,`${e}, namespace`);a&&(r=a)}),r}function NE(n,e,r){let s=null;if(n&&Mn(n)){const a=Yd(n,e);a&&(s=a);const l=xE(n,e,r);l&&(s=l)}else s=ae("MISSING_OR_INVALID",`${e}, ${r} should be an object with data`);return s}function Vo(n,e){let r=null;if(n&&Mn(n)){const s=Yd(n,e);s&&(r=s);const a=OE(n,e);a&&(r=a)}else r=ae("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return r}function Jd(n){return Wt(n.protocol,!0)}function RE(n,e){let r=!1;return e&&!n?r=!0:n&&ni(n)&&n.length&&n.forEach(s=>{r=Jd(s)}),r}function TE(n){return typeof n=="number"}function wr(n){return typeof n<"u"&&typeof n!==null}function CE(n){return!(!n||typeof n!="object"||!n.code||!Nu(n.code,!1)||!n.message||!Wt(n.message,!1))}function LE(n){return!(cr(n)||!Wt(n.method,!1))}function $E(n){return!(cr(n)||cr(n.result)&&cr(n.error)||!Nu(n.id,!1)||!Wt(n.jsonrpc,!1))}function FE(n){return!(cr(n)||!Wt(n.name,!1))}function Pf(n,e){return!(!Qo(e)||!fE(n).includes(e))}function DE(n,e,r){return Wt(r,!1)?dE(n,e).includes(r):!1}function UE(n,e,r){return Wt(r,!1)?pE(n,e).includes(r):!1}function Of(n,e,r){let s=null;const a=ME(n),l=jE(e),p=Object.keys(a),f=Object.keys(l),v=Af(Object.keys(n)),g=Af(Object.keys(e)),_=v.filter(I=>!g.includes(I));return _.length&&(s=ae("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${_.toString()}
      Received: ${Object.keys(e).toString()}`)),on(p,f)||(s=ae("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${p.toString()}
      Approved: ${f.toString()}`)),Object.keys(e).forEach(I=>{if(!I.includes(":")||s)return;const P=kn(e[I].accounts);P.includes(I)||(s=ae("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${I}
        Required: ${I}
        Approved: ${P.toString()}`))}),p.forEach(I=>{s||(on(a[I].methods,l[I].methods)?on(a[I].events,l[I].events)||(s=ae("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${I}`)):s=ae("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${I}`))}),s}function ME(n){const e={};return Object.keys(n).forEach(r=>{var s;r.includes(":")?e[r]=n[r]:(s=n[r].chains)==null||s.forEach(a=>{e[a]={methods:n[r].methods,events:n[r].events}})}),e}function Af(n){return[...new Set(n.map(e=>e.includes(":")?e.split(":")[0]:e))]}function jE(n){const e={};return Object.keys(n).forEach(r=>{if(r.includes(":"))e[r]=n[r];else{const s=kn(n[r].accounts);s==null||s.forEach(a=>{e[a]={accounts:n[r].accounts.filter(l=>l.includes(`${a}:`)),methods:n[r].methods,events:n[r].events}})}}),e}function qE(n,e){return Nu(n,!1)&&n<=e.max&&n>=e.min}function Nf(){const n=Rs();return new Promise(e=>{switch(n){case Ar.browser:e(HE());break;case Ar.reactNative:e(zE());break;case Ar.node:e(KE());break;default:e(!0)}})}function HE(){return Bn()&&(navigator==null?void 0:navigator.onLine)}async function zE(){if(Kn()&&typeof st<"u"&&st!=null&&st.NetInfo){const n=await(st==null?void 0:st.NetInfo.fetch());return n==null?void 0:n.isConnected}return!0}function KE(){return!0}function BE(n){switch(Rs()){case Ar.browser:kE(n);break;case Ar.reactNative:VE(n);break}}function kE(n){!Kn()&&Bn()&&(window.addEventListener("online",()=>n(!0)),window.addEventListener("offline",()=>n(!1)))}function VE(n){var e;Kn()&&typeof st<"u"&&st!=null&&st.NetInfo&&((e=st)==null||e.NetInfo.addEventListener(r=>n(r==null?void 0:r.isConnected)))}const Kc={};class jo{static get(e){return Kc[e]}static set(e,r){Kc[e]=r}static delete(e){delete Kc[e]}}const GE="PARSE_ERROR",WE="INVALID_REQUEST",YE="METHOD_NOT_FOUND",JE="INVALID_PARAMS",Qd="INTERNAL_ERROR",Ru="SERVER_ERROR",QE=[-32700,-32600,-32601,-32602,-32603],Is={[GE]:{code:-32700,message:"Parse error"},[WE]:{code:-32600,message:"Invalid Request"},[YE]:{code:-32601,message:"Method not found"},[JE]:{code:-32602,message:"Invalid params"},[Qd]:{code:-32603,message:"Internal error"},[Ru]:{code:-32e3,message:"Server error"}},Xd=Ru;function XE(n){return QE.includes(n)}function Rf(n){return Object.keys(Is).includes(n)?Is[n]:Is[Xd]}function ZE(n){const e=Object.values(Is).find(r=>r.code===n);return e||Is[Xd]}function Zd(n,e,r){return n.message.includes("getaddrinfo ENOTFOUND")||n.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${e}`):n}var ep={},mi={},Tf;function e6(){if(Tf)return mi;Tf=1,Object.defineProperty(mi,"__esModule",{value:!0}),mi.isBrowserCryptoAvailable=mi.getSubtleCrypto=mi.getBrowerCrypto=void 0;function n(){return(ii===null||ii===void 0?void 0:ii.crypto)||(ii===null||ii===void 0?void 0:ii.msCrypto)||{}}mi.getBrowerCrypto=n;function e(){const s=n();return s.subtle||s.webkitSubtle}mi.getSubtleCrypto=e;function r(){return!!n()&&!!e()}return mi.isBrowserCryptoAvailable=r,mi}var _i={},Cf;function t6(){if(Cf)return _i;Cf=1,Object.defineProperty(_i,"__esModule",{value:!0}),_i.isBrowser=_i.isNode=_i.isReactNative=void 0;function n(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}_i.isReactNative=n;function e(){return typeof Dn.exports<"u"&&typeof Dn.exports.versions<"u"&&typeof Dn.exports.versions.node<"u"}_i.isNode=e;function r(){return!n()&&!e()}return _i.isBrowser=r,_i}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const e=si.exports;e.__exportStar(e6(),n),e.__exportStar(t6(),n)})(ep);function Tu(n=3){const e=Date.now()*Math.pow(10,n),r=Math.floor(Math.random()*Math.pow(10,n));return e+r}function tp(n=6){return BigInt(Tu(n))}function jn(n,e,r){return{id:r||Tu(),jsonrpc:"2.0",method:n,params:e}}function Cu(n,e){return{id:n,jsonrpc:"2.0",result:e}}function na(n,e,r){return{id:n,jsonrpc:"2.0",error:r6(e,r)}}function r6(n,e){return typeof n>"u"?Rf(Qd):(typeof n=="string"&&(n=Object.assign(Object.assign({},Rf(Ru)),{message:n})),typeof e<"u"&&(n.data=e),XE(n.code)&&(n=ZE(n.code)),n)}class i6{}class n6 extends i6{constructor(){super()}}class s6 extends n6{constructor(e){super()}}const o6="^https?:",a6="^wss?:";function c6(n){const e=n.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function rp(n,e){const r=c6(n);return typeof r>"u"?!1:new RegExp(e).test(r)}function Lf(n){return rp(n,o6)}function $f(n){return rp(n,a6)}function u6(n){return new RegExp("wss?://localhost(:d{2,5})?").test(n)}function ip(n){return typeof n=="object"&&"id"in n&&"jsonrpc"in n&&n.jsonrpc==="2.0"}function Lu(n){return ip(n)&&"method"in n}function sa(n){return ip(n)&&(Ei(n)||Wr(n))}function Ei(n){return"result"in n}function Wr(n){return"error"in n}class Ii extends s6{constructor(e){super(e),this.events=new lr.exports.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async request(e,r){return this.requestStrict(jn(e.method,e.params||[],e.id||tp().toString()),r)}async requestStrict(e,r){return new Promise(async(s,a)=>{if(!this.connection.connected)try{await this.open()}catch(l){a(l)}this.events.on(`${e.id}`,l=>{Wr(l)?a(l.error):s(l.result)});try{await this.connection.send(e,r)}catch(l){a(l)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),sa(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const h6=()=>typeof WebSocket<"u"?WebSocket:typeof st<"u"&&typeof st.WebSocket<"u"?st.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),l6=()=>typeof WebSocket<"u"||typeof st<"u"&&typeof st.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",Ff=n=>n.split("?")[0],Df=10,f6=h6();class d6{constructor(e){if(this.url=e,this.events=new lr.exports.EventEmitter,this.registering=!1,!$f(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=s=>{this.onClose(s),e()},this.socket.close()})}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(an(e))}catch(r){this.onError(e.id,r)}}register(e=this.url){if(!$f(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((s,a)=>{this.events.once("register_error",l=>{this.resetMaxListeners(),a(l)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return a(new Error("WebSocket connection is missing or invalid"));s(this.socket)})})}return this.url=e,this.registering=!0,new Promise((r,s)=>{const a=new URLSearchParams(e).get("origin"),l=ep.isReactNative()?{headers:{origin:a}}:{rejectUnauthorized:!u6(e)},p=new f6(e,[],l);l6()?p.onerror=f=>{const v=f;s(this.emitError(v.error))}:p.on("error",f=>{s(this.emitError(f))}),p.onopen=()=>{this.onOpen(p),r(p)}})}onOpen(e){e.onmessage=r=>this.onPayload(r),e.onclose=r=>this.onClose(r),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?Os(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const s=this.parseError(r),a=s.message||s.toString(),l=na(e,a);this.events.emit("payload",l)}parseError(e,r=this.url){return Zd(e,Ff(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>Df&&this.events.setMaxListeners(Df)}emitError(e){const r=this.parseError(new Error((e==null?void 0:e.message)||`WebSocket connection failed for host: ${Ff(this.url)}`));return this.events.emit("register_error",r),r}}var lu={exports:{}};(function(n,e){var r=200,s="__lodash_hash_undefined__",a=1,l=2,p=9007199254740991,f="[object Arguments]",v="[object Array]",g="[object AsyncFunction]",_="[object Boolean]",I="[object Date]",P="[object Error]",A="[object Function]",L="[object GeneratorFunction]",K="[object Map]",B="[object Number]",ne="[object Null]",T="[object Object]",M="[object Promise]",x="[object Proxy]",R="[object RegExp]",b="[object Set]",u="[object String]",w="[object Symbol]",G="[object Undefined]",V="[object WeakMap]",oe="[object ArrayBuffer]",ue="[object DataView]",ge="[object Float32Array]",$="[object Float64Array]",H="[object Int8Array]",le="[object Int16Array]",te="[object Int32Array]",W="[object Uint8Array]",ee="[object Uint8ClampedArray]",Y="[object Uint16Array]",re="[object Uint32Array]",Pe=/[\\^$.*+?()[\]{}|]/g,ie=/^\[object .+?Constructor\]$/,we=/^(?:0|[1-9]\d*)$/,he={};he[ge]=he[$]=he[H]=he[le]=he[te]=he[W]=he[ee]=he[Y]=he[re]=!0,he[f]=he[v]=he[oe]=he[_]=he[ue]=he[I]=he[P]=he[A]=he[K]=he[B]=he[T]=he[R]=he[b]=he[u]=he[V]=!1;var me=typeof ii=="object"&&ii&&ii.Object===Object&&ii,q=typeof self=="object"&&self&&self.Object===Object&&self,j=me||q||Function("return this")(),C=e&&!e.nodeType&&e,h=C&&!0&&n&&!n.nodeType&&n,O=h&&h.exports===C,se=O&&me.process,fe=function(){try{return se&&se.binding&&se.binding("util")}catch{}}(),Se=fe&&fe.isTypedArray;function ze(E,F){for(var X=-1,de=E==null?0:E.length,ct=0,Te=[];++X<de;){var dt=E[X];F(dt,X,E)&&(Te[ct++]=dt)}return Te}function ke(E,F){for(var X=-1,de=F.length,ct=E.length;++X<de;)E[ct+X]=F[X];return E}function Ue(E,F){for(var X=-1,de=E==null?0:E.length;++X<de;)if(F(E[X],X,E))return!0;return!1}function gt(E,F){for(var X=-1,de=Array(E);++X<E;)de[X]=F(X);return de}function vt(E){return function(F){return E(F)}}function je(E,F){return E.has(F)}function xe(E,F){return E==null?void 0:E[F]}function Le(E){var F=-1,X=Array(E.size);return E.forEach(function(de,ct){X[++F]=[ct,de]}),X}function $e(E,F){return function(X){return E(F(X))}}function qe(E){var F=-1,X=Array(E.size);return E.forEach(function(de){X[++F]=de}),X}var Ae=Array.prototype,Fe=Function.prototype,Ie=Object.prototype,Ne=j["__core-js_shared__"],Ke=Fe.toString,Oe=Ie.hasOwnProperty,Ve=function(){var E=/[^.]+$/.exec(Ne&&Ne.keys&&Ne.keys.IE_PROTO||"");return E?"Symbol(src)_1."+E:""}(),We=Ie.toString,et=RegExp("^"+Ke.call(Oe).replace(Pe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),tt=O?j.Buffer:void 0,Je=j.Symbol,tr=j.Uint8Array,fr=Ie.propertyIsEnumerable,Yr=Ae.splice,rr=Je?Je.toStringTag:void 0,oi=Object.getOwnPropertySymbols,xi=tt?tt.isBuffer:void 0,Hi=$e(Object.keys,Object),It=Er(j,"DataView"),yt=Er(j,"Map"),St=Er(j,"Promise"),xt=Er(j,"Set"),bt=Er(j,"WeakMap"),mt=Er(Object,"create"),Ft=ci(It),Dt=ci(yt),Pt=ci(St),Ut=ci(xt),Ot=ci(bt),Rt=Je?Je.prototype:void 0,At=Rt?Rt.valueOf:void 0;function lt(E){var F=-1,X=E==null?0:E.length;for(this.clear();++F<X;){var de=E[F];this.set(de[0],de[1])}}function Mt(){this.__data__=mt?mt(null):{},this.size=0}function jt(E){var F=this.has(E)&&delete this.__data__[E];return this.size-=F?1:0,F}function ca(E){var F=this.__data__;if(mt){var X=F[E];return X===s?void 0:X}return Oe.call(F,E)?F[E]:void 0}function ua(E){var F=this.__data__;return mt?F[E]!==void 0:Oe.call(F,E)}function ha(E,F){var X=this.__data__;return this.size+=this.has(E)?0:1,X[E]=mt&&F===void 0?s:F,this}lt.prototype.clear=Mt,lt.prototype.delete=jt,lt.prototype.get=ca,lt.prototype.has=ua,lt.prototype.set=ha;function Rr(E){var F=-1,X=E==null?0:E.length;for(this.clear();++F<X;){var de=E[F];this.set(de[0],de[1])}}function la(){this.__data__=[],this.size=0}function fa(E){var F=this.__data__,X=zi(F,E);if(X<0)return!1;var de=F.length-1;return X==de?F.pop():Yr.call(F,X,1),--this.size,!0}function da(E){var F=this.__data__,X=zi(F,E);return X<0?void 0:F[X][1]}function pa(E){return zi(this.__data__,E)>-1}function ga(E,F){var X=this.__data__,de=zi(X,E);return de<0?(++this.size,X.push([E,F])):X[de][1]=F,this}Rr.prototype.clear=la,Rr.prototype.delete=fa,Rr.prototype.get=da,Rr.prototype.has=pa,Rr.prototype.set=ga;function ai(E){var F=-1,X=E==null?0:E.length;for(this.clear();++F<X;){var de=E[F];this.set(de[0],de[1])}}function dn(){this.size=0,this.__data__={hash:new lt,map:new(yt||Rr),string:new lt}}function va(E){var F=Pi(this,E).delete(E);return this.size-=F?1:0,F}function pn(E){return Pi(this,E).get(E)}function ya(E){return Pi(this,E).has(E)}function ma(E,F){var X=Pi(this,E),de=X.size;return X.set(E,F),this.size+=X.size==de?0:1,this}ai.prototype.clear=dn,ai.prototype.delete=va,ai.prototype.get=pn,ai.prototype.has=ya,ai.prototype.set=ma;function gn(E){var F=-1,X=E==null?0:E.length;for(this.__data__=new ai;++F<X;)this.add(E[F])}function Cs(E){return this.__data__.set(E,s),this}function Ls(E){return this.__data__.has(E)}gn.prototype.add=gn.prototype.push=Cs,gn.prototype.has=Ls;function qr(E){var F=this.__data__=new Rr(E);this.size=F.size}function _a(){this.__data__=new Rr,this.size=0}function wa(E){var F=this.__data__,X=F.delete(E);return this.size=F.size,X}function ba(E){return this.__data__.get(E)}function Ea(E){return this.__data__.has(E)}function $s(E,F){var X=this.__data__;if(X instanceof Rr){var de=X.__data__;if(!yt||de.length<r-1)return de.push([E,F]),this.size=++X.size,this;X=this.__data__=new ai(de)}return X.set(E,F),this.size=X.size,this}qr.prototype.clear=_a,qr.prototype.delete=wa,qr.prototype.get=ba,qr.prototype.has=Ea,qr.prototype.set=$s;function Fs(E,F){var X=mn(E),de=!X&&Gs(E),ct=!X&&!de&&Wn(E),Te=!X&&!de&&!ct&&Js(E),dt=X||de||ct||Te,qt=dt?gt(E.length,String):[],Qe=qt.length;for(var ut in E)(F||Oe.call(E,ut))&&!(dt&&(ut=="length"||ct&&(ut=="offset"||ut=="parent")||Te&&(ut=="buffer"||ut=="byteLength"||ut=="byteOffset")||zs(ut,Qe)))&&qt.push(ut);return qt}function zi(E,F){for(var X=E.length;X--;)if(Vs(E[X][0],F))return X;return-1}function Vn(E,F,X){var de=F(E);return mn(E)?de:ke(de,X(E))}function Ki(E){return E==null?E===void 0?G:ne:rr&&rr in Object(E)?qs(E):xa(E)}function Gn(E){return ki(E)&&Ki(E)==f}function Bi(E,F,X,de,ct){return E===F?!0:E==null||F==null||!ki(E)&&!ki(F)?E!==E&&F!==F:Ds(E,F,X,de,Bi,ct)}function Ds(E,F,X,de,ct,Te){var dt=mn(E),qt=mn(F),Qe=dt?v:Jr(E),ut=qt?v:Jr(F);Qe=Qe==f?T:Qe,ut=ut==f?T:ut;var Tt=Qe==T,dr=ut==T,Ht=Qe==ut;if(Ht&&Wn(E)){if(!Wn(F))return!1;dt=!0,Tt=!1}if(Ht&&!Tt)return Te||(Te=new qr),dt||Js(E)?vn(E,F,X,de,ct,Te):Sa(E,F,Qe,X,de,ct,Te);if(!(X&a)){var pt=Tt&&Oe.call(E,"__wrapped__"),ir=dr&&Oe.call(F,"__wrapped__");if(pt||ir){var Hr=pt?E.value():E,Tr=ir?F.value():F;return Te||(Te=new qr),ct(Hr,Tr,X,de,Te)}}return Ht?(Te||(Te=new qr),js(E,F,X,de,ct,Te)):!1}function Ia(E){if(!Ys(E)||Bs(E))return!1;var F=_n(E)?et:ie;return F.test(ci(E))}function Us(E){return ki(E)&&Ws(E.length)&&!!he[Ki(E)]}function Ms(E){if(!ks(E))return Hi(E);var F=[];for(var X in Object(E))Oe.call(E,X)&&X!="constructor"&&F.push(X);return F}function vn(E,F,X,de,ct,Te){var dt=X&a,qt=E.length,Qe=F.length;if(qt!=Qe&&!(dt&&Qe>qt))return!1;var ut=Te.get(E);if(ut&&Te.get(F))return ut==F;var Tt=-1,dr=!0,Ht=X&l?new gn:void 0;for(Te.set(E,F),Te.set(F,E);++Tt<qt;){var pt=E[Tt],ir=F[Tt];if(de)var Hr=dt?de(ir,pt,Tt,F,E,Te):de(pt,ir,Tt,E,F,Te);if(Hr!==void 0){if(Hr)continue;dr=!1;break}if(Ht){if(!Ue(F,function(Tr,Qr){if(!je(Ht,Qr)&&(pt===Tr||ct(pt,Tr,X,de,Te)))return Ht.push(Qr)})){dr=!1;break}}else if(!(pt===ir||ct(pt,ir,X,de,Te))){dr=!1;break}}return Te.delete(E),Te.delete(F),dr}function Sa(E,F,X,de,ct,Te,dt){switch(X){case ue:if(E.byteLength!=F.byteLength||E.byteOffset!=F.byteOffset)return!1;E=E.buffer,F=F.buffer;case oe:return!(E.byteLength!=F.byteLength||!Te(new tr(E),new tr(F)));case _:case I:case B:return Vs(+E,+F);case P:return E.name==F.name&&E.message==F.message;case R:case u:return E==F+"";case K:var qt=Le;case b:var Qe=de&a;if(qt||(qt=qe),E.size!=F.size&&!Qe)return!1;var ut=dt.get(E);if(ut)return ut==F;de|=l,dt.set(E,F);var Tt=vn(qt(E),qt(F),de,ct,Te,dt);return dt.delete(E),Tt;case w:if(At)return At.call(E)==At.call(F)}return!1}function js(E,F,X,de,ct,Te){var dt=X&a,qt=yn(E),Qe=qt.length,ut=yn(F),Tt=ut.length;if(Qe!=Tt&&!dt)return!1;for(var dr=Qe;dr--;){var Ht=qt[dr];if(!(dt?Ht in F:Oe.call(F,Ht)))return!1}var pt=Te.get(E);if(pt&&Te.get(F))return pt==F;var ir=!0;Te.set(E,F),Te.set(F,E);for(var Hr=dt;++dr<Qe;){Ht=qt[dr];var Tr=E[Ht],Qr=F[Ht];if(de)var Yn=dt?de(Qr,Tr,Ht,F,E,Te):de(Tr,Qr,Ht,E,F,Te);if(!(Yn===void 0?Tr===Qr||ct(Tr,Qr,X,de,Te):Yn)){ir=!1;break}Hr||(Hr=Ht=="constructor")}if(ir&&!Hr){var Vi=E.constructor,kt=F.constructor;Vi!=kt&&"constructor"in E&&"constructor"in F&&!(typeof Vi=="function"&&Vi instanceof Vi&&typeof kt=="function"&&kt instanceof kt)&&(ir=!1)}return Te.delete(E),Te.delete(F),ir}function yn(E){return Vn(E,Aa,Hs)}function Pi(E,F){var X=E.__data__;return Ks(F)?X[typeof F=="string"?"string":"hash"]:X.map}function Er(E,F){var X=xe(E,F);return Ia(X)?X:void 0}function qs(E){var F=Oe.call(E,rr),X=E[rr];try{E[rr]=void 0;var de=!0}catch{}var ct=We.call(E);return de&&(F?E[rr]=X:delete E[rr]),ct}var Hs=oi?function(E){return E==null?[]:(E=Object(E),ze(oi(E),function(F){return fr.call(E,F)}))}:at,Jr=Ki;(It&&Jr(new It(new ArrayBuffer(1)))!=ue||yt&&Jr(new yt)!=K||St&&Jr(St.resolve())!=M||xt&&Jr(new xt)!=b||bt&&Jr(new bt)!=V)&&(Jr=function(E){var F=Ki(E),X=F==T?E.constructor:void 0,de=X?ci(X):"";if(de)switch(de){case Ft:return ue;case Dt:return K;case Pt:return M;case Ut:return b;case Ot:return V}return F});function zs(E,F){return F=F==null?p:F,!!F&&(typeof E=="number"||we.test(E))&&E>-1&&E%1==0&&E<F}function Ks(E){var F=typeof E;return F=="string"||F=="number"||F=="symbol"||F=="boolean"?E!=="__proto__":E===null}function Bs(E){return!!Ve&&Ve in E}function ks(E){var F=E&&E.constructor,X=typeof F=="function"&&F.prototype||Ie;return E===X}function xa(E){return We.call(E)}function ci(E){if(E!=null){try{return Ke.call(E)}catch{}try{return E+""}catch{}}return""}function Vs(E,F){return E===F||E!==E&&F!==F}var Gs=Gn(function(){return arguments}())?Gn:function(E){return ki(E)&&Oe.call(E,"callee")&&!fr.call(E,"callee")},mn=Array.isArray;function Pa(E){return E!=null&&Ws(E.length)&&!_n(E)}var Wn=xi||ot;function Oa(E,F){return Bi(E,F)}function _n(E){if(!Ys(E))return!1;var F=Ki(E);return F==A||F==L||F==g||F==x}function Ws(E){return typeof E=="number"&&E>-1&&E%1==0&&E<=p}function Ys(E){var F=typeof E;return E!=null&&(F=="object"||F=="function")}function ki(E){return E!=null&&typeof E=="object"}var Js=Se?vt(Se):Us;function Aa(E){return Pa(E)?Fs(E):Ms(E)}function at(){return[]}function ot(){return!1}n.exports=Oa})(lu,lu.exports);const p6=lu.exports;function g6(n,e){if(n.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),s=0;s<r.length;s++)r[s]=255;for(var a=0;a<n.length;a++){var l=n.charAt(a),p=l.charCodeAt(0);if(r[p]!==255)throw new TypeError(l+" is ambiguous");r[p]=a}var f=n.length,v=n.charAt(0),g=Math.log(f)/Math.log(256),_=Math.log(256)/Math.log(f);function I(L){if(L instanceof Uint8Array||(ArrayBuffer.isView(L)?L=new Uint8Array(L.buffer,L.byteOffset,L.byteLength):Array.isArray(L)&&(L=Uint8Array.from(L))),!(L instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(L.length===0)return"";for(var K=0,B=0,ne=0,T=L.length;ne!==T&&L[ne]===0;)ne++,K++;for(var M=(T-ne)*_+1>>>0,x=new Uint8Array(M);ne!==T;){for(var R=L[ne],b=0,u=M-1;(R!==0||b<B)&&u!==-1;u--,b++)R+=256*x[u]>>>0,x[u]=R%f>>>0,R=R/f>>>0;if(R!==0)throw new Error("Non-zero carry");B=b,ne++}for(var w=M-B;w!==M&&x[w]===0;)w++;for(var G=v.repeat(K);w<M;++w)G+=n.charAt(x[w]);return G}function P(L){if(typeof L!="string")throw new TypeError("Expected String");if(L.length===0)return new Uint8Array;var K=0;if(L[K]!==" "){for(var B=0,ne=0;L[K]===v;)B++,K++;for(var T=(L.length-K)*g+1>>>0,M=new Uint8Array(T);L[K];){var x=r[L.charCodeAt(K)];if(x===255)return;for(var R=0,b=T-1;(x!==0||R<ne)&&b!==-1;b--,R++)x+=f*M[b]>>>0,M[b]=x%256>>>0,x=x/256>>>0;if(x!==0)throw new Error("Non-zero carry");ne=R,K++}if(L[K]!==" "){for(var u=T-ne;u!==T&&M[u]===0;)u++;for(var w=new Uint8Array(B+(T-u)),G=B;u!==T;)w[G++]=M[u++];return w}}}function A(L){var K=P(L);if(K)return K;throw new Error(`Non-${e} character`)}return{encode:I,decodeUnsafe:P,decode:A}}var v6=g6,y6=v6;const np=n=>{if(n instanceof Uint8Array&&n.constructor.name==="Uint8Array")return n;if(n instanceof ArrayBuffer)return new Uint8Array(n);if(ArrayBuffer.isView(n))return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);throw new Error("Unknown type, must be binary type")},m6=n=>new TextEncoder().encode(n),_6=n=>new TextDecoder().decode(n);class w6{constructor(e,r,s){this.name=e,this.prefix=r,this.baseEncode=s}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class b6{constructor(e,r,s){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=s}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return sp(this,e)}}class E6{constructor(e){this.decoders=e}or(e){return sp(this,e)}decode(e){const r=e[0],s=this.decoders[r];if(s)return s.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const sp=(n,e)=>new E6({...n.decoders||{[n.prefix]:n},...e.decoders||{[e.prefix]:e}});class I6{constructor(e,r,s,a){this.name=e,this.prefix=r,this.baseEncode=s,this.baseDecode=a,this.encoder=new w6(e,r,s),this.decoder=new b6(e,r,a)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const oa=({name:n,prefix:e,encode:r,decode:s})=>new I6(n,e,r,s),Ts=({prefix:n,name:e,alphabet:r})=>{const{encode:s,decode:a}=y6(r,e);return oa({prefix:n,name:e,encode:s,decode:l=>np(a(l))})},S6=(n,e,r,s)=>{const a={};for(let _=0;_<e.length;++_)a[e[_]]=_;let l=n.length;for(;n[l-1]==="=";)--l;const p=new Uint8Array(l*r/8|0);let f=0,v=0,g=0;for(let _=0;_<l;++_){const I=a[n[_]];if(I===void 0)throw new SyntaxError(`Non-${s} character`);v=v<<r|I,f+=r,f>=8&&(f-=8,p[g++]=255&v>>f)}if(f>=r||255&v<<8-f)throw new SyntaxError("Unexpected end of data");return p},x6=(n,e,r)=>{const s=e[e.length-1]==="=",a=(1<<r)-1;let l="",p=0,f=0;for(let v=0;v<n.length;++v)for(f=f<<8|n[v],p+=8;p>r;)p-=r,l+=e[a&f>>p];if(p&&(l+=e[a&f<<r-p]),s)for(;l.length*r&7;)l+="=";return l},Jt=({name:n,prefix:e,bitsPerChar:r,alphabet:s})=>oa({prefix:e,name:n,encode(a){return x6(a,s,r)},decode(a){return S6(a,s,r,n)}}),P6=oa({prefix:"\0",name:"identity",encode:n=>_6(n),decode:n=>m6(n)});var O6=Object.freeze({__proto__:null,identity:P6});const A6=Jt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var N6=Object.freeze({__proto__:null,base2:A6});const R6=Jt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var T6=Object.freeze({__proto__:null,base8:R6});const C6=Ts({prefix:"9",name:"base10",alphabet:"0123456789"});var L6=Object.freeze({__proto__:null,base10:C6});const $6=Jt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),F6=Jt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var D6=Object.freeze({__proto__:null,base16:$6,base16upper:F6});const U6=Jt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),M6=Jt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),j6=Jt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),q6=Jt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),H6=Jt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),z6=Jt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),K6=Jt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),B6=Jt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),k6=Jt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var V6=Object.freeze({__proto__:null,base32:U6,base32upper:M6,base32pad:j6,base32padupper:q6,base32hex:H6,base32hexupper:z6,base32hexpad:K6,base32hexpadupper:B6,base32z:k6});const G6=Ts({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),W6=Ts({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Y6=Object.freeze({__proto__:null,base36:G6,base36upper:W6});const J6=Ts({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Q6=Ts({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var X6=Object.freeze({__proto__:null,base58btc:J6,base58flickr:Q6});const Z6=Jt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),eI=Jt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),tI=Jt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),rI=Jt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var iI=Object.freeze({__proto__:null,base64:Z6,base64pad:eI,base64url:tI,base64urlpad:rI});const op=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),nI=op.reduce((n,e,r)=>(n[r]=e,n),[]),sI=op.reduce((n,e,r)=>(n[e.codePointAt(0)]=r,n),[]);function oI(n){return n.reduce((e,r)=>(e+=nI[r],e),"")}function aI(n){const e=[];for(const r of n){const s=sI[r.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(s)}return new Uint8Array(e)}const cI=oa({prefix:"\u{1F680}",name:"base256emoji",encode:oI,decode:aI});var uI=Object.freeze({__proto__:null,base256emoji:cI}),hI=ap,Uf=128,lI=127,fI=~lI,dI=Math.pow(2,31);function ap(n,e,r){e=e||[],r=r||0;for(var s=r;n>=dI;)e[r++]=n&255|Uf,n/=128;for(;n&fI;)e[r++]=n&255|Uf,n>>>=7;return e[r]=n|0,ap.bytes=r-s+1,e}var pI=fu,gI=128,Mf=127;function fu(n,s){var r=0,s=s||0,a=0,l=s,p,f=n.length;do{if(l>=f)throw fu.bytes=0,new RangeError("Could not decode varint");p=n[l++],r+=a<28?(p&Mf)<<a:(p&Mf)*Math.pow(2,a),a+=7}while(p>=gI);return fu.bytes=l-s,r}var vI=Math.pow(2,7),yI=Math.pow(2,14),mI=Math.pow(2,21),_I=Math.pow(2,28),wI=Math.pow(2,35),bI=Math.pow(2,42),EI=Math.pow(2,49),II=Math.pow(2,56),SI=Math.pow(2,63),xI=function(n){return n<vI?1:n<yI?2:n<mI?3:n<_I?4:n<wI?5:n<bI?6:n<EI?7:n<II?8:n<SI?9:10},PI={encode:hI,decode:pI,encodingLength:xI},cp=PI;const jf=(n,e,r=0)=>(cp.encode(n,e,r),e),qf=n=>cp.encodingLength(n),du=(n,e)=>{const r=e.byteLength,s=qf(n),a=s+qf(r),l=new Uint8Array(a+r);return jf(n,l,0),jf(r,l,s),l.set(e,a),new OI(n,r,e,l)};class OI{constructor(e,r,s,a){this.code=e,this.size=r,this.digest=s,this.bytes=a}}const up=({name:n,code:e,encode:r})=>new AI(n,e,r);class AI{constructor(e,r,s){this.name=e,this.code=r,this.encode=s}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?du(this.code,r):r.then(s=>du(this.code,s))}else throw Error("Unknown type, must be binary type")}}const hp=n=>async e=>new Uint8Array(await crypto.subtle.digest(n,e)),NI=up({name:"sha2-256",code:18,encode:hp("SHA-256")}),RI=up({name:"sha2-512",code:19,encode:hp("SHA-512")});var TI=Object.freeze({__proto__:null,sha256:NI,sha512:RI});const lp=0,CI="identity",fp=np,LI=n=>du(lp,fp(n)),$I={code:lp,name:CI,encode:fp,digest:LI};var FI=Object.freeze({__proto__:null,identity:$I});new TextEncoder,new TextDecoder;const Hf={...O6,...N6,...T6,...L6,...D6,...V6,...Y6,...X6,...iI,...uI};({...TI,...FI});function dp(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function DI(n=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?dp(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function pp(n,e,r,s){return{name:n,prefix:e,encoder:{name:n,prefix:e,encode:r},decoder:{decode:s}}}const zf=pp("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),Bc=pp("ascii","a",n=>{let e="a";for(let r=0;r<n.length;r++)e+=String.fromCharCode(n[r]);return e},n=>{n=n.substring(1);const e=DI(n.length);for(let r=0;r<n.length;r++)e[r]=n.charCodeAt(r);return e}),UI={utf8:zf,"utf-8":zf,hex:Hf.base16,latin1:Bc,ascii:Bc,binary:Bc,...Hf};function MI(n,e="utf8"){const r=UI[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?dp(globalThis.Buffer.from(n,"utf-8")):r.decoder.decode(`${r.prefix}${n}`)}const gp="wc",jI=2,$u="core",Ui=`${gp}@2:${$u}:`,qI={name:$u,logger:"error"},HI={database:":memory:"},zI="crypto",Kf="client_ed25519_seed",KI=ye.ONE_DAY,BI="keychain",kI="0.3",VI="messages",GI="0.3",WI=ye.SIX_HOURS,YI="publisher",vp="irn",JI="error",yp="wss://relay.walletconnect.com",Bf="wss://relay.walletconnect.org",QI="relayer",er={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},XI="_subscription",wi={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},ZI=ye.ONE_SECOND,e2="2.10.6",t2=1e4,r2="0.3",i2="WALLETCONNECT_CLIENT_ID",Vr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},n2="subscription",s2="0.3",o2=ye.FIVE_SECONDS*1e3,a2="pairing",c2="0.3",gs={wc_pairingDelete:{req:{ttl:ye.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:ye.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:ye.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:ye.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:ye.ONE_DAY,prompt:!1,tag:0},res:{ttl:ye.ONE_DAY,prompt:!1,tag:0}}},bs={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},ri={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},u2="history",h2="0.3",l2="expirer",jr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},f2="0.3",kc="verify-api",Fn="https://verify.walletconnect.com",pu="https://verify.walletconnect.org",d2=[Fn,pu];class p2{constructor(e,r){this.core=e,this.logger=r,this.keychain=new Map,this.name=BI,this.version=kI,this.initialized=!1,this.storagePrefix=Ui,this.init=async()=>{if(!this.initialized){const s=await this.getKeyChain();typeof s<"u"&&(this.keychain=s),this.initialized=!0}},this.has=s=>(this.isInitialized(),this.keychain.has(s)),this.set=async(s,a)=>{this.isInitialized(),this.keychain.set(s,a),await this.persist()},this.get=s=>{this.isInitialized();const a=this.keychain.get(s);if(typeof a>"u"){const{message:l}=ae("NO_MATCHING_KEY",`${this.name}: ${s}`);throw new Error(l)}return a},this.del=async s=>{this.isInitialized(),this.keychain.delete(s),await this.persist()},this.core=e,this.logger=Ze.generateChildLogger(r,this.name)}get context(){return Ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,kd(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Vd(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=ae("NOT_INITIALIZED",this.name);throw new Error(e)}}}class g2{constructor(e,r,s){this.core=e,this.logger=r,this.name=zI,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=a=>(this.isInitialized(),this.keychain.has(a)),this.getClientId=async()=>{this.isInitialized();const a=await this.getClientSeed(),l=lf(a);return Td(l.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const a=Lb();return this.setPrivateKey(a.publicKey,a.privateKey)},this.signJWT=async a=>{this.isInitialized();const l=await this.getClientSeed(),p=lf(l),f=uu();return await Qw(f,a,KI,p)},this.generateSharedKey=(a,l,p)=>{this.isInitialized();const f=this.getPrivateKey(a),v=$b(f,l);return this.setSymKey(v,p)},this.setSymKey=async(a,l)=>{this.isInitialized();const p=l||Fb(a);return await this.keychain.set(p,a),p},this.deleteKeyPair=async a=>{this.isInitialized(),await this.keychain.del(a)},this.deleteSymKey=async a=>{this.isInitialized(),await this.keychain.del(a)},this.encode=async(a,l,p)=>{this.isInitialized();const f=Bd(p),v=an(l);if(mf(f)){const P=f.senderPublicKey,A=f.receiverPublicKey;a=await this.generateSharedKey(P,A)}const g=this.getSymKey(a),{type:_,senderPublicKey:I}=f;return Ub({type:_,symKey:g,message:v,senderPublicKey:I})},this.decode=async(a,l,p)=>{this.isInitialized();const f=qb(l,p);if(mf(f)){const v=f.receiverPublicKey,g=f.senderPublicKey;a=await this.generateSharedKey(v,g)}try{const v=this.getSymKey(a),g=Mb({symKey:v,encoded:l});return Os(g)}catch(v){this.logger.error(`Failed to decode message from topic: '${a}', clientId: '${await this.getClientId()}'`),this.logger.error(v)}},this.getPayloadType=a=>{const l=Jo(a);return Ns(l.type)},this.getPayloadSenderPublicKey=a=>{const l=Jo(a);return l.senderPublicKey?hr(l.senderPublicKey,ur):void 0},this.core=e,this.logger=Ze.generateChildLogger(r,this.name),this.keychain=s||new p2(this.core,this.logger)}get context(){return Ze.getLoggerContext(this.logger)}async setPrivateKey(e,r){return await this.keychain.set(e,r),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(Kf)}catch{e=uu(),await this.keychain.set(Kf,e)}return MI(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=ae("NOT_INITIALIZED",this.name);throw new Error(e)}}}class v2 extends rw{constructor(e,r){super(e,r),this.logger=e,this.core=r,this.messages=new Map,this.name=VI,this.version=GI,this.initialized=!1,this.storagePrefix=Ui,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const s=await this.getRelayerMessages();typeof s<"u"&&(this.messages=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(s){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(s)}finally{this.initialized=!0}}},this.set=async(s,a)=>{this.isInitialized();const l=Un(a);let p=this.messages.get(s);return typeof p>"u"&&(p={}),typeof p[l]<"u"||(p[l]=a,this.messages.set(s,p),await this.persist()),l},this.get=s=>{this.isInitialized();let a=this.messages.get(s);return typeof a>"u"&&(a={}),a},this.has=(s,a)=>{this.isInitialized();const l=this.get(s),p=Un(a);return typeof l[p]<"u"},this.del=async s=>{this.isInitialized(),this.messages.delete(s),await this.persist()},this.logger=Ze.generateChildLogger(e,this.name),this.core=r}get context(){return Ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,kd(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Vd(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=ae("NOT_INITIALIZED",this.name);throw new Error(e)}}}class y2 extends iw{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.events=new lr.exports.EventEmitter,this.name=YI,this.queue=new Map,this.publishTimeout=ye.toMiliseconds(ye.TEN_SECONDS),this.needsTransportRestart=!1,this.publish=async(s,a,l)=>{var p;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:a,opts:l}});try{const f=(l==null?void 0:l.ttl)||WI,v=hu(l),g=(l==null?void 0:l.prompt)||!1,_=(l==null?void 0:l.tag)||0,I=(l==null?void 0:l.id)||tp().toString(),P={topic:s,message:a,opts:{ttl:f,relay:v,prompt:g,tag:_,id:I}},A=setTimeout(()=>this.queue.set(I,P),this.publishTimeout);try{await await xs(this.rpcPublish(s,a,f,v,g,_,I),this.publishTimeout,"Failed to publish payload, please try again."),this.removeRequestFromQueue(I),this.relayer.events.emit(er.publish,P)}catch(L){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(p=l==null?void 0:l.internal)!=null&&p.throwOnFailedPublish)throw this.removeRequestFromQueue(I),L;return}finally{clearTimeout(A)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:a,opts:l}})}catch(f){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(f),f}},this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.relayer=e,this.logger=Ze.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return Ze.getLoggerContext(this.logger)}rpcPublish(e,r,s,a,l,p,f){var v,g,_,I;const P={method:ko(a.protocol).publish,params:{topic:e,message:r,ttl:s,prompt:l,tag:p},id:f};return cr((v=P.params)==null?void 0:v.prompt)&&((g=P.params)==null||delete g.prompt),cr((_=P.params)==null?void 0:_.tag)&&((I=P.params)==null||delete I.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:P}),this.relayer.request(P)}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{const{topic:r,message:s,opts:a}=e;await this.publish(r,s,a)})}registerEventListeners(){this.relayer.core.heartbeat.on(qn.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(er.connection_stalled);return}this.checkQueue()}),this.relayer.on(er.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}class m2{constructor(){this.map=new Map,this.set=(e,r)=>{const s=this.get(e);this.exists(e,r)||this.map.set(e,[...s,r])},this.get=e=>this.map.get(e)||[],this.exists=(e,r)=>this.get(e).includes(r),this.delete=(e,r)=>{if(typeof r>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const s=this.get(e);if(!this.exists(e,r))return;const a=s.filter(l=>l!==r);if(!a.length){this.map.delete(e);return}this.map.set(e,a)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var _2=Object.defineProperty,w2=Object.defineProperties,b2=Object.getOwnPropertyDescriptors,kf=Object.getOwnPropertySymbols,E2=Object.prototype.hasOwnProperty,I2=Object.prototype.propertyIsEnumerable,Vf=(n,e,r)=>e in n?_2(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,vs=(n,e)=>{for(var r in e||(e={}))E2.call(e,r)&&Vf(n,r,e[r]);if(kf)for(var r of kf(e))I2.call(e,r)&&Vf(n,r,e[r]);return n},Vc=(n,e)=>w2(n,b2(e));class S2 extends ow{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.subscriptions=new Map,this.topicMap=new m2,this.events=new lr.exports.EventEmitter,this.name=n2,this.version=s2,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Ui,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(s,a)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:a}});try{const l=hu(a),p={topic:s,relay:l};this.pending.set(s,p);const f=await this.rpcSubscribe(s,l);return this.onSubscribe(f,p),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:a}}),f}catch(l){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(l),l}},this.unsubscribe=async(s,a)=>{await this.restartToComplete(),this.isInitialized(),typeof(a==null?void 0:a.id)<"u"?await this.unsubscribeById(s,a.id,a):await this.unsubscribeByTopic(s,a)},this.isSubscribed=async s=>this.topics.includes(s)?!0:await new Promise((a,l)=>{const p=new ye.Watch;p.start(this.pendingSubscriptionWatchLabel);const f=setInterval(()=>{!this.pending.has(s)&&this.topics.includes(s)&&(clearInterval(f),p.stop(this.pendingSubscriptionWatchLabel),a(!0)),p.elapsed(this.pendingSubscriptionWatchLabel)>=o2&&(clearInterval(f),p.stop(this.pendingSubscriptionWatchLabel),l(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=e,this.logger=Ze.generateChildLogger(r,this.name),this.clientId=""}get context(){return Ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,r){let s=!1;try{s=this.getSubscription(e).topic===r}catch{}return s}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,r){const s=this.topicMap.get(e);await Promise.all(s.map(async a=>await this.unsubscribeById(e,a,r)))}async unsubscribeById(e,r,s){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:s}});try{const a=hu(s);await this.rpcUnsubscribe(e,r,a);const l=$t("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,r,l),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:s}})}catch(a){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(a),a}}async rpcSubscribe(e,r){const s={method:ko(r.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{await await xs(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(er.connection_stalled)}return Un(e+this.clientId)}async rpcBatchSubscribe(e){if(!e.length)return;const r=e[0].relay,s={method:ko(r.protocol).batchSubscribe,params:{topics:e.map(a=>a.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{return await await xs(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(er.connection_stalled)}}rpcUnsubscribe(e,r,s){const a={method:ko(s.protocol).unsubscribe,params:{topic:e,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:a}),this.relayer.request(a)}onSubscribe(e,r){this.setSubscription(e,Vc(vs({},r),{id:e})),this.pending.delete(r.topic)}onBatchSubscribe(e){e.length&&e.forEach(r=>{this.setSubscription(r.id,vs({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(e,r,s){this.events.removeAllListeners(r),this.hasSubscription(r,e)&&this.deleteSubscription(r,s),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,r){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:r}),this.addSubscription(e,r))}addSubscription(e,r){this.subscriptions.set(e,vs({},r)),this.topicMap.set(r.topic,e),this.events.emit(Vr.created,r)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const r=this.subscriptions.get(e);if(!r){const{message:s}=ae("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(s)}return r}deleteSubscription(e,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:r});const s=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(s.topic,e),this.events.emit(Vr.deleted,Vc(vs({},s),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Vr.sync)}async reset(){if(this.cached.length){const e=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<e;r++){const s=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(Vr.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:r}=ae("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){if(!e.length)return;const r=await this.rpcBatchSubscribe(e);ni(r)&&this.onBatchSubscribe(r.map((s,a)=>Vc(vs({},e[a]),{id:s})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const e=[];this.pending.forEach(r=>{e.push(r)}),await this.batchSubscribe(e)}registerEventListeners(){this.relayer.core.heartbeat.on(qn.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(er.connect,async()=>{await this.onConnect()}),this.relayer.on(er.disconnect,()=>{this.onDisconnect()}),this.events.on(Vr.created,async e=>{const r=Vr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()}),this.events.on(Vr.deleted,async e=>{const r=Vr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=ae("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(){this.restartInProgress&&await new Promise(e=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),e())},this.pollingInterval)})}}var x2=Object.defineProperty,Gf=Object.getOwnPropertySymbols,P2=Object.prototype.hasOwnProperty,O2=Object.prototype.propertyIsEnumerable,Wf=(n,e,r)=>e in n?x2(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,A2=(n,e)=>{for(var r in e||(e={}))P2.call(e,r)&&Wf(n,r,e[r]);if(Gf)for(var r of Gf(e))O2.call(e,r)&&Wf(n,r,e[r]);return n};class N2 extends nw{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new lr.exports.EventEmitter,this.name=QI,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.request=async r=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(r)}catch(s){throw this.logger.debug("Failed to Publish Request"),this.logger.error(s),s}},this.onPayloadHandler=r=>{this.onProviderPayload(r)},this.onConnectHandler=()=>{this.events.emit(er.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=r=>{this.logger.error(r),this.events.emit(er.error,r),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(wi.payload,this.onPayloadHandler),this.provider.on(wi.connect,this.onConnectHandler),this.provider.on(wi.disconnect,this.onDisconnectHandler),this.provider.on(wi.error,this.onProviderErrorHandler)},this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?Ze.generateChildLogger(e.logger,this.name):Ze.pino(Ze.getDefaultLoggerOptions({level:e.logger||JI})),this.messages=new v2(this.logger,e.core),this.subscriber=new S2(this,this.logger),this.publisher=new y2(this,this.logger),this.relayUrl=(e==null?void 0:e.relayUrl)||yp,this.projectId=e.projectId,this.bundleId=Vb(),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${Bf}...`),await this.restartTransport(Bf)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},t2)}get context(){return Ze.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(e,r,s){this.isInitialized(),await this.publisher.publish(e,r,s),await this.recordMessageEvent({topic:e,message:r,publishedAt:Date.now()})}async subscribe(e,r){var s;this.isInitialized();let a=((s=this.subscriber.topicMap.get(e))==null?void 0:s[0])||"";if(a)return a;let l;const p=f=>{f.topic===e&&(this.subscriber.off(Vr.created,p),l())};return await Promise.all([new Promise(f=>{l=f,this.subscriber.on(Vr.created,p)}),new Promise(async f=>{a=await this.subscriber.subscribe(e,r),f()})]),a}async unsubscribe(e,r){this.isInitialized(),await this.subscriber.unsubscribe(e,r)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await xs(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(e){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(r=>{if(!this.initialized)return r();this.subscriber.once(Vr.resubscribed,()=>{r()})}),new Promise(async(r,s)=>{try{await xs(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(a){s(a);return}r()})])}catch(r){this.logger.error(r);const s=r;if(!this.isConnectionStalled(s.message))throw r;this.provider.events.emit(wi.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(e){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await Nf())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(e){return this.staleConnectionErrors.some(r=>e.includes(r))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Ii(new d6(Xb({sdkVersion:e2,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId}))),this.registerProviderListeners()}async recordMessageEvent(e){const{topic:r,message:s}=e;await this.messages.set(r,s)}async shouldIgnoreMessageEvent(e){const{topic:r,message:s}=e;if(!s||s.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${s}`),!0;if(!await this.subscriber.isSubscribed(r))return this.logger.debug(`Ignoring message for non-subscribed topic ${r}`),!0;const a=this.messages.has(r,s);return a&&this.logger.debug(`Ignoring duplicate message: ${s}`),a}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),Lu(e)){if(!e.method.endsWith(XI))return;const r=e.params,{topic:s,message:a,publishedAt:l}=r.data,p={topic:s,message:a,publishedAt:l};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(A2({type:"event",event:r.id},p)),this.events.emit(r.id,p),await this.acknowledgePayload(e),await this.onMessageEvent(p)}else sa(e)&&this.events.emit(er.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(er.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const r=Cu(e.id,!0);await this.provider.connection.send(r)}unregisterProviderListeners(){this.provider.off(wi.payload,this.onPayloadHandler),this.provider.off(wi.connect,this.onConnectHandler),this.provider.off(wi.disconnect,this.onDisconnectHandler),this.provider.off(wi.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(er.connection_stalled,()=>{this.restartTransport().catch(r=>this.logger.error(r))});let e=await Nf();BE(async r=>{this.initialized&&e!==r&&(e=r,r?await this.restartTransport().catch(s=>this.logger.error(s)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(s=>this.logger.error(s))))})}onProviderDisconnect(){this.events.emit(er.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(e=>this.logger.error(e))},ye.toMiliseconds(ZI)))}isInitialized(){if(!this.initialized){const{message:e}=ae("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(e=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),e())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var R2=Object.defineProperty,Yf=Object.getOwnPropertySymbols,T2=Object.prototype.hasOwnProperty,C2=Object.prototype.propertyIsEnumerable,Jf=(n,e,r)=>e in n?R2(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,Qf=(n,e)=>{for(var r in e||(e={}))T2.call(e,r)&&Jf(n,r,e[r]);if(Yf)for(var r of Yf(e))C2.call(e,r)&&Jf(n,r,e[r]);return n};class aa extends sw{constructor(e,r,s,a=Ui,l=void 0){super(e,r,s,a),this.core=e,this.logger=r,this.name=s,this.map=new Map,this.version=r2,this.cached=[],this.initialized=!1,this.storagePrefix=Ui,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(p=>{this.getKey&&p!==null&&!cr(p)?this.map.set(this.getKey(p),p):bE(p)?this.map.set(p.id,p):EE(p)&&this.map.set(p.topic,p)}),this.cached=[],this.initialized=!0)},this.set=async(p,f)=>{this.isInitialized(),this.map.has(p)?await this.update(p,f):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:p,value:f}),this.map.set(p,f),await this.persist())},this.get=p=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:p}),this.getData(p)),this.getAll=p=>(this.isInitialized(),p?this.values.filter(f=>Object.keys(p).every(v=>p6(f[v],p[v]))):this.values),this.update=async(p,f)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:p,update:f});const v=Qf(Qf({},this.getData(p)),f);this.map.set(p,v),await this.persist()},this.delete=async(p,f)=>{this.isInitialized(),this.map.has(p)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:p,reason:f}),this.map.delete(p),await this.persist())},this.logger=Ze.generateChildLogger(r,this.name),this.storagePrefix=a,this.getKey=l}get context(){return Ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const r=this.map.get(e);if(!r){const{message:s}=ae("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:r}=ae("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=ae("NOT_INITIALIZED",this.name);throw new Error(e)}}}class L2{constructor(e,r){this.core=e,this.logger=r,this.name=a2,this.version=c2,this.events=new lr.exports,this.initialized=!1,this.storagePrefix=Ui,this.ignoredPayloadTypes=[ln],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:s})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...s])]},this.create=async()=>{this.isInitialized();const s=uu(),a=await this.core.crypto.setSymKey(s),l=Gr(ye.FIVE_MINUTES),p={protocol:vp},f={topic:a,expiry:l,relay:p,active:!1},v=lE({protocol:this.core.protocol,version:this.core.version,topic:a,symKey:s,relay:p});return await this.pairings.set(a,f),await this.core.relayer.subscribe(a),this.core.expirer.set(a,l),{topic:a,uri:v}},this.pair=async s=>{this.isInitialized(),this.isValidPair(s);const{topic:a,symKey:l,relay:p}=Sf(s.uri);let f;if(this.pairings.keys.includes(a)&&(f=this.pairings.get(a),f.active))throw new Error(`Pairing already exists: ${a}. Please try again with a new connection URI.`);const v=Gr(ye.FIVE_MINUTES),g={topic:a,relay:p,expiry:v,active:!1};return await this.pairings.set(a,g),this.core.expirer.set(a,v),s.activatePairing&&await this.activate({topic:a}),this.events.emit(bs.create,g),this.core.crypto.keychain.has(a)||(await this.core.crypto.setSymKey(l,a),await this.core.relayer.subscribe(a,{relay:p})),g},this.activate=async({topic:s})=>{this.isInitialized();const a=Gr(ye.THIRTY_DAYS);await this.pairings.update(s,{active:!0,expiry:a}),this.core.expirer.set(s,a)},this.ping=async s=>{this.isInitialized(),await this.isValidPing(s);const{topic:a}=s;if(this.pairings.keys.includes(a)){const l=await this.sendRequest(a,"wc_pairingPing",{}),{done:p,resolve:f,reject:v}=$n();this.events.once(zt("pairing_ping",l),({error:g})=>{g?v(g):f()}),await p()}},this.updateExpiry=async({topic:s,expiry:a})=>{this.isInitialized(),await this.pairings.update(s,{expiry:a})},this.updateMetadata=async({topic:s,metadata:a})=>{this.isInitialized(),await this.pairings.update(s,{peerMetadata:a})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async s=>{this.isInitialized(),await this.isValidDisconnect(s);const{topic:a}=s;this.pairings.keys.includes(a)&&(await this.sendRequest(a,"wc_pairingDelete",$t("USER_DISCONNECTED")),await this.deletePairing(a))},this.sendRequest=async(s,a,l)=>{const p=jn(a,l),f=await this.core.crypto.encode(s,p),v=gs[a].req;return this.core.history.set(s,p),this.core.relayer.publish(s,f,v),p.id},this.sendResult=async(s,a,l)=>{const p=Cu(s,l),f=await this.core.crypto.encode(a,p),v=await this.core.history.get(a,s),g=gs[v.request.method].res;await this.core.relayer.publish(a,f,g),await this.core.history.resolve(p)},this.sendError=async(s,a,l)=>{const p=na(s,l),f=await this.core.crypto.encode(a,p),v=await this.core.history.get(a,s),g=gs[v.request.method]?gs[v.request.method].res:gs.unregistered_method.res;await this.core.relayer.publish(a,f,g),await this.core.history.resolve(p)},this.deletePairing=async(s,a)=>{await this.core.relayer.unsubscribe(s),await Promise.all([this.pairings.delete(s,$t("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(s),a?Promise.resolve():this.core.expirer.del(s)])},this.cleanup=async()=>{const s=this.pairings.getAll().filter(a=>Di(a.expiry));await Promise.all(s.map(a=>this.deletePairing(a.topic)))},this.onRelayEventRequest=s=>{const{topic:a,payload:l}=s;switch(l.method){case"wc_pairingPing":return this.onPairingPingRequest(a,l);case"wc_pairingDelete":return this.onPairingDeleteRequest(a,l);default:return this.onUnknownRpcMethodRequest(a,l)}},this.onRelayEventResponse=async s=>{const{topic:a,payload:l}=s,p=(await this.core.history.get(a,l.id)).request.method;switch(p){case"wc_pairingPing":return this.onPairingPingResponse(a,l);default:return this.onUnknownRpcMethodResponse(p)}},this.onPairingPingRequest=async(s,a)=>{const{id:l}=a;try{this.isValidPing({topic:s}),await this.sendResult(l,s,!0),this.events.emit(bs.ping,{id:l,topic:s})}catch(p){await this.sendError(l,s,p),this.logger.error(p)}},this.onPairingPingResponse=(s,a)=>{const{id:l}=a;setTimeout(()=>{Ei(a)?this.events.emit(zt("pairing_ping",l),{}):Wr(a)&&this.events.emit(zt("pairing_ping",l),{error:a.error})},500)},this.onPairingDeleteRequest=async(s,a)=>{const{id:l}=a;try{this.isValidDisconnect({topic:s}),await this.deletePairing(s),this.events.emit(bs.delete,{id:l,topic:s})}catch(p){await this.sendError(l,s,p),this.logger.error(p)}},this.onUnknownRpcMethodRequest=async(s,a)=>{const{id:l,method:p}=a;try{if(this.registeredMethods.includes(p))return;const f=$t("WC_METHOD_UNSUPPORTED",p);await this.sendError(l,s,f),this.logger.error(f)}catch(f){await this.sendError(l,s,f),this.logger.error(f)}},this.onUnknownRpcMethodResponse=s=>{this.registeredMethods.includes(s)||this.logger.error($t("WC_METHOD_UNSUPPORTED",s))},this.isValidPair=s=>{var a;if(!wr(s)){const{message:p}=ae("MISSING_OR_INVALID",`pair() params: ${s}`);throw new Error(p)}if(!wE(s.uri)){const{message:p}=ae("MISSING_OR_INVALID",`pair() uri: ${s.uri}`);throw new Error(p)}const l=Sf(s.uri);if(!((a=l==null?void 0:l.relay)!=null&&a.protocol)){const{message:p}=ae("MISSING_OR_INVALID","pair() uri#relay-protocol");throw new Error(p)}if(!(l!=null&&l.symKey)){const{message:p}=ae("MISSING_OR_INVALID","pair() uri#symKey");throw new Error(p)}},this.isValidPing=async s=>{if(!wr(s)){const{message:l}=ae("MISSING_OR_INVALID",`ping() params: ${s}`);throw new Error(l)}const{topic:a}=s;await this.isValidPairingTopic(a)},this.isValidDisconnect=async s=>{if(!wr(s)){const{message:l}=ae("MISSING_OR_INVALID",`disconnect() params: ${s}`);throw new Error(l)}const{topic:a}=s;await this.isValidPairingTopic(a)},this.isValidPairingTopic=async s=>{if(!Wt(s,!1)){const{message:a}=ae("MISSING_OR_INVALID",`pairing topic should be a string: ${s}`);throw new Error(a)}if(!this.pairings.keys.includes(s)){const{message:a}=ae("NO_MATCHING_KEY",`pairing topic doesn't exist: ${s}`);throw new Error(a)}if(Di(this.pairings.get(s).expiry)){await this.deletePairing(s);const{message:a}=ae("EXPIRED",`pairing topic: ${s}`);throw new Error(a)}},this.core=e,this.logger=Ze.generateChildLogger(r,this.name),this.pairings=new aa(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Ze.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=ae("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(er.message,async e=>{const{topic:r,message:s}=e;if(!this.pairings.keys.includes(r)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(s)))return;const a=await this.core.crypto.decode(r,s);try{Lu(a)?(this.core.history.set(r,a),this.onRelayEventRequest({topic:r,payload:a})):sa(a)&&(await this.core.history.resolve(a),await this.onRelayEventResponse({topic:r,payload:a}),this.core.history.delete(r,a.id))}catch(l){this.logger.error(l)}})}registerExpirerEvents(){this.core.expirer.on(jr.expired,async e=>{const{topic:r}=Wd(e.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit(bs.expire,{topic:r}))})}}class $2 extends tw{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.records=new Map,this.events=new lr.exports.EventEmitter,this.name=u2,this.version=h2,this.cached=[],this.initialized=!1,this.storagePrefix=Ui,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.records.set(s.id,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(s,a,l)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:s,request:a,chainId:l}),this.records.has(a.id))return;const p={id:a.id,topic:s,request:{method:a.method,params:a.params||null},chainId:l,expiry:Gr(ye.THIRTY_DAYS)};this.records.set(p.id,p),this.events.emit(ri.created,p)},this.resolve=async s=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:s}),!this.records.has(s.id))return;const a=await this.getRecord(s.id);typeof a.response>"u"&&(a.response=Wr(s)?{error:s.error}:{result:s.result},this.records.set(a.id,a),this.events.emit(ri.updated,a))},this.get=async(s,a)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:s,id:a}),await this.getRecord(a)),this.delete=(s,a)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:a}),this.values.forEach(l=>{if(l.topic===s){if(typeof a<"u"&&l.id!==a)return;this.records.delete(l.id),this.events.emit(ri.deleted,l)}})},this.exists=async(s,a)=>(this.isInitialized(),this.records.has(a)?(await this.getRecord(a)).topic===s:!1),this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.logger=Ze.generateChildLogger(r,this.name)}get context(){return Ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const s={topic:r.topic,request:jn(r.request.method,r.request.params,r.id),chainId:r.chainId};return e.push(s)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const r=this.records.get(e);if(!r){const{message:s}=ae("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(s)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(ri.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:r}=ae("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(ri.created,e=>{const r=ri.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(ri.updated,e=>{const r=ri.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(ri.deleted,e=>{const r=ri.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.core.heartbeat.on(qn.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(e=>{ye.toMiliseconds(e.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${e.id}`),this.delete(e.topic,e.id))})}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=ae("NOT_INITIALIZED",this.name);throw new Error(e)}}}class F2 extends aw{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.expirations=new Map,this.events=new lr.exports.EventEmitter,this.name=l2,this.version=f2,this.cached=[],this.initialized=!1,this.storagePrefix=Ui,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.expirations.set(s.target,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=s=>{try{const a=this.formatTarget(s);return typeof this.getExpiration(a)<"u"}catch{return!1}},this.set=(s,a)=>{this.isInitialized();const l=this.formatTarget(s),p={target:l,expiry:a};this.expirations.set(l,p),this.checkExpiry(l,p),this.events.emit(jr.created,{target:l,expiration:p})},this.get=s=>{this.isInitialized();const a=this.formatTarget(s);return this.getExpiration(a)},this.del=s=>{if(this.isInitialized(),this.has(s)){const a=this.formatTarget(s),l=this.getExpiration(a);this.expirations.delete(a),this.events.emit(jr.deleted,{target:a,expiration:l})}},this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.logger=Ze.generateChildLogger(r,this.name)}get context(){return Ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return Zb(e);if(typeof e=="number")return eE(e);const{message:r}=ae("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(r)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(jr.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:r}=ae("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const r=this.expirations.get(e);if(!r){const{message:s}=ae("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}return r}checkExpiry(e,r){const{expiry:s}=r;ye.toMiliseconds(s)-Date.now()<=0&&this.expire(e,r)}expire(e,r){this.expirations.delete(e),this.events.emit(jr.expired,{target:e,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,r)=>this.checkExpiry(r,e))}registerEventListeners(){this.core.heartbeat.on(qn.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(jr.created,e=>{const r=jr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(jr.expired,e=>{const r=jr.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(jr.deleted,e=>{const r=jr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=ae("NOT_INITIALIZED",this.name);throw new Error(e)}}}class D2 extends cw{constructor(e,r){super(e,r),this.projectId=e,this.logger=r,this.name=kc,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async s=>{if(this.verifyDisabled||Kn()||!Bn())return;const a=this.getVerifyUrl(s==null?void 0:s.verifyUrl);this.verifyUrl!==a&&this.removeIframe(),this.verifyUrl=a;try{await this.createIframe()}catch(l){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(l)}if(!this.initialized){this.removeIframe(),this.verifyUrl=pu;try{await this.createIframe()}catch(l){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(l),this.verifyDisabled=!0}}},this.register=async s=>{this.initialized?this.sendPost(s.attestationId):(this.addToQueue(s.attestationId),await this.init())},this.resolve=async s=>{if(this.isDevEnv)return"";const a=this.getVerifyUrl(s==null?void 0:s.verifyUrl);let l;try{l=await this.fetchAttestation(s.attestationId,a)}catch(p){this.logger.info(`failed to resolve attestation: ${s.attestationId} from url: ${a}`),this.logger.info(p),l=await this.fetchAttestation(s.attestationId,pu)}return l},this.fetchAttestation=async(s,a)=>{this.logger.info(`resolving attestation: ${s} from url: ${a}`);const l=this.startAbortTimer(ye.ONE_SECOND*2),p=await fetch(`${a}/attestation/${s}`,{signal:this.abortController.signal});return clearTimeout(l),p.status===200?await p.json():void 0},this.addToQueue=s=>{this.queue.push(s)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(s=>this.sendPost(s)),this.queue=[])},this.sendPost=s=>{var a;try{if(!this.iframe)return;(a=this.iframe.contentWindow)==null||a.postMessage(s,"*"),this.logger.info(`postMessage sent: ${s} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let s;const a=l=>{l.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",a),s())};await Promise.race([new Promise(l=>{if(document.getElementById(kc))return l();window.addEventListener("message",a);const p=document.createElement("iframe");p.id=kc,p.src=`${this.verifyUrl}/${this.projectId}`,p.style.display="none",document.body.append(p),this.iframe=p,s=l}),new Promise((l,p)=>setTimeout(()=>{window.removeEventListener("message",a),p("verify iframe load timeout")},ye.toMiliseconds(ye.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.getVerifyUrl=s=>{let a=s||Fn;return d2.includes(a)||(this.logger.info(`verify url: ${a}, not included in trusted list, assigning default: ${Fn}`),a=Fn),a},this.logger=Ze.generateChildLogger(r,this.name),this.verifyUrl=Fn,this.abortController=new AbortController,this.isDevEnv=Ou()&&{}.IS_VITEST}get context(){return Ze.getLoggerContext(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),ye.toMiliseconds(e))}}var U2=Object.defineProperty,Xf=Object.getOwnPropertySymbols,M2=Object.prototype.hasOwnProperty,j2=Object.prototype.propertyIsEnumerable,Zf=(n,e,r)=>e in n?U2(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,ed=(n,e)=>{for(var r in e||(e={}))M2.call(e,r)&&Zf(n,r,e[r]);if(Xf)for(var r of Xf(e))j2.call(e,r)&&Zf(n,r,e[r]);return n};class Fu extends ew{constructor(e){super(e),this.protocol=gp,this.version=jI,this.name=$u,this.events=new lr.exports.EventEmitter,this.initialized=!1,this.on=(s,a)=>this.events.on(s,a),this.once=(s,a)=>this.events.once(s,a),this.off=(s,a)=>this.events.off(s,a),this.removeListener=(s,a)=>this.events.removeListener(s,a),this.projectId=e==null?void 0:e.projectId,this.relayUrl=(e==null?void 0:e.relayUrl)||yp,this.customStoragePrefix=e!=null&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const r=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Ze.pino(Ze.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||qI.logger}));this.logger=Ze.generateChildLogger(r,this.name),this.heartbeat=new qn.HeartBeat,this.crypto=new g2(this,this.logger,e==null?void 0:e.keychain),this.history=new $2(this,this.logger),this.expirer=new F2(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new U_(ed(ed({},HI),e==null?void 0:e.storageOptions)),this.relayer=new N2({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new L2(this,this.logger),this.verify=new D2(this.projectId||"",this.logger)}static async init(e){const r=new Fu(e);await r.initialize();const s=await r.crypto.getClientId();return await r.storage.setItem(i2,s),r}get context(){return Ze.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const q2=Fu,mp="wc",_p=2,wp="client",Du=`${mp}@${_p}:${wp}:`,Gc={name:wp,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},td="WALLETCONNECT_DEEPLINK_CHOICE",H2="proposal",bp="Proposal expired",z2="session",qo=ye.SEVEN_DAYS,K2="engine",ys={wc_sessionPropose:{req:{ttl:ye.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:ye.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:ye.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:ye.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:ye.ONE_DAY,prompt:!1,tag:1104},res:{ttl:ye.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:ye.ONE_DAY,prompt:!1,tag:1106},res:{ttl:ye.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:ye.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:ye.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:ye.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:ye.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:ye.ONE_DAY,prompt:!1,tag:1112},res:{ttl:ye.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:ye.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:ye.THIRTY_SECONDS,prompt:!1,tag:1115}}},Wc={min:ye.FIVE_MINUTES,max:ye.SEVEN_DAYS},bi={idle:"IDLE",active:"ACTIVE"},B2="request",k2=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var V2=Object.defineProperty,G2=Object.defineProperties,W2=Object.getOwnPropertyDescriptors,rd=Object.getOwnPropertySymbols,Y2=Object.prototype.hasOwnProperty,J2=Object.prototype.propertyIsEnumerable,id=(n,e,r)=>e in n?V2(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,mr=(n,e)=>{for(var r in e||(e={}))Y2.call(e,r)&&id(n,r,e[r]);if(rd)for(var r of rd(e))J2.call(e,r)&&id(n,r,e[r]);return n},ms=(n,e)=>G2(n,W2(e));class Q2 extends hw{constructor(e){super(e),this.name=K2,this.events=new lr.exports,this.initialized=!1,this.ignoredPayloadTypes=[ln],this.requestQueue={state:bi.idle,queue:[]},this.sessionRequestQueue={state:bi.idle,queue:[]},this.requestQueueDelay=ye.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(ys)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},ye.toMiliseconds(this.requestQueueDelay)))},this.connect=async r=>{await this.isInitialized();const s=ms(mr({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(s);const{pairingTopic:a,requiredNamespaces:l,optionalNamespaces:p,sessionProperties:f,relays:v}=s;let g=a,_,I=!1;if(g&&(I=this.client.core.pairing.pairings.get(g).active),!g||!I){const{topic:M,uri:x}=await this.client.core.pairing.create();g=M,_=x}const P=await this.client.core.crypto.generateKeyPair(),A=mr({requiredNamespaces:l,optionalNamespaces:p,relays:v!=null?v:[{protocol:vp}],proposer:{publicKey:P,metadata:this.client.metadata}},f&&{sessionProperties:f}),{reject:L,resolve:K,done:B}=$n(ye.FIVE_MINUTES,bp);if(this.events.once(zt("session_connect"),async({error:M,session:x})=>{if(M)L(M);else if(x){x.self.publicKey=P;const R=ms(mr({},x),{requiredNamespaces:x.requiredNamespaces,optionalNamespaces:x.optionalNamespaces});await this.client.session.set(x.topic,R),await this.setExpiry(x.topic,x.expiry),g&&await this.client.core.pairing.updateMetadata({topic:g,metadata:x.peer.metadata}),K(R)}}),!g){const{message:M}=ae("NO_MATCHING_KEY",`connect() pairing topic: ${g}`);throw new Error(M)}const ne=await this.sendRequest({topic:g,method:"wc_sessionPropose",params:A}),T=Gr(ye.FIVE_MINUTES);return await this.setProposal(ne,mr({id:ne,expiry:T},A)),{uri:_,approval:B}},this.pair=async r=>(await this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{await this.isInitialized(),await this.isValidApprove(r);const{id:s,relayProtocol:a,namespaces:l,sessionProperties:p}=r,f=this.client.proposal.get(s);let{pairingTopic:v,proposer:g,requiredNamespaces:_,optionalNamespaces:I}=f;v=v||"",Mn(_)||(_=gE(l,"approve()"));const P=await this.client.core.crypto.generateKeyPair(),A=g.publicKey,L=await this.client.core.crypto.generateSharedKey(P,A);v&&s&&(await this.client.core.pairing.updateMetadata({topic:v,metadata:g.metadata}),await this.sendResult({id:s,topic:v,result:{relay:{protocol:a!=null?a:"irn"},responderPublicKey:P}}),await this.client.proposal.delete(s,$t("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:v}));const K=mr({relay:{protocol:a!=null?a:"irn"},namespaces:l,requiredNamespaces:_,optionalNamespaces:I,pairingTopic:v,controller:{publicKey:P,metadata:this.client.metadata},expiry:Gr(qo)},p&&{sessionProperties:p});await this.client.core.relayer.subscribe(L),await this.sendRequest({topic:L,method:"wc_sessionSettle",params:K,throwOnFailedPublish:!0});const B=ms(mr({},K),{topic:L,pairingTopic:v,acknowledged:!1,self:K.controller,peer:{publicKey:g.publicKey,metadata:g.metadata},controller:P});return await this.client.session.set(L,B),await this.setExpiry(L,Gr(qo)),{topic:L,acknowledged:()=>new Promise(ne=>setTimeout(()=>ne(this.client.session.get(L)),500))}},this.reject=async r=>{await this.isInitialized(),await this.isValidReject(r);const{id:s,reason:a}=r,{pairingTopic:l}=this.client.proposal.get(s);l&&(await this.sendError(s,l,a),await this.client.proposal.delete(s,$t("USER_DISCONNECTED")))},this.update=async r=>{await this.isInitialized(),await this.isValidUpdate(r);const{topic:s,namespaces:a}=r,l=await this.sendRequest({topic:s,method:"wc_sessionUpdate",params:{namespaces:a}}),{done:p,resolve:f,reject:v}=$n();return this.events.once(zt("session_update",l),({error:g})=>{g?v(g):f()}),await this.client.session.update(s,{namespaces:a}),{acknowledged:p}},this.extend=async r=>{await this.isInitialized(),await this.isValidExtend(r);const{topic:s}=r,a=await this.sendRequest({topic:s,method:"wc_sessionExtend",params:{}}),{done:l,resolve:p,reject:f}=$n();return this.events.once(zt("session_extend",a),({error:v})=>{v?f(v):p()}),await this.setExpiry(s,Gr(qo)),{acknowledged:l}},this.request=async r=>{await this.isInitialized(),await this.isValidRequest(r);const{chainId:s,request:a,topic:l,expiry:p}=r,f=Tu(),{done:v,resolve:g,reject:_}=$n(p,"Request expired. Please try again.");return this.events.once(zt("session_request",f),({error:I,result:P})=>{I?_(I):g(P)}),await Promise.all([new Promise(async I=>{await this.sendRequest({clientRpcId:f,topic:l,method:"wc_sessionRequest",params:{request:a,chainId:s},expiry:p,throwOnFailedPublish:!0}).catch(P=>_(P)),this.client.events.emit("session_request_sent",{topic:l,request:a,chainId:s,id:f}),I()}),new Promise(async I=>{const P=await rE(this.client.core.storage,td);tE({id:f,topic:l,wcDeepLink:P}),I()}),v()]).then(I=>I[2])},this.respond=async r=>{await this.isInitialized(),await this.isValidRespond(r);const{topic:s,response:a}=r,{id:l}=a;Ei(a)?await this.sendResult({id:l,topic:s,result:a.result,throwOnFailedPublish:!0}):Wr(a)&&await this.sendError(l,s,a.error),this.cleanupAfterResponse(r)},this.ping=async r=>{await this.isInitialized(),await this.isValidPing(r);const{topic:s}=r;if(this.client.session.keys.includes(s)){const a=await this.sendRequest({topic:s,method:"wc_sessionPing",params:{}}),{done:l,resolve:p,reject:f}=$n();this.events.once(zt("session_ping",a),({error:v})=>{v?f(v):p()}),await l()}else this.client.core.pairing.pairings.keys.includes(s)&&await this.client.core.pairing.ping({topic:s})},this.emit=async r=>{await this.isInitialized(),await this.isValidEmit(r);const{topic:s,event:a,chainId:l}=r;await this.sendRequest({topic:s,method:"wc_sessionEvent",params:{event:a,chainId:l}})},this.disconnect=async r=>{await this.isInitialized(),await this.isValidDisconnect(r);const{topic:s}=r;this.client.session.keys.includes(s)?(await this.sendRequest({topic:s,method:"wc_sessionDelete",params:$t("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession(s)):await this.client.core.pairing.disconnect({topic:s})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(s=>mE(s,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async r=>{if(r.pairingTopic)try{const s=this.client.core.pairing.pairings.get(r.pairingTopic),a=this.client.core.pairing.pairings.getAll().filter(l=>{var p,f;return((p=l.peerMetadata)==null?void 0:p.url)&&((f=l.peerMetadata)==null?void 0:f.url)===r.peer.metadata.url&&l.topic&&l.topic!==s.topic});if(a.length===0)return;this.client.logger.info(`Cleaning up ${a.length} duplicate pairing(s)`),await Promise.all(a.map(l=>this.client.core.pairing.disconnect({topic:l.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(s){this.client.logger.error(s)}},this.deleteSession=async(r,s)=>{const{self:a}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),this.client.session.delete(r,$t("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(a.publicKey)&&await this.client.core.crypto.deleteKeyPair(a.publicKey),this.client.core.crypto.keychain.has(r)&&await this.client.core.crypto.deleteSymKey(r),s||this.client.core.expirer.del(r),this.client.core.storage.removeItem(td).catch(l=>this.client.logger.warn(l))},this.deleteProposal=async(r,s)=>{await Promise.all([this.client.proposal.delete(r,$t("USER_DISCONNECTED")),s?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,s,a=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,s),a?Promise.resolve():this.client.core.expirer.del(r)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(l=>l.id!==r),a&&(this.sessionRequestQueue.state=bi.idle)},this.setExpiry=async(r,s)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:s}),this.client.core.expirer.set(r,s)},this.setProposal=async(r,s)=>{await this.client.proposal.set(r,s),this.client.core.expirer.set(r,s.expiry)},this.setPendingSessionRequest=async r=>{const s=ys.wc_sessionRequest.req.ttl,{id:a,topic:l,params:p,verifyContext:f}=r;await this.client.pendingRequest.set(a,{id:a,topic:l,params:p,verifyContext:f}),s&&this.client.core.expirer.set(a,Gr(s))},this.sendRequest=async r=>{const{topic:s,method:a,params:l,expiry:p,relayRpcId:f,clientRpcId:v,throwOnFailedPublish:g}=r,_=jn(a,l,v);if(Bn()&&k2.includes(a)){const A=Un(JSON.stringify(_));this.client.core.verify.register({attestationId:A})}const I=await this.client.core.crypto.encode(s,_),P=ys[a].req;return p&&(P.ttl=p),f&&(P.id=f),this.client.core.history.set(s,_),g?(P.internal=ms(mr({},P.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,I,P)):this.client.core.relayer.publish(s,I,P).catch(A=>this.client.logger.error(A)),_.id},this.sendResult=async r=>{const{id:s,topic:a,result:l,throwOnFailedPublish:p}=r,f=Cu(s,l),v=await this.client.core.crypto.encode(a,f),g=await this.client.core.history.get(a,s),_=ys[g.request.method].res;p?(_.internal=ms(mr({},_.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(a,v,_)):this.client.core.relayer.publish(a,v,_).catch(I=>this.client.logger.error(I)),await this.client.core.history.resolve(f)},this.sendError=async(r,s,a)=>{const l=na(r,a),p=await this.client.core.crypto.encode(s,l),f=await this.client.core.history.get(s,r),v=ys[f.request.method].res;this.client.core.relayer.publish(s,p,v),await this.client.core.history.resolve(l)},this.cleanup=async()=>{const r=[],s=[];this.client.session.getAll().forEach(a=>{Di(a.expiry)&&r.push(a.topic)}),this.client.proposal.getAll().forEach(a=>{Di(a.expiry)&&s.push(a.id)}),await Promise.all([...r.map(a=>this.deleteSession(a)),...s.map(a=>this.deleteProposal(a))])},this.onRelayEventRequest=async r=>{this.requestQueue.queue.push(r),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===bi.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=bi.active;const r=this.requestQueue.queue.shift();if(r)try{this.processRequest(r),await new Promise(s=>setTimeout(s,300))}catch(s){this.client.logger.warn(s)}}this.requestQueue.state=bi.idle},this.processRequest=r=>{const{topic:s,payload:a}=r,l=a.method;switch(l){case"wc_sessionPropose":return this.onSessionProposeRequest(s,a);case"wc_sessionSettle":return this.onSessionSettleRequest(s,a);case"wc_sessionUpdate":return this.onSessionUpdateRequest(s,a);case"wc_sessionExtend":return this.onSessionExtendRequest(s,a);case"wc_sessionPing":return this.onSessionPingRequest(s,a);case"wc_sessionDelete":return this.onSessionDeleteRequest(s,a);case"wc_sessionRequest":return this.onSessionRequest(s,a);case"wc_sessionEvent":return this.onSessionEventRequest(s,a);default:return this.client.logger.info(`Unsupported request method ${l}`)}},this.onRelayEventResponse=async r=>{const{topic:s,payload:a}=r,l=(await this.client.core.history.get(s,a.id)).request.method;switch(l){case"wc_sessionPropose":return this.onSessionProposeResponse(s,a);case"wc_sessionSettle":return this.onSessionSettleResponse(s,a);case"wc_sessionUpdate":return this.onSessionUpdateResponse(s,a);case"wc_sessionExtend":return this.onSessionExtendResponse(s,a);case"wc_sessionPing":return this.onSessionPingResponse(s,a);case"wc_sessionRequest":return this.onSessionRequestResponse(s,a);default:return this.client.logger.info(`Unsupported response method ${l}`)}},this.onRelayEventUnknownPayload=r=>{const{topic:s}=r,{message:a}=ae("MISSING_OR_INVALID",`Decoded payload on topic ${s} is not identifiable as a JSON-RPC request or a response.`);throw new Error(a)},this.onSessionProposeRequest=async(r,s)=>{const{params:a,id:l}=s;try{this.isValidConnect(mr({},s.params));const p=Gr(ye.FIVE_MINUTES),f=mr({id:l,pairingTopic:r,expiry:p},a);await this.setProposal(l,f);const v=Un(JSON.stringify(s)),g=await this.getVerifyContext(v,f.proposer.metadata);this.client.events.emit("session_proposal",{id:l,params:f,verifyContext:g})}catch(p){await this.sendError(l,r,p),this.client.logger.error(p)}},this.onSessionProposeResponse=async(r,s)=>{const{id:a}=s;if(Ei(s)){const{result:l}=s;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:l});const p=this.client.proposal.get(a);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:p});const f=p.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:f});const v=l.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:v});const g=await this.client.core.crypto.generateSharedKey(f,v);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:g});const _=await this.client.core.relayer.subscribe(g);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:_}),await this.client.core.pairing.activate({topic:r})}else Wr(s)&&(await this.client.proposal.delete(a,$t("USER_DISCONNECTED")),this.events.emit(zt("session_connect"),{error:s.error}))},this.onSessionSettleRequest=async(r,s)=>{const{id:a,params:l}=s;try{this.isValidSessionSettleRequest(l);const{relay:p,controller:f,expiry:v,namespaces:g,requiredNamespaces:_,optionalNamespaces:I,sessionProperties:P,pairingTopic:A}=s.params,L=mr({topic:r,relay:p,expiry:v,namespaces:g,acknowledged:!0,pairingTopic:A,requiredNamespaces:_,optionalNamespaces:I,controller:f.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:f.publicKey,metadata:f.metadata}},P&&{sessionProperties:P});await this.sendResult({id:s.id,topic:r,result:!0}),this.events.emit(zt("session_connect"),{session:L}),this.cleanupDuplicatePairings(L)}catch(p){await this.sendError(a,r,p),this.client.logger.error(p)}},this.onSessionSettleResponse=async(r,s)=>{const{id:a}=s;Ei(s)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(zt("session_approve",a),{})):Wr(s)&&(await this.client.session.delete(r,$t("USER_DISCONNECTED")),this.events.emit(zt("session_approve",a),{error:s.error}))},this.onSessionUpdateRequest=async(r,s)=>{const{params:a,id:l}=s;try{const p=`${r}_session_update`,f=jo.get(p);if(f&&this.isRequestOutOfSync(f,l)){this.client.logger.info(`Discarding out of sync request - ${l}`);return}this.isValidUpdate(mr({topic:r},a)),await this.client.session.update(r,{namespaces:a.namespaces}),await this.sendResult({id:l,topic:r,result:!0}),this.client.events.emit("session_update",{id:l,topic:r,params:a}),jo.set(p,l)}catch(p){await this.sendError(l,r,p),this.client.logger.error(p)}},this.isRequestOutOfSync=(r,s)=>parseInt(s.toString().slice(0,-3))<=parseInt(r.toString().slice(0,-3)),this.onSessionUpdateResponse=(r,s)=>{const{id:a}=s;Ei(s)?this.events.emit(zt("session_update",a),{}):Wr(s)&&this.events.emit(zt("session_update",a),{error:s.error})},this.onSessionExtendRequest=async(r,s)=>{const{id:a}=s;try{this.isValidExtend({topic:r}),await this.setExpiry(r,Gr(qo)),await this.sendResult({id:a,topic:r,result:!0}),this.client.events.emit("session_extend",{id:a,topic:r})}catch(l){await this.sendError(a,r,l),this.client.logger.error(l)}},this.onSessionExtendResponse=(r,s)=>{const{id:a}=s;Ei(s)?this.events.emit(zt("session_extend",a),{}):Wr(s)&&this.events.emit(zt("session_extend",a),{error:s.error})},this.onSessionPingRequest=async(r,s)=>{const{id:a}=s;try{this.isValidPing({topic:r}),await this.sendResult({id:a,topic:r,result:!0}),this.client.events.emit("session_ping",{id:a,topic:r})}catch(l){await this.sendError(a,r,l),this.client.logger.error(l)}},this.onSessionPingResponse=(r,s)=>{const{id:a}=s;setTimeout(()=>{Ei(s)?this.events.emit(zt("session_ping",a),{}):Wr(s)&&this.events.emit(zt("session_ping",a),{error:s.error})},500)},this.onSessionDeleteRequest=async(r,s)=>{const{id:a}=s;try{this.isValidDisconnect({topic:r,reason:s.params}),await Promise.all([new Promise(l=>{this.client.core.relayer.once(er.publish,async()=>{l(await this.deleteSession(r))})}),this.sendResult({id:a,topic:r,result:!0})]),this.client.events.emit("session_delete",{id:a,topic:r})}catch(l){this.client.logger.error(l)}},this.onSessionRequest=async(r,s)=>{const{id:a,params:l}=s;try{this.isValidRequest(mr({topic:r},l));const p=Un(JSON.stringify(jn("wc_sessionRequest",l,a))),f=this.client.session.get(r),v=await this.getVerifyContext(p,f.peer.metadata),g={id:a,topic:r,params:l,verifyContext:v};await this.setPendingSessionRequest(g),this.addSessionRequestToSessionRequestQueue(g),this.processSessionRequestQueue()}catch(p){await this.sendError(a,r,p),this.client.logger.error(p)}},this.onSessionRequestResponse=(r,s)=>{const{id:a}=s;Ei(s)?this.events.emit(zt("session_request",a),{result:s.result}):Wr(s)&&this.events.emit(zt("session_request",a),{error:s.error})},this.onSessionEventRequest=async(r,s)=>{const{id:a,params:l}=s;try{const p=`${r}_session_event_${l.event.name}`,f=jo.get(p);if(f&&this.isRequestOutOfSync(f,a)){this.client.logger.info(`Discarding out of sync request - ${a}`);return}this.isValidEmit(mr({topic:r},l)),this.client.events.emit("session_event",{id:a,topic:r,params:l}),jo.set(p,a)}catch(p){await this.sendError(a,r,p),this.client.logger.error(p)}},this.addSessionRequestToSessionRequestQueue=r=>{this.sessionRequestQueue.queue.push(r)},this.cleanupAfterResponse=r=>{this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=bi.idle,this.processSessionRequestQueue()},ye.toMiliseconds(this.requestQueueDelay))},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===bi.active){this.client.logger.info("session request queue is already active.");return}const r=this.sessionRequestQueue.queue[0];if(!r){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=bi.active,this.client.events.emit("session_request",r)}catch(s){this.client.logger.error(s)}},this.onPairingCreated=r=>{if(r.active)return;const s=this.client.proposal.getAll().find(a=>a.pairingTopic===r.topic);s&&this.onSessionProposeRequest(r.topic,jn("wc_sessionPropose",{requiredNamespaces:s.requiredNamespaces,optionalNamespaces:s.optionalNamespaces,relays:s.relays,proposer:s.proposer,sessionProperties:s.sessionProperties},s.id))},this.isValidConnect=async r=>{if(!wr(r)){const{message:v}=ae("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(v)}const{pairingTopic:s,requiredNamespaces:a,optionalNamespaces:l,sessionProperties:p,relays:f}=r;if(cr(s)||await this.isValidPairingTopic(s),!RE(f,!0)){const{message:v}=ae("MISSING_OR_INVALID",`connect() relays: ${f}`);throw new Error(v)}!cr(a)&&Mn(a)!==0&&this.validateNamespaces(a,"requiredNamespaces"),!cr(l)&&Mn(l)!==0&&this.validateNamespaces(l,"optionalNamespaces"),cr(p)||this.validateSessionProps(p,"sessionProperties")},this.validateNamespaces=(r,s)=>{const a=NE(r,"connect()",s);if(a)throw new Error(a.message)},this.isValidApprove=async r=>{if(!wr(r))throw new Error(ae("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:s,namespaces:a,relayProtocol:l,sessionProperties:p}=r;await this.isValidProposalId(s);const f=this.client.proposal.get(s),v=Vo(a,"approve()");if(v)throw new Error(v.message);const g=Of(f.requiredNamespaces,a,"approve()");if(g)throw new Error(g.message);if(!Wt(l,!0)){const{message:_}=ae("MISSING_OR_INVALID",`approve() relayProtocol: ${l}`);throw new Error(_)}cr(p)||this.validateSessionProps(p,"sessionProperties")},this.isValidReject=async r=>{if(!wr(r)){const{message:l}=ae("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(l)}const{id:s,reason:a}=r;if(await this.isValidProposalId(s),!CE(a)){const{message:l}=ae("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(a)}`);throw new Error(l)}},this.isValidSessionSettleRequest=r=>{if(!wr(r)){const{message:g}=ae("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(g)}const{relay:s,controller:a,namespaces:l,expiry:p}=r;if(!Jd(s)){const{message:g}=ae("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(g)}const f=IE(a,"onSessionSettleRequest()");if(f)throw new Error(f.message);const v=Vo(l,"onSessionSettleRequest()");if(v)throw new Error(v.message);if(Di(p)){const{message:g}=ae("EXPIRED","onSessionSettleRequest()");throw new Error(g)}},this.isValidUpdate=async r=>{if(!wr(r)){const{message:v}=ae("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(v)}const{topic:s,namespaces:a}=r;await this.isValidSessionTopic(s);const l=this.client.session.get(s),p=Vo(a,"update()");if(p)throw new Error(p.message);const f=Of(l.requiredNamespaces,a,"update()");if(f)throw new Error(f.message)},this.isValidExtend=async r=>{if(!wr(r)){const{message:a}=ae("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(a)}const{topic:s}=r;await this.isValidSessionTopic(s)},this.isValidRequest=async r=>{if(!wr(r)){const{message:v}=ae("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(v)}const{topic:s,request:a,chainId:l,expiry:p}=r;await this.isValidSessionTopic(s);const{namespaces:f}=this.client.session.get(s);if(!Pf(f,l)){const{message:v}=ae("MISSING_OR_INVALID",`request() chainId: ${l}`);throw new Error(v)}if(!LE(a)){const{message:v}=ae("MISSING_OR_INVALID",`request() ${JSON.stringify(a)}`);throw new Error(v)}if(!DE(f,l,a.method)){const{message:v}=ae("MISSING_OR_INVALID",`request() method: ${a.method}`);throw new Error(v)}if(p&&!qE(p,Wc)){const{message:v}=ae("MISSING_OR_INVALID",`request() expiry: ${p}. Expiry must be a number (in seconds) between ${Wc.min} and ${Wc.max}`);throw new Error(v)}},this.isValidRespond=async r=>{if(!wr(r)){const{message:l}=ae("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(l)}const{topic:s,response:a}=r;if(await this.isValidSessionTopic(s),!$E(a)){const{message:l}=ae("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(a)}`);throw new Error(l)}},this.isValidPing=async r=>{if(!wr(r)){const{message:a}=ae("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(a)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.isValidEmit=async r=>{if(!wr(r)){const{message:f}=ae("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(f)}const{topic:s,event:a,chainId:l}=r;await this.isValidSessionTopic(s);const{namespaces:p}=this.client.session.get(s);if(!Pf(p,l)){const{message:f}=ae("MISSING_OR_INVALID",`emit() chainId: ${l}`);throw new Error(f)}if(!FE(a)){const{message:f}=ae("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(f)}if(!UE(p,l,a.name)){const{message:f}=ae("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(f)}},this.isValidDisconnect=async r=>{if(!wr(r)){const{message:a}=ae("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(a)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.getVerifyContext=async(r,s)=>{const a={verified:{verifyUrl:s.verifyUrl||Fn,validation:"UNKNOWN",origin:s.url||""}};try{const l=await this.client.core.verify.resolve({attestationId:r,verifyUrl:s.verifyUrl});l&&(a.verified.origin=l.origin,a.verified.isScam=l.isScam,a.verified.validation=l.origin===new URL(s.url).origin?"VALID":"INVALID")}catch(l){this.client.logger.info(l)}return this.client.logger.info(`Verify context: ${JSON.stringify(a)}`),a},this.validateSessionProps=(r,s)=>{Object.values(r).forEach(a=>{if(!Wt(a,!1)){const{message:l}=ae("MISSING_OR_INVALID",`${s} must be in Record<string, string> format. Received: ${JSON.stringify(a)}`);throw new Error(l)}})}}async isInitialized(){if(!this.initialized){const{message:e}=ae("NOT_INITIALIZED",this.name);throw new Error(e)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(er.message,async e=>{const{topic:r,message:s}=e;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(s)))return;const a=await this.client.core.crypto.decode(r,s);try{Lu(a)?(this.client.core.history.set(r,a),this.onRelayEventRequest({topic:r,payload:a})):sa(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:r,payload:a}),this.client.core.history.delete(r,a.id)):this.onRelayEventUnknownPayload({topic:r,payload:a})}catch(l){this.client.logger.error(l)}})}registerExpirerEvents(){this.client.core.expirer.on(jr.expired,async e=>{const{topic:r,id:s}=Wd(e.target);if(s&&this.client.pendingRequest.keys.includes(s))return await this.deletePendingSessionRequest(s,ae("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):s&&(await this.deleteProposal(s,!0),this.client.events.emit("proposal_expire",{id:s}))})}registerPairingEvents(){this.client.core.pairing.events.on(bs.create,e=>this.onPairingCreated(e))}isValidPairingTopic(e){if(!Wt(e,!1)){const{message:r}=ae("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:r}=ae("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(r)}if(Di(this.client.core.pairing.pairings.get(e).expiry)){const{message:r}=ae("EXPIRED",`pairing topic: ${e}`);throw new Error(r)}}async isValidSessionTopic(e){if(!Wt(e,!1)){const{message:r}=ae("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(r)}if(!this.client.session.keys.includes(e)){const{message:r}=ae("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(r)}if(Di(this.client.session.get(e).expiry)){await this.deleteSession(e);const{message:r}=ae("EXPIRED",`session topic: ${e}`);throw new Error(r)}}async isValidSessionOrPairingTopic(e){if(this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(Wt(e,!1)){const{message:r}=ae("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(r)}else{const{message:r}=ae("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(r)}}async isValidProposalId(e){if(!TE(e)){const{message:r}=ae("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(r)}if(!this.client.proposal.keys.includes(e)){const{message:r}=ae("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(r)}if(Di(this.client.proposal.get(e).expiry)){await this.deleteProposal(e);const{message:r}=ae("EXPIRED",`proposal id: ${e}`);throw new Error(r)}}}class X2 extends aa{constructor(e,r){super(e,r,H2,Du),this.core=e,this.logger=r}}class Z2 extends aa{constructor(e,r){super(e,r,z2,Du),this.core=e,this.logger=r}}class e5 extends aa{constructor(e,r){super(e,r,B2,Du,s=>s.id),this.core=e,this.logger=r}}class Uu extends uw{constructor(e){super(e),this.protocol=mp,this.version=_p,this.name=Gc.name,this.events=new lr.exports.EventEmitter,this.on=(s,a)=>this.events.on(s,a),this.once=(s,a)=>this.events.once(s,a),this.off=(s,a)=>this.events.off(s,a),this.removeListener=(s,a)=>this.events.removeListener(s,a),this.removeAllListeners=s=>this.events.removeAllListeners(s),this.connect=async s=>{try{return await this.engine.connect(s)}catch(a){throw this.logger.error(a.message),a}},this.pair=async s=>{try{return await this.engine.pair(s)}catch(a){throw this.logger.error(a.message),a}},this.approve=async s=>{try{return await this.engine.approve(s)}catch(a){throw this.logger.error(a.message),a}},this.reject=async s=>{try{return await this.engine.reject(s)}catch(a){throw this.logger.error(a.message),a}},this.update=async s=>{try{return await this.engine.update(s)}catch(a){throw this.logger.error(a.message),a}},this.extend=async s=>{try{return await this.engine.extend(s)}catch(a){throw this.logger.error(a.message),a}},this.request=async s=>{try{return await this.engine.request(s)}catch(a){throw this.logger.error(a.message),a}},this.respond=async s=>{try{return await this.engine.respond(s)}catch(a){throw this.logger.error(a.message),a}},this.ping=async s=>{try{return await this.engine.ping(s)}catch(a){throw this.logger.error(a.message),a}},this.emit=async s=>{try{return await this.engine.emit(s)}catch(a){throw this.logger.error(a.message),a}},this.disconnect=async s=>{try{return await this.engine.disconnect(s)}catch(a){throw this.logger.error(a.message),a}},this.find=s=>{try{return this.engine.find(s)}catch(a){throw this.logger.error(a.message),a}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(s){throw this.logger.error(s.message),s}},this.name=(e==null?void 0:e.name)||Gc.name,this.metadata=(e==null?void 0:e.metadata)||Wb();const r=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Ze.pino(Ze.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||Gc.logger}));this.core=(e==null?void 0:e.core)||new q2(e),this.logger=Ze.generateChildLogger(r,this.name),this.session=new Z2(this.core,this.logger),this.proposal=new X2(this.core,this.logger),this.pendingRequest=new e5(this.core,this.logger),this.engine=new Q2(this)}static async init(e){const r=new Uu(e);return await r.initialize(),r}get context(){return Ze.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}}const t5={Accept:"application/json","Content-Type":"application/json"},r5="POST",nd={headers:t5,method:r5},sd=10;class qi{constructor(e,r=!1){if(this.url=e,this.disableProviderPing=r,this.events=new lr.exports.EventEmitter,this.isAvailable=!1,this.registering=!1,!Lf(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=r}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e,r){this.isAvailable||await this.register();try{const s=an(e),l=await(await jl(this.url,Object.assign(Object.assign({},nd),{body:s}))).json();this.onPayload({data:l})}catch(s){this.onError(e.id,s)}}async register(e=this.url){if(!Lf(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((s,a)=>{this.events.once("register_error",l=>{this.resetMaxListeners(),a(l)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return a(new Error("HTTP connection is missing or invalid"));s()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const r=an({id:1,jsonrpc:"2.0",method:"test",params:[]});await jl(e,Object.assign(Object.assign({},nd),{body:r}))}this.onOpen()}catch(r){const s=this.parseError(r);throw this.events.emit("register_error",s),this.onClose(),s}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?Os(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const s=this.parseError(r),a=s.message||s.toString(),l=na(e,a);this.events.emit("payload",l)}parseError(e,r=this.url){return Zd(e,r,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>sd&&this.events.setMaxListeners(sd)}}const od="error",i5="wss://relay.walletconnect.com",n5="wc",s5="universal_provider",ad=`${n5}@2:${s5}:`,o5="https://rpc.walletconnect.com/v1/",Si={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var _s=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof st<"u"?st:typeof self<"u"?self:{},gu={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(n,e){(function(){var r,s="4.17.21",a=200,l="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",p="Expected a function",f="Invalid `variable` option passed into `_.template`",v="__lodash_hash_undefined__",g=500,_="__lodash_placeholder__",I=1,P=2,A=4,L=1,K=2,B=1,ne=2,T=4,M=8,x=16,R=32,b=64,u=128,w=256,G=512,V=30,oe="...",ue=800,ge=16,$=1,H=2,le=3,te=1/0,W=9007199254740991,ee=17976931348623157e292,Y=0/0,re=4294967295,Pe=re-1,ie=re>>>1,we=[["ary",u],["bind",B],["bindKey",ne],["curry",M],["curryRight",x],["flip",G],["partial",R],["partialRight",b],["rearg",w]],he="[object Arguments]",me="[object Array]",q="[object AsyncFunction]",j="[object Boolean]",C="[object Date]",h="[object DOMException]",O="[object Error]",se="[object Function]",fe="[object GeneratorFunction]",Se="[object Map]",ze="[object Number]",ke="[object Null]",Ue="[object Object]",gt="[object Promise]",vt="[object Proxy]",je="[object RegExp]",xe="[object Set]",Le="[object String]",$e="[object Symbol]",qe="[object Undefined]",Ae="[object WeakMap]",Fe="[object WeakSet]",Ie="[object ArrayBuffer]",Ne="[object DataView]",Ke="[object Float32Array]",Oe="[object Float64Array]",Ve="[object Int8Array]",We="[object Int16Array]",et="[object Int32Array]",tt="[object Uint8Array]",Je="[object Uint8ClampedArray]",tr="[object Uint16Array]",fr="[object Uint32Array]",Yr=/\b__p \+= '';/g,rr=/\b(__p \+=) '' \+/g,oi=/(__e\(.*?\)|\b__t\)) \+\n'';/g,xi=/&(?:amp|lt|gt|quot|#39);/g,Hi=/[&<>"']/g,It=RegExp(xi.source),yt=RegExp(Hi.source),St=/<%-([\s\S]+?)%>/g,xt=/<%([\s\S]+?)%>/g,bt=/<%=([\s\S]+?)%>/g,mt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ft=/^\w*$/,Dt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Pt=/[\\^$.*+?()[\]{}|]/g,Ut=RegExp(Pt.source),Ot=/^\s+/,Rt=/\s/,At=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,lt=/\{\n\/\* \[wrapped with (.+)\] \*/,Mt=/,? & /,jt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ca=/[()=,{}\[\]\/\s]/,ua=/\\(\\)?/g,ha=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Rr=/\w*$/,la=/^[-+]0x[0-9a-f]+$/i,fa=/^0b[01]+$/i,da=/^\[object .+?Constructor\]$/,pa=/^0o[0-7]+$/i,ga=/^(?:0|[1-9]\d*)$/,ai=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,dn=/($^)/,va=/['\n\r\u2028\u2029\\]/g,pn="\\ud800-\\udfff",ya="\\u0300-\\u036f",ma="\\ufe20-\\ufe2f",gn="\\u20d0-\\u20ff",Cs=ya+ma+gn,Ls="\\u2700-\\u27bf",qr="a-z\\xdf-\\xf6\\xf8-\\xff",_a="\\xac\\xb1\\xd7\\xf7",wa="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",ba="\\u2000-\\u206f",Ea=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",$s="A-Z\\xc0-\\xd6\\xd8-\\xde",Fs="\\ufe0e\\ufe0f",zi=_a+wa+ba+Ea,Vn="['\u2019]",Ki="["+pn+"]",Gn="["+zi+"]",Bi="["+Cs+"]",Ds="\\d+",Ia="["+Ls+"]",Us="["+qr+"]",Ms="[^"+pn+zi+Ds+Ls+qr+$s+"]",vn="\\ud83c[\\udffb-\\udfff]",Sa="(?:"+Bi+"|"+vn+")",js="[^"+pn+"]",yn="(?:\\ud83c[\\udde6-\\uddff]){2}",Pi="[\\ud800-\\udbff][\\udc00-\\udfff]",Er="["+$s+"]",qs="\\u200d",Hs="(?:"+Us+"|"+Ms+")",Jr="(?:"+Er+"|"+Ms+")",zs="(?:"+Vn+"(?:d|ll|m|re|s|t|ve))?",Ks="(?:"+Vn+"(?:D|LL|M|RE|S|T|VE))?",Bs=Sa+"?",ks="["+Fs+"]?",xa="(?:"+qs+"(?:"+[js,yn,Pi].join("|")+")"+ks+Bs+")*",ci="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Vs="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Gs=ks+Bs+xa,mn="(?:"+[Ia,yn,Pi].join("|")+")"+Gs,Pa="(?:"+[js+Bi+"?",Bi,yn,Pi,Ki].join("|")+")",Wn=RegExp(Vn,"g"),Oa=RegExp(Bi,"g"),_n=RegExp(vn+"(?="+vn+")|"+Pa+Gs,"g"),Ws=RegExp([Er+"?"+Us+"+"+zs+"(?="+[Gn,Er,"$"].join("|")+")",Jr+"+"+Ks+"(?="+[Gn,Er+Hs,"$"].join("|")+")",Er+"?"+Hs+"+"+zs,Er+"+"+Ks,Vs,ci,Ds,mn].join("|"),"g"),Ys=RegExp("["+qs+pn+Cs+Fs+"]"),ki=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Js=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Aa=-1,at={};at[Ke]=at[Oe]=at[Ve]=at[We]=at[et]=at[tt]=at[Je]=at[tr]=at[fr]=!0,at[he]=at[me]=at[Ie]=at[j]=at[Ne]=at[C]=at[O]=at[se]=at[Se]=at[ze]=at[Ue]=at[je]=at[xe]=at[Le]=at[Ae]=!1;var ot={};ot[he]=ot[me]=ot[Ie]=ot[Ne]=ot[j]=ot[C]=ot[Ke]=ot[Oe]=ot[Ve]=ot[We]=ot[et]=ot[Se]=ot[ze]=ot[Ue]=ot[je]=ot[xe]=ot[Le]=ot[$e]=ot[tt]=ot[Je]=ot[tr]=ot[fr]=!0,ot[O]=ot[se]=ot[Ae]=!1;var E={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},F={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},X={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},de={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ct=parseFloat,Te=parseInt,dt=typeof _s=="object"&&_s&&_s.Object===Object&&_s,qt=typeof self=="object"&&self&&self.Object===Object&&self,Qe=dt||qt||Function("return this")(),ut=e&&!e.nodeType&&e,Tt=ut&&!0&&n&&!n.nodeType&&n,dr=Tt&&Tt.exports===ut,Ht=dr&&dt.process,pt=function(){try{var D=Tt&&Tt.require&&Tt.require("util").types;return D||Ht&&Ht.binding&&Ht.binding("util")}catch{}}(),ir=pt&&pt.isArrayBuffer,Hr=pt&&pt.isDate,Tr=pt&&pt.isMap,Qr=pt&&pt.isRegExp,Yn=pt&&pt.isSet,Vi=pt&&pt.isTypedArray;function kt(D,k,z){switch(z.length){case 0:return D.call(k);case 1:return D.call(k,z[0]);case 2:return D.call(k,z[0],z[1]);case 3:return D.call(k,z[0],z[1],z[2])}return D.apply(k,z)}function Sp(D,k,z,pe){for(var Re=-1,rt=D==null?0:D.length;++Re<rt;){var Kt=D[Re];k(pe,Kt,z(Kt),D)}return pe}function Cr(D,k){for(var z=-1,pe=D==null?0:D.length;++z<pe&&k(D[z],z,D)!==!1;);return D}function xp(D,k){for(var z=D==null?0:D.length;z--&&k(D[z],z,D)!==!1;);return D}function qu(D,k){for(var z=-1,pe=D==null?0:D.length;++z<pe;)if(!k(D[z],z,D))return!1;return!0}function Oi(D,k){for(var z=-1,pe=D==null?0:D.length,Re=0,rt=[];++z<pe;){var Kt=D[z];k(Kt,z,D)&&(rt[Re++]=Kt)}return rt}function Qs(D,k){var z=D==null?0:D.length;return!!z&&wn(D,k,0)>-1}function Na(D,k,z){for(var pe=-1,Re=D==null?0:D.length;++pe<Re;)if(z(k,D[pe]))return!0;return!1}function _t(D,k){for(var z=-1,pe=D==null?0:D.length,Re=Array(pe);++z<pe;)Re[z]=k(D[z],z,D);return Re}function Ai(D,k){for(var z=-1,pe=k.length,Re=D.length;++z<pe;)D[Re+z]=k[z];return D}function Ra(D,k,z,pe){var Re=-1,rt=D==null?0:D.length;for(pe&&rt&&(z=D[++Re]);++Re<rt;)z=k(z,D[Re],Re,D);return z}function Pp(D,k,z,pe){var Re=D==null?0:D.length;for(pe&&Re&&(z=D[--Re]);Re--;)z=k(z,D[Re],Re,D);return z}function Ta(D,k){for(var z=-1,pe=D==null?0:D.length;++z<pe;)if(k(D[z],z,D))return!0;return!1}var Op=Ca("length");function Ap(D){return D.split("")}function Np(D){return D.match(jt)||[]}function Hu(D,k,z){var pe;return z(D,function(Re,rt,Kt){if(k(Re,rt,Kt))return pe=rt,!1}),pe}function Xs(D,k,z,pe){for(var Re=D.length,rt=z+(pe?1:-1);pe?rt--:++rt<Re;)if(k(D[rt],rt,D))return rt;return-1}function wn(D,k,z){return k===k?Hp(D,k,z):Xs(D,zu,z)}function Rp(D,k,z,pe){for(var Re=z-1,rt=D.length;++Re<rt;)if(pe(D[Re],k))return Re;return-1}function zu(D){return D!==D}function Ku(D,k){var z=D==null?0:D.length;return z?$a(D,k)/z:Y}function Ca(D){return function(k){return k==null?r:k[D]}}function La(D){return function(k){return D==null?r:D[k]}}function Bu(D,k,z,pe,Re){return Re(D,function(rt,Kt,ht){z=pe?(pe=!1,rt):k(z,rt,Kt,ht)}),z}function Tp(D,k){var z=D.length;for(D.sort(k);z--;)D[z]=D[z].value;return D}function $a(D,k){for(var z,pe=-1,Re=D.length;++pe<Re;){var rt=k(D[pe]);rt!==r&&(z=z===r?rt:z+rt)}return z}function Fa(D,k){for(var z=-1,pe=Array(D);++z<D;)pe[z]=k(z);return pe}function Cp(D,k){return _t(k,function(z){return[z,D[z]]})}function ku(D){return D&&D.slice(0,Yu(D)+1).replace(Ot,"")}function Ir(D){return function(k){return D(k)}}function Da(D,k){return _t(k,function(z){return D[z]})}function Jn(D,k){return D.has(k)}function Vu(D,k){for(var z=-1,pe=D.length;++z<pe&&wn(k,D[z],0)>-1;);return z}function Gu(D,k){for(var z=D.length;z--&&wn(k,D[z],0)>-1;);return z}function Lp(D,k){for(var z=D.length,pe=0;z--;)D[z]===k&&++pe;return pe}var $p=La(E),Fp=La(F);function Dp(D){return"\\"+de[D]}function Up(D,k){return D==null?r:D[k]}function bn(D){return Ys.test(D)}function Mp(D){return ki.test(D)}function jp(D){for(var k,z=[];!(k=D.next()).done;)z.push(k.value);return z}function Ua(D){var k=-1,z=Array(D.size);return D.forEach(function(pe,Re){z[++k]=[Re,pe]}),z}function Wu(D,k){return function(z){return D(k(z))}}function Ni(D,k){for(var z=-1,pe=D.length,Re=0,rt=[];++z<pe;){var Kt=D[z];(Kt===k||Kt===_)&&(D[z]=_,rt[Re++]=z)}return rt}function Zs(D){var k=-1,z=Array(D.size);return D.forEach(function(pe){z[++k]=pe}),z}function qp(D){var k=-1,z=Array(D.size);return D.forEach(function(pe){z[++k]=[pe,pe]}),z}function Hp(D,k,z){for(var pe=z-1,Re=D.length;++pe<Re;)if(D[pe]===k)return pe;return-1}function zp(D,k,z){for(var pe=z+1;pe--;)if(D[pe]===k)return pe;return pe}function En(D){return bn(D)?Bp(D):Op(D)}function zr(D){return bn(D)?kp(D):Ap(D)}function Yu(D){for(var k=D.length;k--&&Rt.test(D.charAt(k)););return k}var Kp=La(X);function Bp(D){for(var k=_n.lastIndex=0;_n.test(D);)++k;return k}function kp(D){return D.match(_n)||[]}function Vp(D){return D.match(Ws)||[]}var Gp=function D(k){k=k==null?Qe:In.defaults(Qe.Object(),k,In.pick(Qe,Js));var z=k.Array,pe=k.Date,Re=k.Error,rt=k.Function,Kt=k.Math,ht=k.Object,Ma=k.RegExp,Wp=k.String,Lr=k.TypeError,eo=z.prototype,Yp=rt.prototype,Sn=ht.prototype,to=k["__core-js_shared__"],ro=Yp.toString,nt=Sn.hasOwnProperty,Jp=0,Ju=function(){var t=/[^.]+$/.exec(to&&to.keys&&to.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),io=Sn.toString,Qp=ro.call(ht),Xp=Qe._,Zp=Ma("^"+ro.call(nt).replace(Pt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),no=dr?k.Buffer:r,Ri=k.Symbol,so=k.Uint8Array,Qu=no?no.allocUnsafe:r,oo=Wu(ht.getPrototypeOf,ht),Xu=ht.create,Zu=Sn.propertyIsEnumerable,ao=eo.splice,eh=Ri?Ri.isConcatSpreadable:r,Qn=Ri?Ri.iterator:r,Gi=Ri?Ri.toStringTag:r,co=function(){try{var t=Xi(ht,"defineProperty");return t({},"",{}),t}catch{}}(),eg=k.clearTimeout!==Qe.clearTimeout&&k.clearTimeout,tg=pe&&pe.now!==Qe.Date.now&&pe.now,rg=k.setTimeout!==Qe.setTimeout&&k.setTimeout,uo=Kt.ceil,ho=Kt.floor,ja=ht.getOwnPropertySymbols,ig=no?no.isBuffer:r,th=k.isFinite,ng=eo.join,sg=Wu(ht.keys,ht),Bt=Kt.max,Qt=Kt.min,og=pe.now,ag=k.parseInt,rh=Kt.random,cg=eo.reverse,qa=Xi(k,"DataView"),Xn=Xi(k,"Map"),Ha=Xi(k,"Promise"),xn=Xi(k,"Set"),Zn=Xi(k,"WeakMap"),es=Xi(ht,"create"),lo=Zn&&new Zn,Pn={},ug=Zi(qa),hg=Zi(Xn),lg=Zi(Ha),fg=Zi(xn),dg=Zi(Zn),fo=Ri?Ri.prototype:r,ts=fo?fo.valueOf:r,ih=fo?fo.toString:r;function y(t){if(Nt(t)&&!Ce(t)&&!(t instanceof Ye)){if(t instanceof $r)return t;if(nt.call(t,"__wrapped__"))return nl(t)}return new $r(t)}var On=function(){function t(){}return function(i){if(!Et(i))return{};if(Xu)return Xu(i);t.prototype=i;var o=new t;return t.prototype=r,o}}();function po(){}function $r(t,i){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!i,this.__index__=0,this.__values__=r}y.templateSettings={escape:St,evaluate:xt,interpolate:bt,variable:"",imports:{_:y}},y.prototype=po.prototype,y.prototype.constructor=y,$r.prototype=On(po.prototype),$r.prototype.constructor=$r;function Ye(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=re,this.__views__=[]}function pg(){var t=new Ye(this.__wrapped__);return t.__actions__=pr(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=pr(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=pr(this.__views__),t}function gg(){if(this.__filtered__){var t=new Ye(this);t.__dir__=-1,t.__filtered__=!0}else t=this.clone(),t.__dir__*=-1;return t}function vg(){var t=this.__wrapped__.value(),i=this.__dir__,o=Ce(t),c=i<0,d=o?t.length:0,m=A0(0,d,this.__views__),S=m.start,N=m.end,U=N-S,J=c?N:S-1,Q=this.__iteratees__,Z=Q.length,ce=0,ve=Qt(U,this.__takeCount__);if(!o||!c&&d==U&&ve==U)return Oh(t,this.__actions__);var be=[];e:for(;U--&&ce<ve;){J+=i;for(var He=-1,Ee=t[J];++He<Z;){var Ge=Q[He],Xe=Ge.iteratee,Pr=Ge.type,or=Xe(Ee);if(Pr==H)Ee=or;else if(!or){if(Pr==$)continue e;break e}}be[ce++]=Ee}return be}Ye.prototype=On(po.prototype),Ye.prototype.constructor=Ye;function Wi(t){var i=-1,o=t==null?0:t.length;for(this.clear();++i<o;){var c=t[i];this.set(c[0],c[1])}}function yg(){this.__data__=es?es(null):{},this.size=0}function mg(t){var i=this.has(t)&&delete this.__data__[t];return this.size-=i?1:0,i}function _g(t){var i=this.__data__;if(es){var o=i[t];return o===v?r:o}return nt.call(i,t)?i[t]:r}function wg(t){var i=this.__data__;return es?i[t]!==r:nt.call(i,t)}function bg(t,i){var o=this.__data__;return this.size+=this.has(t)?0:1,o[t]=es&&i===r?v:i,this}Wi.prototype.clear=yg,Wi.prototype.delete=mg,Wi.prototype.get=_g,Wi.prototype.has=wg,Wi.prototype.set=bg;function ui(t){var i=-1,o=t==null?0:t.length;for(this.clear();++i<o;){var c=t[i];this.set(c[0],c[1])}}function Eg(){this.__data__=[],this.size=0}function Ig(t){var i=this.__data__,o=go(i,t);if(o<0)return!1;var c=i.length-1;return o==c?i.pop():ao.call(i,o,1),--this.size,!0}function Sg(t){var i=this.__data__,o=go(i,t);return o<0?r:i[o][1]}function xg(t){return go(this.__data__,t)>-1}function Pg(t,i){var o=this.__data__,c=go(o,t);return c<0?(++this.size,o.push([t,i])):o[c][1]=i,this}ui.prototype.clear=Eg,ui.prototype.delete=Ig,ui.prototype.get=Sg,ui.prototype.has=xg,ui.prototype.set=Pg;function hi(t){var i=-1,o=t==null?0:t.length;for(this.clear();++i<o;){var c=t[i];this.set(c[0],c[1])}}function Og(){this.size=0,this.__data__={hash:new Wi,map:new(Xn||ui),string:new Wi}}function Ag(t){var i=Oo(this,t).delete(t);return this.size-=i?1:0,i}function Ng(t){return Oo(this,t).get(t)}function Rg(t){return Oo(this,t).has(t)}function Tg(t,i){var o=Oo(this,t),c=o.size;return o.set(t,i),this.size+=o.size==c?0:1,this}hi.prototype.clear=Og,hi.prototype.delete=Ag,hi.prototype.get=Ng,hi.prototype.has=Rg,hi.prototype.set=Tg;function Yi(t){var i=-1,o=t==null?0:t.length;for(this.__data__=new hi;++i<o;)this.add(t[i])}function Cg(t){return this.__data__.set(t,v),this}function Lg(t){return this.__data__.has(t)}Yi.prototype.add=Yi.prototype.push=Cg,Yi.prototype.has=Lg;function Kr(t){var i=this.__data__=new ui(t);this.size=i.size}function $g(){this.__data__=new ui,this.size=0}function Fg(t){var i=this.__data__,o=i.delete(t);return this.size=i.size,o}function Dg(t){return this.__data__.get(t)}function Ug(t){return this.__data__.has(t)}function Mg(t,i){var o=this.__data__;if(o instanceof ui){var c=o.__data__;if(!Xn||c.length<a-1)return c.push([t,i]),this.size=++o.size,this;o=this.__data__=new hi(c)}return o.set(t,i),this.size=o.size,this}Kr.prototype.clear=$g,Kr.prototype.delete=Fg,Kr.prototype.get=Dg,Kr.prototype.has=Ug,Kr.prototype.set=Mg;function nh(t,i){var o=Ce(t),c=!o&&en(t),d=!o&&!c&&Fi(t),m=!o&&!c&&!d&&Tn(t),S=o||c||d||m,N=S?Fa(t.length,Wp):[],U=N.length;for(var J in t)(i||nt.call(t,J))&&!(S&&(J=="length"||d&&(J=="offset"||J=="parent")||m&&(J=="buffer"||J=="byteLength"||J=="byteOffset")||pi(J,U)))&&N.push(J);return N}function sh(t){var i=t.length;return i?t[Xa(0,i-1)]:r}function jg(t,i){return Ao(pr(t),Ji(i,0,t.length))}function qg(t){return Ao(pr(t))}function za(t,i,o){(o!==r&&!Br(t[i],o)||o===r&&!(i in t))&&li(t,i,o)}function rs(t,i,o){var c=t[i];(!(nt.call(t,i)&&Br(c,o))||o===r&&!(i in t))&&li(t,i,o)}function go(t,i){for(var o=t.length;o--;)if(Br(t[o][0],i))return o;return-1}function Hg(t,i,o,c){return Ti(t,function(d,m,S){i(c,d,o(d),S)}),c}function oh(t,i){return t&&Zr(i,Vt(i),t)}function zg(t,i){return t&&Zr(i,vr(i),t)}function li(t,i,o){i=="__proto__"&&co?co(t,i,{configurable:!0,enumerable:!0,value:o,writable:!0}):t[i]=o}function Ka(t,i){for(var o=-1,c=i.length,d=z(c),m=t==null;++o<c;)d[o]=m?r:Ic(t,i[o]);return d}function Ji(t,i,o){return t===t&&(o!==r&&(t=t<=o?t:o),i!==r&&(t=t>=i?t:i)),t}function Fr(t,i,o,c,d,m){var S,N=i&I,U=i&P,J=i&A;if(o&&(S=d?o(t,c,d,m):o(t)),S!==r)return S;if(!Et(t))return t;var Q=Ce(t);if(Q){if(S=R0(t),!N)return pr(t,S)}else{var Z=Xt(t),ce=Z==se||Z==fe;if(Fi(t))return Rh(t,N);if(Z==Ue||Z==he||ce&&!d){if(S=U||ce?{}:Yh(t),!N)return U?_0(t,zg(S,t)):m0(t,oh(S,t))}else{if(!ot[Z])return d?t:{};S=T0(t,Z,N)}}m||(m=new Kr);var ve=m.get(t);if(ve)return ve;m.set(t,S),Sl(t)?t.forEach(function(Ee){S.add(Fr(Ee,i,o,Ee,t,m))}):El(t)&&t.forEach(function(Ee,Ge){S.set(Ge,Fr(Ee,i,o,Ge,t,m))});var be=J?U?uc:cc:U?vr:Vt,He=Q?r:be(t);return Cr(He||t,function(Ee,Ge){He&&(Ge=Ee,Ee=t[Ge]),rs(S,Ge,Fr(Ee,i,o,Ge,t,m))}),S}function Kg(t){var i=Vt(t);return function(o){return ah(o,t,i)}}function ah(t,i,o){var c=o.length;if(t==null)return!c;for(t=ht(t);c--;){var d=o[c],m=i[d],S=t[d];if(S===r&&!(d in t)||!m(S))return!1}return!0}function ch(t,i,o){if(typeof t!="function")throw new Lr(p);return us(function(){t.apply(r,o)},i)}function is(t,i,o,c){var d=-1,m=Qs,S=!0,N=t.length,U=[],J=i.length;if(!N)return U;o&&(i=_t(i,Ir(o))),c?(m=Na,S=!1):i.length>=a&&(m=Jn,S=!1,i=new Yi(i));e:for(;++d<N;){var Q=t[d],Z=o==null?Q:o(Q);if(Q=c||Q!==0?Q:0,S&&Z===Z){for(var ce=J;ce--;)if(i[ce]===Z)continue e;U.push(Q)}else m(i,Z,c)||U.push(Q)}return U}var Ti=Fh(Xr),uh=Fh(ka,!0);function Bg(t,i){var o=!0;return Ti(t,function(c,d,m){return o=!!i(c,d,m),o}),o}function vo(t,i,o){for(var c=-1,d=t.length;++c<d;){var m=t[c],S=i(m);if(S!=null&&(N===r?S===S&&!xr(S):o(S,N)))var N=S,U=m}return U}function kg(t,i,o,c){var d=t.length;for(o=Me(o),o<0&&(o=-o>d?0:d+o),c=c===r||c>d?d:Me(c),c<0&&(c+=d),c=o>c?0:Pl(c);o<c;)t[o++]=i;return t}function hh(t,i){var o=[];return Ti(t,function(c,d,m){i(c,d,m)&&o.push(c)}),o}function Yt(t,i,o,c,d){var m=-1,S=t.length;for(o||(o=L0),d||(d=[]);++m<S;){var N=t[m];i>0&&o(N)?i>1?Yt(N,i-1,o,c,d):Ai(d,N):c||(d[d.length]=N)}return d}var Ba=Dh(),lh=Dh(!0);function Xr(t,i){return t&&Ba(t,i,Vt)}function ka(t,i){return t&&lh(t,i,Vt)}function yo(t,i){return Oi(i,function(o){return gi(t[o])})}function Qi(t,i){i=Li(i,t);for(var o=0,c=i.length;t!=null&&o<c;)t=t[ei(i[o++])];return o&&o==c?t:r}function fh(t,i,o){var c=i(t);return Ce(t)?c:Ai(c,o(t))}function nr(t){return t==null?t===r?qe:ke:Gi&&Gi in ht(t)?O0(t):q0(t)}function Va(t,i){return t>i}function Vg(t,i){return t!=null&&nt.call(t,i)}function Gg(t,i){return t!=null&&i in ht(t)}function Wg(t,i,o){return t>=Qt(i,o)&&t<Bt(i,o)}function Ga(t,i,o){for(var c=o?Na:Qs,d=t[0].length,m=t.length,S=m,N=z(m),U=1/0,J=[];S--;){var Q=t[S];S&&i&&(Q=_t(Q,Ir(i))),U=Qt(Q.length,U),N[S]=!o&&(i||d>=120&&Q.length>=120)?new Yi(S&&Q):r}Q=t[0];var Z=-1,ce=N[0];e:for(;++Z<d&&J.length<U;){var ve=Q[Z],be=i?i(ve):ve;if(ve=o||ve!==0?ve:0,!(ce?Jn(ce,be):c(J,be,o))){for(S=m;--S;){var He=N[S];if(!(He?Jn(He,be):c(t[S],be,o)))continue e}ce&&ce.push(be),J.push(ve)}}return J}function Yg(t,i,o,c){return Xr(t,function(d,m,S){i(c,o(d),m,S)}),c}function ns(t,i,o){i=Li(i,t),t=Zh(t,i);var c=t==null?t:t[ei(Ur(i))];return c==null?r:kt(c,t,o)}function dh(t){return Nt(t)&&nr(t)==he}function Jg(t){return Nt(t)&&nr(t)==Ie}function Qg(t){return Nt(t)&&nr(t)==C}function ss(t,i,o,c,d){return t===i?!0:t==null||i==null||!Nt(t)&&!Nt(i)?t!==t&&i!==i:Xg(t,i,o,c,ss,d)}function Xg(t,i,o,c,d,m){var S=Ce(t),N=Ce(i),U=S?me:Xt(t),J=N?me:Xt(i);U=U==he?Ue:U,J=J==he?Ue:J;var Q=U==Ue,Z=J==Ue,ce=U==J;if(ce&&Fi(t)){if(!Fi(i))return!1;S=!0,Q=!1}if(ce&&!Q)return m||(m=new Kr),S||Tn(t)?Vh(t,i,o,c,d,m):x0(t,i,U,o,c,d,m);if(!(o&L)){var ve=Q&&nt.call(t,"__wrapped__"),be=Z&&nt.call(i,"__wrapped__");if(ve||be){var He=ve?t.value():t,Ee=be?i.value():i;return m||(m=new Kr),d(He,Ee,o,c,m)}}return ce?(m||(m=new Kr),P0(t,i,o,c,d,m)):!1}function Zg(t){return Nt(t)&&Xt(t)==Se}function Wa(t,i,o,c){var d=o.length,m=d,S=!c;if(t==null)return!m;for(t=ht(t);d--;){var N=o[d];if(S&&N[2]?N[1]!==t[N[0]]:!(N[0]in t))return!1}for(;++d<m;){N=o[d];var U=N[0],J=t[U],Q=N[1];if(S&&N[2]){if(J===r&&!(U in t))return!1}else{var Z=new Kr;if(c)var ce=c(J,Q,U,t,i,Z);if(!(ce===r?ss(Q,J,L|K,c,Z):ce))return!1}}return!0}function ph(t){if(!Et(t)||F0(t))return!1;var i=gi(t)?Zp:da;return i.test(Zi(t))}function e0(t){return Nt(t)&&nr(t)==je}function t0(t){return Nt(t)&&Xt(t)==xe}function r0(t){return Nt(t)&&$o(t.length)&&!!at[nr(t)]}function gh(t){return typeof t=="function"?t:t==null?yr:typeof t=="object"?Ce(t)?mh(t[0],t[1]):yh(t):Ul(t)}function Ya(t){if(!cs(t))return sg(t);var i=[];for(var o in ht(t))nt.call(t,o)&&o!="constructor"&&i.push(o);return i}function i0(t){if(!Et(t))return j0(t);var i=cs(t),o=[];for(var c in t)c=="constructor"&&(i||!nt.call(t,c))||o.push(c);return o}function Ja(t,i){return t<i}function vh(t,i){var o=-1,c=gr(t)?z(t.length):[];return Ti(t,function(d,m,S){c[++o]=i(d,m,S)}),c}function yh(t){var i=lc(t);return i.length==1&&i[0][2]?Qh(i[0][0],i[0][1]):function(o){return o===t||Wa(o,t,i)}}function mh(t,i){return dc(t)&&Jh(i)?Qh(ei(t),i):function(o){var c=Ic(o,t);return c===r&&c===i?Sc(o,t):ss(i,c,L|K)}}function mo(t,i,o,c,d){t!==i&&Ba(i,function(m,S){if(d||(d=new Kr),Et(m))n0(t,i,S,o,mo,c,d);else{var N=c?c(gc(t,S),m,S+"",t,i,d):r;N===r&&(N=m),za(t,S,N)}},vr)}function n0(t,i,o,c,d,m,S){var N=gc(t,o),U=gc(i,o),J=S.get(U);if(J){za(t,o,J);return}var Q=m?m(N,U,o+"",t,i,S):r,Z=Q===r;if(Z){var ce=Ce(U),ve=!ce&&Fi(U),be=!ce&&!ve&&Tn(U);Q=U,ce||ve||be?Ce(N)?Q=N:Ct(N)?Q=pr(N):ve?(Z=!1,Q=Rh(U,!0)):be?(Z=!1,Q=Th(U,!0)):Q=[]:hs(U)||en(U)?(Q=N,en(N)?Q=Ol(N):(!Et(N)||gi(N))&&(Q=Yh(U))):Z=!1}Z&&(S.set(U,Q),d(Q,U,c,m,S),S.delete(U)),za(t,o,Q)}function _h(t,i){var o=t.length;if(o)return i+=i<0?o:0,pi(i,o)?t[i]:r}function wh(t,i,o){i.length?i=_t(i,function(m){return Ce(m)?function(S){return Qi(S,m.length===1?m[0]:m)}:m}):i=[yr];var c=-1;i=_t(i,Ir(_e()));var d=vh(t,function(m,S,N){var U=_t(i,function(J){return J(m)});return{criteria:U,index:++c,value:m}});return Tp(d,function(m,S){return y0(m,S,o)})}function s0(t,i){return bh(t,i,function(o,c){return Sc(t,c)})}function bh(t,i,o){for(var c=-1,d=i.length,m={};++c<d;){var S=i[c],N=Qi(t,S);o(N,S)&&os(m,Li(S,t),N)}return m}function o0(t){return function(i){return Qi(i,t)}}function Qa(t,i,o,c){var d=c?Rp:wn,m=-1,S=i.length,N=t;for(t===i&&(i=pr(i)),o&&(N=_t(t,Ir(o)));++m<S;)for(var U=0,J=i[m],Q=o?o(J):J;(U=d(N,Q,U,c))>-1;)N!==t&&ao.call(N,U,1),ao.call(t,U,1);return t}function Eh(t,i){for(var o=t?i.length:0,c=o-1;o--;){var d=i[o];if(o==c||d!==m){var m=d;pi(d)?ao.call(t,d,1):tc(t,d)}}return t}function Xa(t,i){return t+ho(rh()*(i-t+1))}function a0(t,i,o,c){for(var d=-1,m=Bt(uo((i-t)/(o||1)),0),S=z(m);m--;)S[c?m:++d]=t,t+=o;return S}function Za(t,i){var o="";if(!t||i<1||i>W)return o;do i%2&&(o+=t),i=ho(i/2),i&&(t+=t);while(i);return o}function Be(t,i){return vc(Xh(t,i,yr),t+"")}function c0(t){return sh(Cn(t))}function u0(t,i){var o=Cn(t);return Ao(o,Ji(i,0,o.length))}function os(t,i,o,c){if(!Et(t))return t;i=Li(i,t);for(var d=-1,m=i.length,S=m-1,N=t;N!=null&&++d<m;){var U=ei(i[d]),J=o;if(U==="__proto__"||U==="constructor"||U==="prototype")return t;if(d!=S){var Q=N[U];J=c?c(Q,U,N):r,J===r&&(J=Et(Q)?Q:pi(i[d+1])?[]:{})}rs(N,U,J),N=N[U]}return t}var Ih=lo?function(t,i){return lo.set(t,i),t}:yr,h0=co?function(t,i){return co(t,"toString",{configurable:!0,enumerable:!1,value:Pc(i),writable:!0})}:yr;function l0(t){return Ao(Cn(t))}function Dr(t,i,o){var c=-1,d=t.length;i<0&&(i=-i>d?0:d+i),o=o>d?d:o,o<0&&(o+=d),d=i>o?0:o-i>>>0,i>>>=0;for(var m=z(d);++c<d;)m[c]=t[c+i];return m}function f0(t,i){var o;return Ti(t,function(c,d,m){return o=i(c,d,m),!o}),!!o}function _o(t,i,o){var c=0,d=t==null?c:t.length;if(typeof i=="number"&&i===i&&d<=ie){for(;c<d;){var m=c+d>>>1,S=t[m];S!==null&&!xr(S)&&(o?S<=i:S<i)?c=m+1:d=m}return d}return ec(t,i,yr,o)}function ec(t,i,o,c){var d=0,m=t==null?0:t.length;if(m===0)return 0;i=o(i);for(var S=i!==i,N=i===null,U=xr(i),J=i===r;d<m;){var Q=ho((d+m)/2),Z=o(t[Q]),ce=Z!==r,ve=Z===null,be=Z===Z,He=xr(Z);if(S)var Ee=c||be;else J?Ee=be&&(c||ce):N?Ee=be&&ce&&(c||!ve):U?Ee=be&&ce&&!ve&&(c||!He):ve||He?Ee=!1:Ee=c?Z<=i:Z<i;Ee?d=Q+1:m=Q}return Qt(m,Pe)}function Sh(t,i){for(var o=-1,c=t.length,d=0,m=[];++o<c;){var S=t[o],N=i?i(S):S;if(!o||!Br(N,U)){var U=N;m[d++]=S===0?0:S}}return m}function xh(t){return typeof t=="number"?t:xr(t)?Y:+t}function Sr(t){if(typeof t=="string")return t;if(Ce(t))return _t(t,Sr)+"";if(xr(t))return ih?ih.call(t):"";var i=t+"";return i=="0"&&1/t==-te?"-0":i}function Ci(t,i,o){var c=-1,d=Qs,m=t.length,S=!0,N=[],U=N;if(o)S=!1,d=Na;else if(m>=a){var J=i?null:I0(t);if(J)return Zs(J);S=!1,d=Jn,U=new Yi}else U=i?[]:N;e:for(;++c<m;){var Q=t[c],Z=i?i(Q):Q;if(Q=o||Q!==0?Q:0,S&&Z===Z){for(var ce=U.length;ce--;)if(U[ce]===Z)continue e;i&&U.push(Z),N.push(Q)}else d(U,Z,o)||(U!==N&&U.push(Z),N.push(Q))}return N}function tc(t,i){return i=Li(i,t),t=Zh(t,i),t==null||delete t[ei(Ur(i))]}function Ph(t,i,o,c){return os(t,i,o(Qi(t,i)),c)}function wo(t,i,o,c){for(var d=t.length,m=c?d:-1;(c?m--:++m<d)&&i(t[m],m,t););return o?Dr(t,c?0:m,c?m+1:d):Dr(t,c?m+1:0,c?d:m)}function Oh(t,i){var o=t;return o instanceof Ye&&(o=o.value()),Ra(i,function(c,d){return d.func.apply(d.thisArg,Ai([c],d.args))},o)}function rc(t,i,o){var c=t.length;if(c<2)return c?Ci(t[0]):[];for(var d=-1,m=z(c);++d<c;)for(var S=t[d],N=-1;++N<c;)N!=d&&(m[d]=is(m[d]||S,t[N],i,o));return Ci(Yt(m,1),i,o)}function Ah(t,i,o){for(var c=-1,d=t.length,m=i.length,S={};++c<d;){var N=c<m?i[c]:r;o(S,t[c],N)}return S}function ic(t){return Ct(t)?t:[]}function nc(t){return typeof t=="function"?t:yr}function Li(t,i){return Ce(t)?t:dc(t,i)?[t]:il(it(t))}var d0=Be;function $i(t,i,o){var c=t.length;return o=o===r?c:o,!i&&o>=c?t:Dr(t,i,o)}var Nh=eg||function(t){return Qe.clearTimeout(t)};function Rh(t,i){if(i)return t.slice();var o=t.length,c=Qu?Qu(o):new t.constructor(o);return t.copy(c),c}function sc(t){var i=new t.constructor(t.byteLength);return new so(i).set(new so(t)),i}function p0(t,i){var o=i?sc(t.buffer):t.buffer;return new t.constructor(o,t.byteOffset,t.byteLength)}function g0(t){var i=new t.constructor(t.source,Rr.exec(t));return i.lastIndex=t.lastIndex,i}function v0(t){return ts?ht(ts.call(t)):{}}function Th(t,i){var o=i?sc(t.buffer):t.buffer;return new t.constructor(o,t.byteOffset,t.length)}function Ch(t,i){if(t!==i){var o=t!==r,c=t===null,d=t===t,m=xr(t),S=i!==r,N=i===null,U=i===i,J=xr(i);if(!N&&!J&&!m&&t>i||m&&S&&U&&!N&&!J||c&&S&&U||!o&&U||!d)return 1;if(!c&&!m&&!J&&t<i||J&&o&&d&&!c&&!m||N&&o&&d||!S&&d||!U)return-1}return 0}function y0(t,i,o){for(var c=-1,d=t.criteria,m=i.criteria,S=d.length,N=o.length;++c<S;){var U=Ch(d[c],m[c]);if(U){if(c>=N)return U;var J=o[c];return U*(J=="desc"?-1:1)}}return t.index-i.index}function Lh(t,i,o,c){for(var d=-1,m=t.length,S=o.length,N=-1,U=i.length,J=Bt(m-S,0),Q=z(U+J),Z=!c;++N<U;)Q[N]=i[N];for(;++d<S;)(Z||d<m)&&(Q[o[d]]=t[d]);for(;J--;)Q[N++]=t[d++];return Q}function $h(t,i,o,c){for(var d=-1,m=t.length,S=-1,N=o.length,U=-1,J=i.length,Q=Bt(m-N,0),Z=z(Q+J),ce=!c;++d<Q;)Z[d]=t[d];for(var ve=d;++U<J;)Z[ve+U]=i[U];for(;++S<N;)(ce||d<m)&&(Z[ve+o[S]]=t[d++]);return Z}function pr(t,i){var o=-1,c=t.length;for(i||(i=z(c));++o<c;)i[o]=t[o];return i}function Zr(t,i,o,c){var d=!o;o||(o={});for(var m=-1,S=i.length;++m<S;){var N=i[m],U=c?c(o[N],t[N],N,o,t):r;U===r&&(U=t[N]),d?li(o,N,U):rs(o,N,U)}return o}function m0(t,i){return Zr(t,fc(t),i)}function _0(t,i){return Zr(t,Gh(t),i)}function bo(t,i){return function(o,c){var d=Ce(o)?Sp:Hg,m=i?i():{};return d(o,t,_e(c,2),m)}}function An(t){return Be(function(i,o){var c=-1,d=o.length,m=d>1?o[d-1]:r,S=d>2?o[2]:r;for(m=t.length>3&&typeof m=="function"?(d--,m):r,S&&sr(o[0],o[1],S)&&(m=d<3?r:m,d=1),i=ht(i);++c<d;){var N=o[c];N&&t(i,N,c,m)}return i})}function Fh(t,i){return function(o,c){if(o==null)return o;if(!gr(o))return t(o,c);for(var d=o.length,m=i?d:-1,S=ht(o);(i?m--:++m<d)&&c(S[m],m,S)!==!1;);return o}}function Dh(t){return function(i,o,c){for(var d=-1,m=ht(i),S=c(i),N=S.length;N--;){var U=S[t?N:++d];if(o(m[U],U,m)===!1)break}return i}}function w0(t,i,o){var c=i&B,d=as(t);function m(){var S=this&&this!==Qe&&this instanceof m?d:t;return S.apply(c?o:this,arguments)}return m}function Uh(t){return function(i){i=it(i);var o=bn(i)?zr(i):r,c=o?o[0]:i.charAt(0),d=o?$i(o,1).join(""):i.slice(1);return c[t]()+d}}function Nn(t){return function(i){return Ra(Fl($l(i).replace(Wn,"")),t,"")}}function as(t){return function(){var i=arguments;switch(i.length){case 0:return new t;case 1:return new t(i[0]);case 2:return new t(i[0],i[1]);case 3:return new t(i[0],i[1],i[2]);case 4:return new t(i[0],i[1],i[2],i[3]);case 5:return new t(i[0],i[1],i[2],i[3],i[4]);case 6:return new t(i[0],i[1],i[2],i[3],i[4],i[5]);case 7:return new t(i[0],i[1],i[2],i[3],i[4],i[5],i[6])}var o=On(t.prototype),c=t.apply(o,i);return Et(c)?c:o}}function b0(t,i,o){var c=as(t);function d(){for(var m=arguments.length,S=z(m),N=m,U=Rn(d);N--;)S[N]=arguments[N];var J=m<3&&S[0]!==U&&S[m-1]!==U?[]:Ni(S,U);if(m-=J.length,m<o)return zh(t,i,Eo,d.placeholder,r,S,J,r,r,o-m);var Q=this&&this!==Qe&&this instanceof d?c:t;return kt(Q,this,S)}return d}function Mh(t){return function(i,o,c){var d=ht(i);if(!gr(i)){var m=_e(o,3);i=Vt(i),o=function(N){return m(d[N],N,d)}}var S=t(i,o,c);return S>-1?d[m?i[S]:S]:r}}function jh(t){return di(function(i){var o=i.length,c=o,d=$r.prototype.thru;for(t&&i.reverse();c--;){var m=i[c];if(typeof m!="function")throw new Lr(p);if(d&&!S&&Po(m)=="wrapper")var S=new $r([],!0)}for(c=S?c:o;++c<o;){m=i[c];var N=Po(m),U=N=="wrapper"?hc(m):r;U&&pc(U[0])&&U[1]==(u|M|R|w)&&!U[4].length&&U[9]==1?S=S[Po(U[0])].apply(S,U[3]):S=m.length==1&&pc(m)?S[N]():S.thru(m)}return function(){var J=arguments,Q=J[0];if(S&&J.length==1&&Ce(Q))return S.plant(Q).value();for(var Z=0,ce=o?i[Z].apply(this,J):Q;++Z<o;)ce=i[Z].call(this,ce);return ce}})}function Eo(t,i,o,c,d,m,S,N,U,J){var Q=i&u,Z=i&B,ce=i&ne,ve=i&(M|x),be=i&G,He=ce?r:as(t);function Ee(){for(var Ge=arguments.length,Xe=z(Ge),Pr=Ge;Pr--;)Xe[Pr]=arguments[Pr];if(ve)var or=Rn(Ee),Or=Lp(Xe,or);if(c&&(Xe=Lh(Xe,c,d,ve)),m&&(Xe=$h(Xe,m,S,ve)),Ge-=Or,ve&&Ge<J){var Lt=Ni(Xe,or);return zh(t,i,Eo,Ee.placeholder,o,Xe,Lt,N,U,J-Ge)}var kr=Z?o:this,yi=ce?kr[t]:t;return Ge=Xe.length,N?Xe=H0(Xe,N):be&&Ge>1&&Xe.reverse(),Q&&U<Ge&&(Xe.length=U),this&&this!==Qe&&this instanceof Ee&&(yi=He||as(yi)),yi.apply(kr,Xe)}return Ee}function qh(t,i){return function(o,c){return Yg(o,t,i(c),{})}}function Io(t,i){return function(o,c){var d;if(o===r&&c===r)return i;if(o!==r&&(d=o),c!==r){if(d===r)return c;typeof o=="string"||typeof c=="string"?(o=Sr(o),c=Sr(c)):(o=xh(o),c=xh(c)),d=t(o,c)}return d}}function oc(t){return di(function(i){return i=_t(i,Ir(_e())),Be(function(o){var c=this;return t(i,function(d){return kt(d,c,o)})})})}function So(t,i){i=i===r?" ":Sr(i);var o=i.length;if(o<2)return o?Za(i,t):i;var c=Za(i,uo(t/En(i)));return bn(i)?$i(zr(c),0,t).join(""):c.slice(0,t)}function E0(t,i,o,c){var d=i&B,m=as(t);function S(){for(var N=-1,U=arguments.length,J=-1,Q=c.length,Z=z(Q+U),ce=this&&this!==Qe&&this instanceof S?m:t;++J<Q;)Z[J]=c[J];for(;U--;)Z[J++]=arguments[++N];return kt(ce,d?o:this,Z)}return S}function Hh(t){return function(i,o,c){return c&&typeof c!="number"&&sr(i,o,c)&&(o=c=r),i=vi(i),o===r?(o=i,i=0):o=vi(o),c=c===r?i<o?1:-1:vi(c),a0(i,o,c,t)}}function xo(t){return function(i,o){return typeof i=="string"&&typeof o=="string"||(i=Mr(i),o=Mr(o)),t(i,o)}}function zh(t,i,o,c,d,m,S,N,U,J){var Q=i&M,Z=Q?S:r,ce=Q?r:S,ve=Q?m:r,be=Q?r:m;i|=Q?R:b,i&=~(Q?b:R),i&T||(i&=~(B|ne));var He=[t,i,d,ve,Z,be,ce,N,U,J],Ee=o.apply(r,He);return pc(t)&&el(Ee,He),Ee.placeholder=c,tl(Ee,t,i)}function ac(t){var i=Kt[t];return function(o,c){if(o=Mr(o),c=c==null?0:Qt(Me(c),292),c&&th(o)){var d=(it(o)+"e").split("e"),m=i(d[0]+"e"+(+d[1]+c));return d=(it(m)+"e").split("e"),+(d[0]+"e"+(+d[1]-c))}return i(o)}}var I0=xn&&1/Zs(new xn([,-0]))[1]==te?function(t){return new xn(t)}:Nc;function Kh(t){return function(i){var o=Xt(i);return o==Se?Ua(i):o==xe?qp(i):Cp(i,t(i))}}function fi(t,i,o,c,d,m,S,N){var U=i&ne;if(!U&&typeof t!="function")throw new Lr(p);var J=c?c.length:0;if(J||(i&=~(R|b),c=d=r),S=S===r?S:Bt(Me(S),0),N=N===r?N:Me(N),J-=d?d.length:0,i&b){var Q=c,Z=d;c=d=r}var ce=U?r:hc(t),ve=[t,i,o,c,d,Q,Z,m,S,N];if(ce&&M0(ve,ce),t=ve[0],i=ve[1],o=ve[2],c=ve[3],d=ve[4],N=ve[9]=ve[9]===r?U?0:t.length:Bt(ve[9]-J,0),!N&&i&(M|x)&&(i&=~(M|x)),!i||i==B)var be=w0(t,i,o);else i==M||i==x?be=b0(t,i,N):(i==R||i==(B|R))&&!d.length?be=E0(t,i,o,c):be=Eo.apply(r,ve);var He=ce?Ih:el;return tl(He(be,ve),t,i)}function Bh(t,i,o,c){return t===r||Br(t,Sn[o])&&!nt.call(c,o)?i:t}function kh(t,i,o,c,d,m){return Et(t)&&Et(i)&&(m.set(i,t),mo(t,i,r,kh,m),m.delete(i)),t}function S0(t){return hs(t)?r:t}function Vh(t,i,o,c,d,m){var S=o&L,N=t.length,U=i.length;if(N!=U&&!(S&&U>N))return!1;var J=m.get(t),Q=m.get(i);if(J&&Q)return J==i&&Q==t;var Z=-1,ce=!0,ve=o&K?new Yi:r;for(m.set(t,i),m.set(i,t);++Z<N;){var be=t[Z],He=i[Z];if(c)var Ee=S?c(He,be,Z,i,t,m):c(be,He,Z,t,i,m);if(Ee!==r){if(Ee)continue;ce=!1;break}if(ve){if(!Ta(i,function(Ge,Xe){if(!Jn(ve,Xe)&&(be===Ge||d(be,Ge,o,c,m)))return ve.push(Xe)})){ce=!1;break}}else if(!(be===He||d(be,He,o,c,m))){ce=!1;break}}return m.delete(t),m.delete(i),ce}function x0(t,i,o,c,d,m,S){switch(o){case Ne:if(t.byteLength!=i.byteLength||t.byteOffset!=i.byteOffset)return!1;t=t.buffer,i=i.buffer;case Ie:return!(t.byteLength!=i.byteLength||!m(new so(t),new so(i)));case j:case C:case ze:return Br(+t,+i);case O:return t.name==i.name&&t.message==i.message;case je:case Le:return t==i+"";case Se:var N=Ua;case xe:var U=c&L;if(N||(N=Zs),t.size!=i.size&&!U)return!1;var J=S.get(t);if(J)return J==i;c|=K,S.set(t,i);var Q=Vh(N(t),N(i),c,d,m,S);return S.delete(t),Q;case $e:if(ts)return ts.call(t)==ts.call(i)}return!1}function P0(t,i,o,c,d,m){var S=o&L,N=cc(t),U=N.length,J=cc(i),Q=J.length;if(U!=Q&&!S)return!1;for(var Z=U;Z--;){var ce=N[Z];if(!(S?ce in i:nt.call(i,ce)))return!1}var ve=m.get(t),be=m.get(i);if(ve&&be)return ve==i&&be==t;var He=!0;m.set(t,i),m.set(i,t);for(var Ee=S;++Z<U;){ce=N[Z];var Ge=t[ce],Xe=i[ce];if(c)var Pr=S?c(Xe,Ge,ce,i,t,m):c(Ge,Xe,ce,t,i,m);if(!(Pr===r?Ge===Xe||d(Ge,Xe,o,c,m):Pr)){He=!1;break}Ee||(Ee=ce=="constructor")}if(He&&!Ee){var or=t.constructor,Or=i.constructor;or!=Or&&"constructor"in t&&"constructor"in i&&!(typeof or=="function"&&or instanceof or&&typeof Or=="function"&&Or instanceof Or)&&(He=!1)}return m.delete(t),m.delete(i),He}function di(t){return vc(Xh(t,r,al),t+"")}function cc(t){return fh(t,Vt,fc)}function uc(t){return fh(t,vr,Gh)}var hc=lo?function(t){return lo.get(t)}:Nc;function Po(t){for(var i=t.name+"",o=Pn[i],c=nt.call(Pn,i)?o.length:0;c--;){var d=o[c],m=d.func;if(m==null||m==t)return d.name}return i}function Rn(t){var i=nt.call(y,"placeholder")?y:t;return i.placeholder}function _e(){var t=y.iteratee||Oc;return t=t===Oc?gh:t,arguments.length?t(arguments[0],arguments[1]):t}function Oo(t,i){var o=t.__data__;return $0(i)?o[typeof i=="string"?"string":"hash"]:o.map}function lc(t){for(var i=Vt(t),o=i.length;o--;){var c=i[o],d=t[c];i[o]=[c,d,Jh(d)]}return i}function Xi(t,i){var o=Up(t,i);return ph(o)?o:r}function O0(t){var i=nt.call(t,Gi),o=t[Gi];try{t[Gi]=r;var c=!0}catch{}var d=io.call(t);return c&&(i?t[Gi]=o:delete t[Gi]),d}var fc=ja?function(t){return t==null?[]:(t=ht(t),Oi(ja(t),function(i){return Zu.call(t,i)}))}:Rc,Gh=ja?function(t){for(var i=[];t;)Ai(i,fc(t)),t=oo(t);return i}:Rc,Xt=nr;(qa&&Xt(new qa(new ArrayBuffer(1)))!=Ne||Xn&&Xt(new Xn)!=Se||Ha&&Xt(Ha.resolve())!=gt||xn&&Xt(new xn)!=xe||Zn&&Xt(new Zn)!=Ae)&&(Xt=function(t){var i=nr(t),o=i==Ue?t.constructor:r,c=o?Zi(o):"";if(c)switch(c){case ug:return Ne;case hg:return Se;case lg:return gt;case fg:return xe;case dg:return Ae}return i});function A0(t,i,o){for(var c=-1,d=o.length;++c<d;){var m=o[c],S=m.size;switch(m.type){case"drop":t+=S;break;case"dropRight":i-=S;break;case"take":i=Qt(i,t+S);break;case"takeRight":t=Bt(t,i-S);break}}return{start:t,end:i}}function N0(t){var i=t.match(lt);return i?i[1].split(Mt):[]}function Wh(t,i,o){i=Li(i,t);for(var c=-1,d=i.length,m=!1;++c<d;){var S=ei(i[c]);if(!(m=t!=null&&o(t,S)))break;t=t[S]}return m||++c!=d?m:(d=t==null?0:t.length,!!d&&$o(d)&&pi(S,d)&&(Ce(t)||en(t)))}function R0(t){var i=t.length,o=new t.constructor(i);return i&&typeof t[0]=="string"&&nt.call(t,"index")&&(o.index=t.index,o.input=t.input),o}function Yh(t){return typeof t.constructor=="function"&&!cs(t)?On(oo(t)):{}}function T0(t,i,o){var c=t.constructor;switch(i){case Ie:return sc(t);case j:case C:return new c(+t);case Ne:return p0(t,o);case Ke:case Oe:case Ve:case We:case et:case tt:case Je:case tr:case fr:return Th(t,o);case Se:return new c;case ze:case Le:return new c(t);case je:return g0(t);case xe:return new c;case $e:return v0(t)}}function C0(t,i){var o=i.length;if(!o)return t;var c=o-1;return i[c]=(o>1?"& ":"")+i[c],i=i.join(o>2?", ":" "),t.replace(At,`{
/* [wrapped with `+i+`] */
`)}function L0(t){return Ce(t)||en(t)||!!(eh&&t&&t[eh])}function pi(t,i){var o=typeof t;return i=i!=null?i:W,!!i&&(o=="number"||o!="symbol"&&ga.test(t))&&t>-1&&t%1==0&&t<i}function sr(t,i,o){if(!Et(o))return!1;var c=typeof i;return(c=="number"?gr(o)&&pi(i,o.length):c=="string"&&i in o)?Br(o[i],t):!1}function dc(t,i){if(Ce(t))return!1;var o=typeof t;return o=="number"||o=="symbol"||o=="boolean"||t==null||xr(t)?!0:Ft.test(t)||!mt.test(t)||i!=null&&t in ht(i)}function $0(t){var i=typeof t;return i=="string"||i=="number"||i=="symbol"||i=="boolean"?t!=="__proto__":t===null}function pc(t){var i=Po(t),o=y[i];if(typeof o!="function"||!(i in Ye.prototype))return!1;if(t===o)return!0;var c=hc(o);return!!c&&t===c[0]}function F0(t){return!!Ju&&Ju in t}var D0=to?gi:Tc;function cs(t){var i=t&&t.constructor,o=typeof i=="function"&&i.prototype||Sn;return t===o}function Jh(t){return t===t&&!Et(t)}function Qh(t,i){return function(o){return o==null?!1:o[t]===i&&(i!==r||t in ht(o))}}function U0(t){var i=Co(t,function(c){return o.size===g&&o.clear(),c}),o=i.cache;return i}function M0(t,i){var o=t[1],c=i[1],d=o|c,m=d<(B|ne|u),S=c==u&&o==M||c==u&&o==w&&t[7].length<=i[8]||c==(u|w)&&i[7].length<=i[8]&&o==M;if(!(m||S))return t;c&B&&(t[2]=i[2],d|=o&B?0:T);var N=i[3];if(N){var U=t[3];t[3]=U?Lh(U,N,i[4]):N,t[4]=U?Ni(t[3],_):i[4]}return N=i[5],N&&(U=t[5],t[5]=U?$h(U,N,i[6]):N,t[6]=U?Ni(t[5],_):i[6]),N=i[7],N&&(t[7]=N),c&u&&(t[8]=t[8]==null?i[8]:Qt(t[8],i[8])),t[9]==null&&(t[9]=i[9]),t[0]=i[0],t[1]=d,t}function j0(t){var i=[];if(t!=null)for(var o in ht(t))i.push(o);return i}function q0(t){return io.call(t)}function Xh(t,i,o){return i=Bt(i===r?t.length-1:i,0),function(){for(var c=arguments,d=-1,m=Bt(c.length-i,0),S=z(m);++d<m;)S[d]=c[i+d];d=-1;for(var N=z(i+1);++d<i;)N[d]=c[d];return N[i]=o(S),kt(t,this,N)}}function Zh(t,i){return i.length<2?t:Qi(t,Dr(i,0,-1))}function H0(t,i){for(var o=t.length,c=Qt(i.length,o),d=pr(t);c--;){var m=i[c];t[c]=pi(m,o)?d[m]:r}return t}function gc(t,i){if(!(i==="constructor"&&typeof t[i]=="function")&&i!="__proto__")return t[i]}var el=rl(Ih),us=rg||function(t,i){return Qe.setTimeout(t,i)},vc=rl(h0);function tl(t,i,o){var c=i+"";return vc(t,C0(c,z0(N0(c),o)))}function rl(t){var i=0,o=0;return function(){var c=og(),d=ge-(c-o);if(o=c,d>0){if(++i>=ue)return arguments[0]}else i=0;return t.apply(r,arguments)}}function Ao(t,i){var o=-1,c=t.length,d=c-1;for(i=i===r?c:i;++o<i;){var m=Xa(o,d),S=t[m];t[m]=t[o],t[o]=S}return t.length=i,t}var il=U0(function(t){var i=[];return t.charCodeAt(0)===46&&i.push(""),t.replace(Dt,function(o,c,d,m){i.push(d?m.replace(ua,"$1"):c||o)}),i});function ei(t){if(typeof t=="string"||xr(t))return t;var i=t+"";return i=="0"&&1/t==-te?"-0":i}function Zi(t){if(t!=null){try{return ro.call(t)}catch{}try{return t+""}catch{}}return""}function z0(t,i){return Cr(we,function(o){var c="_."+o[0];i&o[1]&&!Qs(t,c)&&t.push(c)}),t.sort()}function nl(t){if(t instanceof Ye)return t.clone();var i=new $r(t.__wrapped__,t.__chain__);return i.__actions__=pr(t.__actions__),i.__index__=t.__index__,i.__values__=t.__values__,i}function K0(t,i,o){(o?sr(t,i,o):i===r)?i=1:i=Bt(Me(i),0);var c=t==null?0:t.length;if(!c||i<1)return[];for(var d=0,m=0,S=z(uo(c/i));d<c;)S[m++]=Dr(t,d,d+=i);return S}function B0(t){for(var i=-1,o=t==null?0:t.length,c=0,d=[];++i<o;){var m=t[i];m&&(d[c++]=m)}return d}function k0(){var t=arguments.length;if(!t)return[];for(var i=z(t-1),o=arguments[0],c=t;c--;)i[c-1]=arguments[c];return Ai(Ce(o)?pr(o):[o],Yt(i,1))}var V0=Be(function(t,i){return Ct(t)?is(t,Yt(i,1,Ct,!0)):[]}),G0=Be(function(t,i){var o=Ur(i);return Ct(o)&&(o=r),Ct(t)?is(t,Yt(i,1,Ct,!0),_e(o,2)):[]}),W0=Be(function(t,i){var o=Ur(i);return Ct(o)&&(o=r),Ct(t)?is(t,Yt(i,1,Ct,!0),r,o):[]});function Y0(t,i,o){var c=t==null?0:t.length;return c?(i=o||i===r?1:Me(i),Dr(t,i<0?0:i,c)):[]}function J0(t,i,o){var c=t==null?0:t.length;return c?(i=o||i===r?1:Me(i),i=c-i,Dr(t,0,i<0?0:i)):[]}function Q0(t,i){return t&&t.length?wo(t,_e(i,3),!0,!0):[]}function X0(t,i){return t&&t.length?wo(t,_e(i,3),!0):[]}function Z0(t,i,o,c){var d=t==null?0:t.length;return d?(o&&typeof o!="number"&&sr(t,i,o)&&(o=0,c=d),kg(t,i,o,c)):[]}function sl(t,i,o){var c=t==null?0:t.length;if(!c)return-1;var d=o==null?0:Me(o);return d<0&&(d=Bt(c+d,0)),Xs(t,_e(i,3),d)}function ol(t,i,o){var c=t==null?0:t.length;if(!c)return-1;var d=c-1;return o!==r&&(d=Me(o),d=o<0?Bt(c+d,0):Qt(d,c-1)),Xs(t,_e(i,3),d,!0)}function al(t){var i=t==null?0:t.length;return i?Yt(t,1):[]}function e1(t){var i=t==null?0:t.length;return i?Yt(t,te):[]}function t1(t,i){var o=t==null?0:t.length;return o?(i=i===r?1:Me(i),Yt(t,i)):[]}function r1(t){for(var i=-1,o=t==null?0:t.length,c={};++i<o;){var d=t[i];c[d[0]]=d[1]}return c}function cl(t){return t&&t.length?t[0]:r}function i1(t,i,o){var c=t==null?0:t.length;if(!c)return-1;var d=o==null?0:Me(o);return d<0&&(d=Bt(c+d,0)),wn(t,i,d)}function n1(t){var i=t==null?0:t.length;return i?Dr(t,0,-1):[]}var s1=Be(function(t){var i=_t(t,ic);return i.length&&i[0]===t[0]?Ga(i):[]}),o1=Be(function(t){var i=Ur(t),o=_t(t,ic);return i===Ur(o)?i=r:o.pop(),o.length&&o[0]===t[0]?Ga(o,_e(i,2)):[]}),a1=Be(function(t){var i=Ur(t),o=_t(t,ic);return i=typeof i=="function"?i:r,i&&o.pop(),o.length&&o[0]===t[0]?Ga(o,r,i):[]});function c1(t,i){return t==null?"":ng.call(t,i)}function Ur(t){var i=t==null?0:t.length;return i?t[i-1]:r}function u1(t,i,o){var c=t==null?0:t.length;if(!c)return-1;var d=c;return o!==r&&(d=Me(o),d=d<0?Bt(c+d,0):Qt(d,c-1)),i===i?zp(t,i,d):Xs(t,zu,d,!0)}function h1(t,i){return t&&t.length?_h(t,Me(i)):r}var l1=Be(ul);function ul(t,i){return t&&t.length&&i&&i.length?Qa(t,i):t}function f1(t,i,o){return t&&t.length&&i&&i.length?Qa(t,i,_e(o,2)):t}function d1(t,i,o){return t&&t.length&&i&&i.length?Qa(t,i,r,o):t}var p1=di(function(t,i){var o=t==null?0:t.length,c=Ka(t,i);return Eh(t,_t(i,function(d){return pi(d,o)?+d:d}).sort(Ch)),c});function g1(t,i){var o=[];if(!(t&&t.length))return o;var c=-1,d=[],m=t.length;for(i=_e(i,3);++c<m;){var S=t[c];i(S,c,t)&&(o.push(S),d.push(c))}return Eh(t,d),o}function yc(t){return t==null?t:cg.call(t)}function v1(t,i,o){var c=t==null?0:t.length;return c?(o&&typeof o!="number"&&sr(t,i,o)?(i=0,o=c):(i=i==null?0:Me(i),o=o===r?c:Me(o)),Dr(t,i,o)):[]}function y1(t,i){return _o(t,i)}function m1(t,i,o){return ec(t,i,_e(o,2))}function _1(t,i){var o=t==null?0:t.length;if(o){var c=_o(t,i);if(c<o&&Br(t[c],i))return c}return-1}function w1(t,i){return _o(t,i,!0)}function b1(t,i,o){return ec(t,i,_e(o,2),!0)}function E1(t,i){var o=t==null?0:t.length;if(o){var c=_o(t,i,!0)-1;if(Br(t[c],i))return c}return-1}function I1(t){return t&&t.length?Sh(t):[]}function S1(t,i){return t&&t.length?Sh(t,_e(i,2)):[]}function x1(t){var i=t==null?0:t.length;return i?Dr(t,1,i):[]}function P1(t,i,o){return t&&t.length?(i=o||i===r?1:Me(i),Dr(t,0,i<0?0:i)):[]}function O1(t,i,o){var c=t==null?0:t.length;return c?(i=o||i===r?1:Me(i),i=c-i,Dr(t,i<0?0:i,c)):[]}function A1(t,i){return t&&t.length?wo(t,_e(i,3),!1,!0):[]}function N1(t,i){return t&&t.length?wo(t,_e(i,3)):[]}var R1=Be(function(t){return Ci(Yt(t,1,Ct,!0))}),T1=Be(function(t){var i=Ur(t);return Ct(i)&&(i=r),Ci(Yt(t,1,Ct,!0),_e(i,2))}),C1=Be(function(t){var i=Ur(t);return i=typeof i=="function"?i:r,Ci(Yt(t,1,Ct,!0),r,i)});function L1(t){return t&&t.length?Ci(t):[]}function $1(t,i){return t&&t.length?Ci(t,_e(i,2)):[]}function F1(t,i){return i=typeof i=="function"?i:r,t&&t.length?Ci(t,r,i):[]}function mc(t){if(!(t&&t.length))return[];var i=0;return t=Oi(t,function(o){if(Ct(o))return i=Bt(o.length,i),!0}),Fa(i,function(o){return _t(t,Ca(o))})}function hl(t,i){if(!(t&&t.length))return[];var o=mc(t);return i==null?o:_t(o,function(c){return kt(i,r,c)})}var D1=Be(function(t,i){return Ct(t)?is(t,i):[]}),U1=Be(function(t){return rc(Oi(t,Ct))}),M1=Be(function(t){var i=Ur(t);return Ct(i)&&(i=r),rc(Oi(t,Ct),_e(i,2))}),j1=Be(function(t){var i=Ur(t);return i=typeof i=="function"?i:r,rc(Oi(t,Ct),r,i)}),q1=Be(mc);function H1(t,i){return Ah(t||[],i||[],rs)}function z1(t,i){return Ah(t||[],i||[],os)}var K1=Be(function(t){var i=t.length,o=i>1?t[i-1]:r;return o=typeof o=="function"?(t.pop(),o):r,hl(t,o)});function ll(t){var i=y(t);return i.__chain__=!0,i}function B1(t,i){return i(t),t}function No(t,i){return i(t)}var k1=di(function(t){var i=t.length,o=i?t[0]:0,c=this.__wrapped__,d=function(m){return Ka(m,t)};return i>1||this.__actions__.length||!(c instanceof Ye)||!pi(o)?this.thru(d):(c=c.slice(o,+o+(i?1:0)),c.__actions__.push({func:No,args:[d],thisArg:r}),new $r(c,this.__chain__).thru(function(m){return i&&!m.length&&m.push(r),m}))});function V1(){return ll(this)}function G1(){return new $r(this.value(),this.__chain__)}function W1(){this.__values__===r&&(this.__values__=xl(this.value()));var t=this.__index__>=this.__values__.length,i=t?r:this.__values__[this.__index__++];return{done:t,value:i}}function Y1(){return this}function J1(t){for(var i,o=this;o instanceof po;){var c=nl(o);c.__index__=0,c.__values__=r,i?d.__wrapped__=c:i=c;var d=c;o=o.__wrapped__}return d.__wrapped__=t,i}function Q1(){var t=this.__wrapped__;if(t instanceof Ye){var i=t;return this.__actions__.length&&(i=new Ye(this)),i=i.reverse(),i.__actions__.push({func:No,args:[yc],thisArg:r}),new $r(i,this.__chain__)}return this.thru(yc)}function X1(){return Oh(this.__wrapped__,this.__actions__)}var Z1=bo(function(t,i,o){nt.call(t,o)?++t[o]:li(t,o,1)});function ev(t,i,o){var c=Ce(t)?qu:Bg;return o&&sr(t,i,o)&&(i=r),c(t,_e(i,3))}function tv(t,i){var o=Ce(t)?Oi:hh;return o(t,_e(i,3))}var rv=Mh(sl),iv=Mh(ol);function nv(t,i){return Yt(Ro(t,i),1)}function sv(t,i){return Yt(Ro(t,i),te)}function ov(t,i,o){return o=o===r?1:Me(o),Yt(Ro(t,i),o)}function fl(t,i){var o=Ce(t)?Cr:Ti;return o(t,_e(i,3))}function dl(t,i){var o=Ce(t)?xp:uh;return o(t,_e(i,3))}var av=bo(function(t,i,o){nt.call(t,o)?t[o].push(i):li(t,o,[i])});function cv(t,i,o,c){t=gr(t)?t:Cn(t),o=o&&!c?Me(o):0;var d=t.length;return o<0&&(o=Bt(d+o,0)),Fo(t)?o<=d&&t.indexOf(i,o)>-1:!!d&&wn(t,i,o)>-1}var uv=Be(function(t,i,o){var c=-1,d=typeof i=="function",m=gr(t)?z(t.length):[];return Ti(t,function(S){m[++c]=d?kt(i,S,o):ns(S,i,o)}),m}),hv=bo(function(t,i,o){li(t,o,i)});function Ro(t,i){var o=Ce(t)?_t:vh;return o(t,_e(i,3))}function lv(t,i,o,c){return t==null?[]:(Ce(i)||(i=i==null?[]:[i]),o=c?r:o,Ce(o)||(o=o==null?[]:[o]),wh(t,i,o))}var fv=bo(function(t,i,o){t[o?0:1].push(i)},function(){return[[],[]]});function dv(t,i,o){var c=Ce(t)?Ra:Bu,d=arguments.length<3;return c(t,_e(i,4),o,d,Ti)}function pv(t,i,o){var c=Ce(t)?Pp:Bu,d=arguments.length<3;return c(t,_e(i,4),o,d,uh)}function gv(t,i){var o=Ce(t)?Oi:hh;return o(t,Lo(_e(i,3)))}function vv(t){var i=Ce(t)?sh:c0;return i(t)}function yv(t,i,o){(o?sr(t,i,o):i===r)?i=1:i=Me(i);var c=Ce(t)?jg:u0;return c(t,i)}function mv(t){var i=Ce(t)?qg:l0;return i(t)}function _v(t){if(t==null)return 0;if(gr(t))return Fo(t)?En(t):t.length;var i=Xt(t);return i==Se||i==xe?t.size:Ya(t).length}function wv(t,i,o){var c=Ce(t)?Ta:f0;return o&&sr(t,i,o)&&(i=r),c(t,_e(i,3))}var bv=Be(function(t,i){if(t==null)return[];var o=i.length;return o>1&&sr(t,i[0],i[1])?i=[]:o>2&&sr(i[0],i[1],i[2])&&(i=[i[0]]),wh(t,Yt(i,1),[])}),To=tg||function(){return Qe.Date.now()};function Ev(t,i){if(typeof i!="function")throw new Lr(p);return t=Me(t),function(){if(--t<1)return i.apply(this,arguments)}}function pl(t,i,o){return i=o?r:i,i=t&&i==null?t.length:i,fi(t,u,r,r,r,r,i)}function gl(t,i){var o;if(typeof i!="function")throw new Lr(p);return t=Me(t),function(){return--t>0&&(o=i.apply(this,arguments)),t<=1&&(i=r),o}}var _c=Be(function(t,i,o){var c=B;if(o.length){var d=Ni(o,Rn(_c));c|=R}return fi(t,c,i,o,d)}),vl=Be(function(t,i,o){var c=B|ne;if(o.length){var d=Ni(o,Rn(vl));c|=R}return fi(i,c,t,o,d)});function yl(t,i,o){i=o?r:i;var c=fi(t,M,r,r,r,r,r,i);return c.placeholder=yl.placeholder,c}function ml(t,i,o){i=o?r:i;var c=fi(t,x,r,r,r,r,r,i);return c.placeholder=ml.placeholder,c}function _l(t,i,o){var c,d,m,S,N,U,J=0,Q=!1,Z=!1,ce=!0;if(typeof t!="function")throw new Lr(p);i=Mr(i)||0,Et(o)&&(Q=!!o.leading,Z="maxWait"in o,m=Z?Bt(Mr(o.maxWait)||0,i):m,ce="trailing"in o?!!o.trailing:ce);function ve(Lt){var kr=c,yi=d;return c=d=r,J=Lt,S=t.apply(yi,kr),S}function be(Lt){return J=Lt,N=us(Ge,i),Q?ve(Lt):S}function He(Lt){var kr=Lt-U,yi=Lt-J,Ml=i-kr;return Z?Qt(Ml,m-yi):Ml}function Ee(Lt){var kr=Lt-U,yi=Lt-J;return U===r||kr>=i||kr<0||Z&&yi>=m}function Ge(){var Lt=To();if(Ee(Lt))return Xe(Lt);N=us(Ge,He(Lt))}function Xe(Lt){return N=r,ce&&c?ve(Lt):(c=d=r,S)}function Pr(){N!==r&&Nh(N),J=0,c=U=d=N=r}function or(){return N===r?S:Xe(To())}function Or(){var Lt=To(),kr=Ee(Lt);if(c=arguments,d=this,U=Lt,kr){if(N===r)return be(U);if(Z)return Nh(N),N=us(Ge,i),ve(U)}return N===r&&(N=us(Ge,i)),S}return Or.cancel=Pr,Or.flush=or,Or}var Iv=Be(function(t,i){return ch(t,1,i)}),Sv=Be(function(t,i,o){return ch(t,Mr(i)||0,o)});function xv(t){return fi(t,G)}function Co(t,i){if(typeof t!="function"||i!=null&&typeof i!="function")throw new Lr(p);var o=function(){var c=arguments,d=i?i.apply(this,c):c[0],m=o.cache;if(m.has(d))return m.get(d);var S=t.apply(this,c);return o.cache=m.set(d,S)||m,S};return o.cache=new(Co.Cache||hi),o}Co.Cache=hi;function Lo(t){if(typeof t!="function")throw new Lr(p);return function(){var i=arguments;switch(i.length){case 0:return!t.call(this);case 1:return!t.call(this,i[0]);case 2:return!t.call(this,i[0],i[1]);case 3:return!t.call(this,i[0],i[1],i[2])}return!t.apply(this,i)}}function Pv(t){return gl(2,t)}var Ov=d0(function(t,i){i=i.length==1&&Ce(i[0])?_t(i[0],Ir(_e())):_t(Yt(i,1),Ir(_e()));var o=i.length;return Be(function(c){for(var d=-1,m=Qt(c.length,o);++d<m;)c[d]=i[d].call(this,c[d]);return kt(t,this,c)})}),wc=Be(function(t,i){var o=Ni(i,Rn(wc));return fi(t,R,r,i,o)}),wl=Be(function(t,i){var o=Ni(i,Rn(wl));return fi(t,b,r,i,o)}),Av=di(function(t,i){return fi(t,w,r,r,r,i)});function Nv(t,i){if(typeof t!="function")throw new Lr(p);return i=i===r?i:Me(i),Be(t,i)}function Rv(t,i){if(typeof t!="function")throw new Lr(p);return i=i==null?0:Bt(Me(i),0),Be(function(o){var c=o[i],d=$i(o,0,i);return c&&Ai(d,c),kt(t,this,d)})}function Tv(t,i,o){var c=!0,d=!0;if(typeof t!="function")throw new Lr(p);return Et(o)&&(c="leading"in o?!!o.leading:c,d="trailing"in o?!!o.trailing:d),_l(t,i,{leading:c,maxWait:i,trailing:d})}function Cv(t){return pl(t,1)}function Lv(t,i){return wc(nc(i),t)}function $v(){if(!arguments.length)return[];var t=arguments[0];return Ce(t)?t:[t]}function Fv(t){return Fr(t,A)}function Dv(t,i){return i=typeof i=="function"?i:r,Fr(t,A,i)}function Uv(t){return Fr(t,I|A)}function Mv(t,i){return i=typeof i=="function"?i:r,Fr(t,I|A,i)}function jv(t,i){return i==null||ah(t,i,Vt(i))}function Br(t,i){return t===i||t!==t&&i!==i}var qv=xo(Va),Hv=xo(function(t,i){return t>=i}),en=dh(function(){return arguments}())?dh:function(t){return Nt(t)&&nt.call(t,"callee")&&!Zu.call(t,"callee")},Ce=z.isArray,zv=ir?Ir(ir):Jg;function gr(t){return t!=null&&$o(t.length)&&!gi(t)}function Ct(t){return Nt(t)&&gr(t)}function Kv(t){return t===!0||t===!1||Nt(t)&&nr(t)==j}var Fi=ig||Tc,Bv=Hr?Ir(Hr):Qg;function kv(t){return Nt(t)&&t.nodeType===1&&!hs(t)}function Vv(t){if(t==null)return!0;if(gr(t)&&(Ce(t)||typeof t=="string"||typeof t.splice=="function"||Fi(t)||Tn(t)||en(t)))return!t.length;var i=Xt(t);if(i==Se||i==xe)return!t.size;if(cs(t))return!Ya(t).length;for(var o in t)if(nt.call(t,o))return!1;return!0}function Gv(t,i){return ss(t,i)}function Wv(t,i,o){o=typeof o=="function"?o:r;var c=o?o(t,i):r;return c===r?ss(t,i,r,o):!!c}function bc(t){if(!Nt(t))return!1;var i=nr(t);return i==O||i==h||typeof t.message=="string"&&typeof t.name=="string"&&!hs(t)}function Yv(t){return typeof t=="number"&&th(t)}function gi(t){if(!Et(t))return!1;var i=nr(t);return i==se||i==fe||i==q||i==vt}function bl(t){return typeof t=="number"&&t==Me(t)}function $o(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=W}function Et(t){var i=typeof t;return t!=null&&(i=="object"||i=="function")}function Nt(t){return t!=null&&typeof t=="object"}var El=Tr?Ir(Tr):Zg;function Jv(t,i){return t===i||Wa(t,i,lc(i))}function Qv(t,i,o){return o=typeof o=="function"?o:r,Wa(t,i,lc(i),o)}function Xv(t){return Il(t)&&t!=+t}function Zv(t){if(D0(t))throw new Re(l);return ph(t)}function ey(t){return t===null}function ty(t){return t==null}function Il(t){return typeof t=="number"||Nt(t)&&nr(t)==ze}function hs(t){if(!Nt(t)||nr(t)!=Ue)return!1;var i=oo(t);if(i===null)return!0;var o=nt.call(i,"constructor")&&i.constructor;return typeof o=="function"&&o instanceof o&&ro.call(o)==Qp}var Ec=Qr?Ir(Qr):e0;function ry(t){return bl(t)&&t>=-W&&t<=W}var Sl=Yn?Ir(Yn):t0;function Fo(t){return typeof t=="string"||!Ce(t)&&Nt(t)&&nr(t)==Le}function xr(t){return typeof t=="symbol"||Nt(t)&&nr(t)==$e}var Tn=Vi?Ir(Vi):r0;function iy(t){return t===r}function ny(t){return Nt(t)&&Xt(t)==Ae}function sy(t){return Nt(t)&&nr(t)==Fe}var oy=xo(Ja),ay=xo(function(t,i){return t<=i});function xl(t){if(!t)return[];if(gr(t))return Fo(t)?zr(t):pr(t);if(Qn&&t[Qn])return jp(t[Qn]());var i=Xt(t),o=i==Se?Ua:i==xe?Zs:Cn;return o(t)}function vi(t){if(!t)return t===0?t:0;if(t=Mr(t),t===te||t===-te){var i=t<0?-1:1;return i*ee}return t===t?t:0}function Me(t){var i=vi(t),o=i%1;return i===i?o?i-o:i:0}function Pl(t){return t?Ji(Me(t),0,re):0}function Mr(t){if(typeof t=="number")return t;if(xr(t))return Y;if(Et(t)){var i=typeof t.valueOf=="function"?t.valueOf():t;t=Et(i)?i+"":i}if(typeof t!="string")return t===0?t:+t;t=ku(t);var o=fa.test(t);return o||pa.test(t)?Te(t.slice(2),o?2:8):la.test(t)?Y:+t}function Ol(t){return Zr(t,vr(t))}function cy(t){return t?Ji(Me(t),-W,W):t===0?t:0}function it(t){return t==null?"":Sr(t)}var uy=An(function(t,i){if(cs(i)||gr(i)){Zr(i,Vt(i),t);return}for(var o in i)nt.call(i,o)&&rs(t,o,i[o])}),Al=An(function(t,i){Zr(i,vr(i),t)}),Do=An(function(t,i,o,c){Zr(i,vr(i),t,c)}),hy=An(function(t,i,o,c){Zr(i,Vt(i),t,c)}),ly=di(Ka);function fy(t,i){var o=On(t);return i==null?o:oh(o,i)}var dy=Be(function(t,i){t=ht(t);var o=-1,c=i.length,d=c>2?i[2]:r;for(d&&sr(i[0],i[1],d)&&(c=1);++o<c;)for(var m=i[o],S=vr(m),N=-1,U=S.length;++N<U;){var J=S[N],Q=t[J];(Q===r||Br(Q,Sn[J])&&!nt.call(t,J))&&(t[J]=m[J])}return t}),py=Be(function(t){return t.push(r,kh),kt(Nl,r,t)});function gy(t,i){return Hu(t,_e(i,3),Xr)}function vy(t,i){return Hu(t,_e(i,3),ka)}function yy(t,i){return t==null?t:Ba(t,_e(i,3),vr)}function my(t,i){return t==null?t:lh(t,_e(i,3),vr)}function _y(t,i){return t&&Xr(t,_e(i,3))}function wy(t,i){return t&&ka(t,_e(i,3))}function by(t){return t==null?[]:yo(t,Vt(t))}function Ey(t){return t==null?[]:yo(t,vr(t))}function Ic(t,i,o){var c=t==null?r:Qi(t,i);return c===r?o:c}function Iy(t,i){return t!=null&&Wh(t,i,Vg)}function Sc(t,i){return t!=null&&Wh(t,i,Gg)}var Sy=qh(function(t,i,o){i!=null&&typeof i.toString!="function"&&(i=io.call(i)),t[i]=o},Pc(yr)),xy=qh(function(t,i,o){i!=null&&typeof i.toString!="function"&&(i=io.call(i)),nt.call(t,i)?t[i].push(o):t[i]=[o]},_e),Py=Be(ns);function Vt(t){return gr(t)?nh(t):Ya(t)}function vr(t){return gr(t)?nh(t,!0):i0(t)}function Oy(t,i){var o={};return i=_e(i,3),Xr(t,function(c,d,m){li(o,i(c,d,m),c)}),o}function Ay(t,i){var o={};return i=_e(i,3),Xr(t,function(c,d,m){li(o,d,i(c,d,m))}),o}var Ny=An(function(t,i,o){mo(t,i,o)}),Nl=An(function(t,i,o,c){mo(t,i,o,c)}),Ry=di(function(t,i){var o={};if(t==null)return o;var c=!1;i=_t(i,function(m){return m=Li(m,t),c||(c=m.length>1),m}),Zr(t,uc(t),o),c&&(o=Fr(o,I|P|A,S0));for(var d=i.length;d--;)tc(o,i[d]);return o});function Ty(t,i){return Rl(t,Lo(_e(i)))}var Cy=di(function(t,i){return t==null?{}:s0(t,i)});function Rl(t,i){if(t==null)return{};var o=_t(uc(t),function(c){return[c]});return i=_e(i),bh(t,o,function(c,d){return i(c,d[0])})}function Ly(t,i,o){i=Li(i,t);var c=-1,d=i.length;for(d||(d=1,t=r);++c<d;){var m=t==null?r:t[ei(i[c])];m===r&&(c=d,m=o),t=gi(m)?m.call(t):m}return t}function $y(t,i,o){return t==null?t:os(t,i,o)}function Fy(t,i,o,c){return c=typeof c=="function"?c:r,t==null?t:os(t,i,o,c)}var Tl=Kh(Vt),Cl=Kh(vr);function Dy(t,i,o){var c=Ce(t),d=c||Fi(t)||Tn(t);if(i=_e(i,4),o==null){var m=t&&t.constructor;d?o=c?new m:[]:Et(t)?o=gi(m)?On(oo(t)):{}:o={}}return(d?Cr:Xr)(t,function(S,N,U){return i(o,S,N,U)}),o}function Uy(t,i){return t==null?!0:tc(t,i)}function My(t,i,o){return t==null?t:Ph(t,i,nc(o))}function jy(t,i,o,c){return c=typeof c=="function"?c:r,t==null?t:Ph(t,i,nc(o),c)}function Cn(t){return t==null?[]:Da(t,Vt(t))}function qy(t){return t==null?[]:Da(t,vr(t))}function Hy(t,i,o){return o===r&&(o=i,i=r),o!==r&&(o=Mr(o),o=o===o?o:0),i!==r&&(i=Mr(i),i=i===i?i:0),Ji(Mr(t),i,o)}function zy(t,i,o){return i=vi(i),o===r?(o=i,i=0):o=vi(o),t=Mr(t),Wg(t,i,o)}function Ky(t,i,o){if(o&&typeof o!="boolean"&&sr(t,i,o)&&(i=o=r),o===r&&(typeof i=="boolean"?(o=i,i=r):typeof t=="boolean"&&(o=t,t=r)),t===r&&i===r?(t=0,i=1):(t=vi(t),i===r?(i=t,t=0):i=vi(i)),t>i){var c=t;t=i,i=c}if(o||t%1||i%1){var d=rh();return Qt(t+d*(i-t+ct("1e-"+((d+"").length-1))),i)}return Xa(t,i)}var By=Nn(function(t,i,o){return i=i.toLowerCase(),t+(o?Ll(i):i)});function Ll(t){return xc(it(t).toLowerCase())}function $l(t){return t=it(t),t&&t.replace(ai,$p).replace(Oa,"")}function ky(t,i,o){t=it(t),i=Sr(i);var c=t.length;o=o===r?c:Ji(Me(o),0,c);var d=o;return o-=i.length,o>=0&&t.slice(o,d)==i}function Vy(t){return t=it(t),t&&yt.test(t)?t.replace(Hi,Fp):t}function Gy(t){return t=it(t),t&&Ut.test(t)?t.replace(Pt,"\\$&"):t}var Wy=Nn(function(t,i,o){return t+(o?"-":"")+i.toLowerCase()}),Yy=Nn(function(t,i,o){return t+(o?" ":"")+i.toLowerCase()}),Jy=Uh("toLowerCase");function Qy(t,i,o){t=it(t),i=Me(i);var c=i?En(t):0;if(!i||c>=i)return t;var d=(i-c)/2;return So(ho(d),o)+t+So(uo(d),o)}function Xy(t,i,o){t=it(t),i=Me(i);var c=i?En(t):0;return i&&c<i?t+So(i-c,o):t}function Zy(t,i,o){t=it(t),i=Me(i);var c=i?En(t):0;return i&&c<i?So(i-c,o)+t:t}function em(t,i,o){return o||i==null?i=0:i&&(i=+i),ag(it(t).replace(Ot,""),i||0)}function tm(t,i,o){return(o?sr(t,i,o):i===r)?i=1:i=Me(i),Za(it(t),i)}function rm(){var t=arguments,i=it(t[0]);return t.length<3?i:i.replace(t[1],t[2])}var im=Nn(function(t,i,o){return t+(o?"_":"")+i.toLowerCase()});function nm(t,i,o){return o&&typeof o!="number"&&sr(t,i,o)&&(i=o=r),o=o===r?re:o>>>0,o?(t=it(t),t&&(typeof i=="string"||i!=null&&!Ec(i))&&(i=Sr(i),!i&&bn(t))?$i(zr(t),0,o):t.split(i,o)):[]}var sm=Nn(function(t,i,o){return t+(o?" ":"")+xc(i)});function om(t,i,o){return t=it(t),o=o==null?0:Ji(Me(o),0,t.length),i=Sr(i),t.slice(o,o+i.length)==i}function am(t,i,o){var c=y.templateSettings;o&&sr(t,i,o)&&(i=r),t=it(t),i=Do({},i,c,Bh);var d=Do({},i.imports,c.imports,Bh),m=Vt(d),S=Da(d,m),N,U,J=0,Q=i.interpolate||dn,Z="__p += '",ce=Ma((i.escape||dn).source+"|"+Q.source+"|"+(Q===bt?ha:dn).source+"|"+(i.evaluate||dn).source+"|$","g"),ve="//# sourceURL="+(nt.call(i,"sourceURL")?(i.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Aa+"]")+`
`;t.replace(ce,function(Ee,Ge,Xe,Pr,or,Or){return Xe||(Xe=Pr),Z+=t.slice(J,Or).replace(va,Dp),Ge&&(N=!0,Z+=`' +
__e(`+Ge+`) +
'`),or&&(U=!0,Z+=`';
`+or+`;
__p += '`),Xe&&(Z+=`' +
((__t = (`+Xe+`)) == null ? '' : __t) +
'`),J=Or+Ee.length,Ee}),Z+=`';
`;var be=nt.call(i,"variable")&&i.variable;if(!be)Z=`with (obj) {
`+Z+`
}
`;else if(ca.test(be))throw new Re(f);Z=(U?Z.replace(Yr,""):Z).replace(rr,"$1").replace(oi,"$1;"),Z="function("+(be||"obj")+`) {
`+(be?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(N?", __e = _.escape":"")+(U?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Z+`return __p
}`;var He=Dl(function(){return rt(m,ve+"return "+Z).apply(r,S)});if(He.source=Z,bc(He))throw He;return He}function cm(t){return it(t).toLowerCase()}function um(t){return it(t).toUpperCase()}function hm(t,i,o){if(t=it(t),t&&(o||i===r))return ku(t);if(!t||!(i=Sr(i)))return t;var c=zr(t),d=zr(i),m=Vu(c,d),S=Gu(c,d)+1;return $i(c,m,S).join("")}function lm(t,i,o){if(t=it(t),t&&(o||i===r))return t.slice(0,Yu(t)+1);if(!t||!(i=Sr(i)))return t;var c=zr(t),d=Gu(c,zr(i))+1;return $i(c,0,d).join("")}function fm(t,i,o){if(t=it(t),t&&(o||i===r))return t.replace(Ot,"");if(!t||!(i=Sr(i)))return t;var c=zr(t),d=Vu(c,zr(i));return $i(c,d).join("")}function dm(t,i){var o=V,c=oe;if(Et(i)){var d="separator"in i?i.separator:d;o="length"in i?Me(i.length):o,c="omission"in i?Sr(i.omission):c}t=it(t);var m=t.length;if(bn(t)){var S=zr(t);m=S.length}if(o>=m)return t;var N=o-En(c);if(N<1)return c;var U=S?$i(S,0,N).join(""):t.slice(0,N);if(d===r)return U+c;if(S&&(N+=U.length-N),Ec(d)){if(t.slice(N).search(d)){var J,Q=U;for(d.global||(d=Ma(d.source,it(Rr.exec(d))+"g")),d.lastIndex=0;J=d.exec(Q);)var Z=J.index;U=U.slice(0,Z===r?N:Z)}}else if(t.indexOf(Sr(d),N)!=N){var ce=U.lastIndexOf(d);ce>-1&&(U=U.slice(0,ce))}return U+c}function pm(t){return t=it(t),t&&It.test(t)?t.replace(xi,Kp):t}var gm=Nn(function(t,i,o){return t+(o?" ":"")+i.toUpperCase()}),xc=Uh("toUpperCase");function Fl(t,i,o){return t=it(t),i=o?r:i,i===r?Mp(t)?Vp(t):Np(t):t.match(i)||[]}var Dl=Be(function(t,i){try{return kt(t,r,i)}catch(o){return bc(o)?o:new Re(o)}}),vm=di(function(t,i){return Cr(i,function(o){o=ei(o),li(t,o,_c(t[o],t))}),t});function ym(t){var i=t==null?0:t.length,o=_e();return t=i?_t(t,function(c){if(typeof c[1]!="function")throw new Lr(p);return[o(c[0]),c[1]]}):[],Be(function(c){for(var d=-1;++d<i;){var m=t[d];if(kt(m[0],this,c))return kt(m[1],this,c)}})}function mm(t){return Kg(Fr(t,I))}function Pc(t){return function(){return t}}function _m(t,i){return t==null||t!==t?i:t}var wm=jh(),bm=jh(!0);function yr(t){return t}function Oc(t){return gh(typeof t=="function"?t:Fr(t,I))}function Em(t){return yh(Fr(t,I))}function Im(t,i){return mh(t,Fr(i,I))}var Sm=Be(function(t,i){return function(o){return ns(o,t,i)}}),xm=Be(function(t,i){return function(o){return ns(t,o,i)}});function Ac(t,i,o){var c=Vt(i),d=yo(i,c);o==null&&!(Et(i)&&(d.length||!c.length))&&(o=i,i=t,t=this,d=yo(i,Vt(i)));var m=!(Et(o)&&"chain"in o)||!!o.chain,S=gi(t);return Cr(d,function(N){var U=i[N];t[N]=U,S&&(t.prototype[N]=function(){var J=this.__chain__;if(m||J){var Q=t(this.__wrapped__),Z=Q.__actions__=pr(this.__actions__);return Z.push({func:U,args:arguments,thisArg:t}),Q.__chain__=J,Q}return U.apply(t,Ai([this.value()],arguments))})}),t}function Pm(){return Qe._===this&&(Qe._=Xp),this}function Nc(){}function Om(t){return t=Me(t),Be(function(i){return _h(i,t)})}var Am=oc(_t),Nm=oc(qu),Rm=oc(Ta);function Ul(t){return dc(t)?Ca(ei(t)):o0(t)}function Tm(t){return function(i){return t==null?r:Qi(t,i)}}var Cm=Hh(),Lm=Hh(!0);function Rc(){return[]}function Tc(){return!1}function $m(){return{}}function Fm(){return""}function Dm(){return!0}function Um(t,i){if(t=Me(t),t<1||t>W)return[];var o=re,c=Qt(t,re);i=_e(i),t-=re;for(var d=Fa(c,i);++o<t;)i(o);return d}function Mm(t){return Ce(t)?_t(t,ei):xr(t)?[t]:pr(il(it(t)))}function jm(t){var i=++Jp;return it(t)+i}var qm=Io(function(t,i){return t+i},0),Hm=ac("ceil"),zm=Io(function(t,i){return t/i},1),Km=ac("floor");function Bm(t){return t&&t.length?vo(t,yr,Va):r}function km(t,i){return t&&t.length?vo(t,_e(i,2),Va):r}function Vm(t){return Ku(t,yr)}function Gm(t,i){return Ku(t,_e(i,2))}function Wm(t){return t&&t.length?vo(t,yr,Ja):r}function Ym(t,i){return t&&t.length?vo(t,_e(i,2),Ja):r}var Jm=Io(function(t,i){return t*i},1),Qm=ac("round"),Xm=Io(function(t,i){return t-i},0);function Zm(t){return t&&t.length?$a(t,yr):0}function e_(t,i){return t&&t.length?$a(t,_e(i,2)):0}return y.after=Ev,y.ary=pl,y.assign=uy,y.assignIn=Al,y.assignInWith=Do,y.assignWith=hy,y.at=ly,y.before=gl,y.bind=_c,y.bindAll=vm,y.bindKey=vl,y.castArray=$v,y.chain=ll,y.chunk=K0,y.compact=B0,y.concat=k0,y.cond=ym,y.conforms=mm,y.constant=Pc,y.countBy=Z1,y.create=fy,y.curry=yl,y.curryRight=ml,y.debounce=_l,y.defaults=dy,y.defaultsDeep=py,y.defer=Iv,y.delay=Sv,y.difference=V0,y.differenceBy=G0,y.differenceWith=W0,y.drop=Y0,y.dropRight=J0,y.dropRightWhile=Q0,y.dropWhile=X0,y.fill=Z0,y.filter=tv,y.flatMap=nv,y.flatMapDeep=sv,y.flatMapDepth=ov,y.flatten=al,y.flattenDeep=e1,y.flattenDepth=t1,y.flip=xv,y.flow=wm,y.flowRight=bm,y.fromPairs=r1,y.functions=by,y.functionsIn=Ey,y.groupBy=av,y.initial=n1,y.intersection=s1,y.intersectionBy=o1,y.intersectionWith=a1,y.invert=Sy,y.invertBy=xy,y.invokeMap=uv,y.iteratee=Oc,y.keyBy=hv,y.keys=Vt,y.keysIn=vr,y.map=Ro,y.mapKeys=Oy,y.mapValues=Ay,y.matches=Em,y.matchesProperty=Im,y.memoize=Co,y.merge=Ny,y.mergeWith=Nl,y.method=Sm,y.methodOf=xm,y.mixin=Ac,y.negate=Lo,y.nthArg=Om,y.omit=Ry,y.omitBy=Ty,y.once=Pv,y.orderBy=lv,y.over=Am,y.overArgs=Ov,y.overEvery=Nm,y.overSome=Rm,y.partial=wc,y.partialRight=wl,y.partition=fv,y.pick=Cy,y.pickBy=Rl,y.property=Ul,y.propertyOf=Tm,y.pull=l1,y.pullAll=ul,y.pullAllBy=f1,y.pullAllWith=d1,y.pullAt=p1,y.range=Cm,y.rangeRight=Lm,y.rearg=Av,y.reject=gv,y.remove=g1,y.rest=Nv,y.reverse=yc,y.sampleSize=yv,y.set=$y,y.setWith=Fy,y.shuffle=mv,y.slice=v1,y.sortBy=bv,y.sortedUniq=I1,y.sortedUniqBy=S1,y.split=nm,y.spread=Rv,y.tail=x1,y.take=P1,y.takeRight=O1,y.takeRightWhile=A1,y.takeWhile=N1,y.tap=B1,y.throttle=Tv,y.thru=No,y.toArray=xl,y.toPairs=Tl,y.toPairsIn=Cl,y.toPath=Mm,y.toPlainObject=Ol,y.transform=Dy,y.unary=Cv,y.union=R1,y.unionBy=T1,y.unionWith=C1,y.uniq=L1,y.uniqBy=$1,y.uniqWith=F1,y.unset=Uy,y.unzip=mc,y.unzipWith=hl,y.update=My,y.updateWith=jy,y.values=Cn,y.valuesIn=qy,y.without=D1,y.words=Fl,y.wrap=Lv,y.xor=U1,y.xorBy=M1,y.xorWith=j1,y.zip=q1,y.zipObject=H1,y.zipObjectDeep=z1,y.zipWith=K1,y.entries=Tl,y.entriesIn=Cl,y.extend=Al,y.extendWith=Do,Ac(y,y),y.add=qm,y.attempt=Dl,y.camelCase=By,y.capitalize=Ll,y.ceil=Hm,y.clamp=Hy,y.clone=Fv,y.cloneDeep=Uv,y.cloneDeepWith=Mv,y.cloneWith=Dv,y.conformsTo=jv,y.deburr=$l,y.defaultTo=_m,y.divide=zm,y.endsWith=ky,y.eq=Br,y.escape=Vy,y.escapeRegExp=Gy,y.every=ev,y.find=rv,y.findIndex=sl,y.findKey=gy,y.findLast=iv,y.findLastIndex=ol,y.findLastKey=vy,y.floor=Km,y.forEach=fl,y.forEachRight=dl,y.forIn=yy,y.forInRight=my,y.forOwn=_y,y.forOwnRight=wy,y.get=Ic,y.gt=qv,y.gte=Hv,y.has=Iy,y.hasIn=Sc,y.head=cl,y.identity=yr,y.includes=cv,y.indexOf=i1,y.inRange=zy,y.invoke=Py,y.isArguments=en,y.isArray=Ce,y.isArrayBuffer=zv,y.isArrayLike=gr,y.isArrayLikeObject=Ct,y.isBoolean=Kv,y.isBuffer=Fi,y.isDate=Bv,y.isElement=kv,y.isEmpty=Vv,y.isEqual=Gv,y.isEqualWith=Wv,y.isError=bc,y.isFinite=Yv,y.isFunction=gi,y.isInteger=bl,y.isLength=$o,y.isMap=El,y.isMatch=Jv,y.isMatchWith=Qv,y.isNaN=Xv,y.isNative=Zv,y.isNil=ty,y.isNull=ey,y.isNumber=Il,y.isObject=Et,y.isObjectLike=Nt,y.isPlainObject=hs,y.isRegExp=Ec,y.isSafeInteger=ry,y.isSet=Sl,y.isString=Fo,y.isSymbol=xr,y.isTypedArray=Tn,y.isUndefined=iy,y.isWeakMap=ny,y.isWeakSet=sy,y.join=c1,y.kebabCase=Wy,y.last=Ur,y.lastIndexOf=u1,y.lowerCase=Yy,y.lowerFirst=Jy,y.lt=oy,y.lte=ay,y.max=Bm,y.maxBy=km,y.mean=Vm,y.meanBy=Gm,y.min=Wm,y.minBy=Ym,y.stubArray=Rc,y.stubFalse=Tc,y.stubObject=$m,y.stubString=Fm,y.stubTrue=Dm,y.multiply=Jm,y.nth=h1,y.noConflict=Pm,y.noop=Nc,y.now=To,y.pad=Qy,y.padEnd=Xy,y.padStart=Zy,y.parseInt=em,y.random=Ky,y.reduce=dv,y.reduceRight=pv,y.repeat=tm,y.replace=rm,y.result=Ly,y.round=Qm,y.runInContext=D,y.sample=vv,y.size=_v,y.snakeCase=im,y.some=wv,y.sortedIndex=y1,y.sortedIndexBy=m1,y.sortedIndexOf=_1,y.sortedLastIndex=w1,y.sortedLastIndexBy=b1,y.sortedLastIndexOf=E1,y.startCase=sm,y.startsWith=om,y.subtract=Xm,y.sum=Zm,y.sumBy=e_,y.template=am,y.times=Um,y.toFinite=vi,y.toInteger=Me,y.toLength=Pl,y.toLower=cm,y.toNumber=Mr,y.toSafeInteger=cy,y.toString=it,y.toUpper=um,y.trim=hm,y.trimEnd=lm,y.trimStart=fm,y.truncate=dm,y.unescape=pm,y.uniqueId=jm,y.upperCase=gm,y.upperFirst=xc,y.each=fl,y.eachRight=dl,y.first=cl,Ac(y,function(){var t={};return Xr(y,function(i,o){nt.call(y.prototype,o)||(t[o]=i)}),t}(),{chain:!1}),y.VERSION=s,Cr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(t){y[t].placeholder=y}),Cr(["drop","take"],function(t,i){Ye.prototype[t]=function(o){o=o===r?1:Bt(Me(o),0);var c=this.__filtered__&&!i?new Ye(this):this.clone();return c.__filtered__?c.__takeCount__=Qt(o,c.__takeCount__):c.__views__.push({size:Qt(o,re),type:t+(c.__dir__<0?"Right":"")}),c},Ye.prototype[t+"Right"]=function(o){return this.reverse()[t](o).reverse()}}),Cr(["filter","map","takeWhile"],function(t,i){var o=i+1,c=o==$||o==le;Ye.prototype[t]=function(d){var m=this.clone();return m.__iteratees__.push({iteratee:_e(d,3),type:o}),m.__filtered__=m.__filtered__||c,m}}),Cr(["head","last"],function(t,i){var o="take"+(i?"Right":"");Ye.prototype[t]=function(){return this[o](1).value()[0]}}),Cr(["initial","tail"],function(t,i){var o="drop"+(i?"":"Right");Ye.prototype[t]=function(){return this.__filtered__?new Ye(this):this[o](1)}}),Ye.prototype.compact=function(){return this.filter(yr)},Ye.prototype.find=function(t){return this.filter(t).head()},Ye.prototype.findLast=function(t){return this.reverse().find(t)},Ye.prototype.invokeMap=Be(function(t,i){return typeof t=="function"?new Ye(this):this.map(function(o){return ns(o,t,i)})}),Ye.prototype.reject=function(t){return this.filter(Lo(_e(t)))},Ye.prototype.slice=function(t,i){t=Me(t);var o=this;return o.__filtered__&&(t>0||i<0)?new Ye(o):(t<0?o=o.takeRight(-t):t&&(o=o.drop(t)),i!==r&&(i=Me(i),o=i<0?o.dropRight(-i):o.take(i-t)),o)},Ye.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},Ye.prototype.toArray=function(){return this.take(re)},Xr(Ye.prototype,function(t,i){var o=/^(?:filter|find|map|reject)|While$/.test(i),c=/^(?:head|last)$/.test(i),d=y[c?"take"+(i=="last"?"Right":""):i],m=c||/^find/.test(i);d&&(y.prototype[i]=function(){var S=this.__wrapped__,N=c?[1]:arguments,U=S instanceof Ye,J=N[0],Q=U||Ce(S),Z=function(Ge){var Xe=d.apply(y,Ai([Ge],N));return c&&ce?Xe[0]:Xe};Q&&o&&typeof J=="function"&&J.length!=1&&(U=Q=!1);var ce=this.__chain__,ve=!!this.__actions__.length,be=m&&!ce,He=U&&!ve;if(!m&&Q){S=He?S:new Ye(this);var Ee=t.apply(S,N);return Ee.__actions__.push({func:No,args:[Z],thisArg:r}),new $r(Ee,ce)}return be&&He?t.apply(this,N):(Ee=this.thru(Z),be?c?Ee.value()[0]:Ee.value():Ee)})}),Cr(["pop","push","shift","sort","splice","unshift"],function(t){var i=eo[t],o=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",c=/^(?:pop|shift)$/.test(t);y.prototype[t]=function(){var d=arguments;if(c&&!this.__chain__){var m=this.value();return i.apply(Ce(m)?m:[],d)}return this[o](function(S){return i.apply(Ce(S)?S:[],d)})}}),Xr(Ye.prototype,function(t,i){var o=y[i];if(o){var c=o.name+"";nt.call(Pn,c)||(Pn[c]=[]),Pn[c].push({name:i,func:o})}}),Pn[Eo(r,ne).name]=[{name:"wrapper",func:r}],Ye.prototype.clone=pg,Ye.prototype.reverse=gg,Ye.prototype.value=vg,y.prototype.at=k1,y.prototype.chain=V1,y.prototype.commit=G1,y.prototype.next=W1,y.prototype.plant=J1,y.prototype.reverse=Q1,y.prototype.toJSON=y.prototype.valueOf=y.prototype.value=X1,y.prototype.first=y.prototype.head,Qn&&(y.prototype[Qn]=Y1),y},In=Gp();Tt?((Tt.exports=In)._=In,ut._=In):Qe._=In}).call(_s)})(gu,gu.exports);var a5=Object.defineProperty,c5=Object.defineProperties,u5=Object.getOwnPropertyDescriptors,cd=Object.getOwnPropertySymbols,h5=Object.prototype.hasOwnProperty,l5=Object.prototype.propertyIsEnumerable,ud=(n,e,r)=>e in n?a5(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,Ho=(n,e)=>{for(var r in e||(e={}))h5.call(e,r)&&ud(n,r,e[r]);if(cd)for(var r of cd(e))l5.call(e,r)&&ud(n,r,e[r]);return n},f5=(n,e)=>c5(n,u5(e));function Mi(n,e,r){var s;const a=Rb(n);return((s=e.rpcMap)==null?void 0:s[a.reference])||`${o5}?chainId=${a.namespace}:${a.reference}&projectId=${r}`}function fn(n){return n.includes(":")?n.split(":")[1]:n}function Ep(n){return n.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function d5(n,e){const r=Object.keys(e.namespaces).filter(a=>a.includes(n));if(!r.length)return[];const s=[];return r.forEach(a=>{const l=e.namespaces[a].accounts;s.push(...l)}),s}function p5(n={},e={}){const r=hd(n),s=hd(e);return gu.exports.merge(r,s)}function hd(n){var e,r,s,a;const l={};if(!Mn(n))return l;for(const[p,f]of Object.entries(n)){const v=Au(p)?[p]:f.chains,g=f.methods||[],_=f.events||[],I=f.rpcMap||{},P=ws(p);l[P]=f5(Ho(Ho({},l[P]),f),{chains:zc(v,(e=l[P])==null?void 0:e.chains),methods:zc(g,(r=l[P])==null?void 0:r.methods),events:zc(_,(s=l[P])==null?void 0:s.events),rpcMap:Ho(Ho({},I),(a=l[P])==null?void 0:a.rpcMap)})}return l}function g5(n){return n.includes(":")?n.split(":")[2]:n}function v5(n){const e={};for(const[r,s]of Object.entries(n)){const a=s.methods||[],l=s.events||[],p=s.accounts||[],f=Au(r)?[r]:s.chains?s.chains:Ep(s.accounts);e[r]={chains:f,methods:a,events:l,accounts:p}}return e}function Yc(n){return typeof n=="number"?n:n.includes("0x")?parseInt(n,16):n.includes(":")?Number(n.split(":")[1]):Number(n)}const Ip={},wt=n=>Ip[n],Jc=(n,e)=>{Ip[n]=e};class y5{constructor(e){this.name="polkadot",this.namespace=e.namespace,this.events=wt("events"),this.client=wt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(e,r),this.chainId=e,this.events.emit(Si.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var s;const a=fn(r);e[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const s=this.createHttpProvider(e,r);s&&(this.httpProviders[e]=s)}createHttpProvider(e,r){const s=r||Mi(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new Ii(new qi(s,wt("disableProviderPing")))}}class m5{constructor(e){this.name="eip155",this.namespace=e.namespace,this.events=wt("events"),this.client=wt("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(parseInt(e),r),this.chainId=parseInt(e),this.events.emit(Si.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,r){const s=r||Mi(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new Ii(new qi(s,wt("disableProviderPing")))}setHttpProvider(e,r){const s=this.createHttpProvider(e,r);s&&(this.httpProviders[e]=s)}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var s;const a=parseInt(fn(r));e[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}getHttpProvider(){const e=this.chainId,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}async handleSwitchChain(e){var r,s;let a=e.request.params?(r=e.request.params[0])==null?void 0:r.chainId:"0x0";a=a.startsWith("0x")?a:`0x${a}`;const l=parseInt(a,16);if(this.isChainApproved(l))this.setDefaultChain(`${l}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:a}]},chainId:(s=this.namespace.chains)==null?void 0:s[0]}),this.setDefaultChain(`${l}`);else throw new Error(`Failed to switch to chain 'eip155:${l}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}}class _5{constructor(e){this.name="solana",this.namespace=e.namespace,this.events=wt("events"),this.client=wt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(e,r),this.chainId=e,this.events.emit(Si.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var s;const a=fn(r);e[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const s=this.createHttpProvider(e,r);s&&(this.httpProviders[e]=s)}createHttpProvider(e,r){const s=r||Mi(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new Ii(new qi(s,wt("disableProviderPing")))}}class w5{constructor(e){this.name="cosmos",this.namespace=e.namespace,this.events=wt("events"),this.client=wt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(e,r),this.chainId=e,this.events.emit(Si.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var s;const a=fn(r);e[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const s=this.createHttpProvider(e,r);s&&(this.httpProviders[e]=s)}createHttpProvider(e,r){const s=r||Mi(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new Ii(new qi(s,wt("disableProviderPing")))}}class b5{constructor(e){this.name="cip34",this.namespace=e.namespace,this.events=wt("events"),this.client=wt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(e,r),this.chainId=e,this.events.emit(Si.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{const s=this.getCardanoRPCUrl(r),a=fn(r);e[a]=this.createHttpProvider(a,s)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}getCardanoRPCUrl(e){const r=this.namespace.rpcMap;if(r)return r[e]}setHttpProvider(e,r){const s=this.createHttpProvider(e,r);s&&(this.httpProviders[e]=s)}createHttpProvider(e,r){const s=r||this.getCardanoRPCUrl(e);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new Ii(new qi(s,wt("disableProviderPing")))}}class E5{constructor(e){this.name="elrond",this.namespace=e.namespace,this.events=wt("events"),this.client=wt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(e,r),this.chainId=e,this.events.emit(Si.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var s;const a=fn(r);e[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const s=this.createHttpProvider(e,r);s&&(this.httpProviders[e]=s)}createHttpProvider(e,r){const s=r||Mi(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new Ii(new qi(s,wt("disableProviderPing")))}}class I5{constructor(e){this.name="multiversx",this.namespace=e.namespace,this.events=wt("events"),this.client=wt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(e,r),this.chainId=e,this.events.emit(Si.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var s;const a=fn(r);e[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const s=this.createHttpProvider(e,r);s&&(this.httpProviders[e]=s)}createHttpProvider(e,r){const s=r||Mi(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new Ii(new qi(s,wt("disableProviderPing")))}}class S5{constructor(e){this.name="near",this.namespace=e.namespace,this.events=wt("events"),this.client=wt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){if(this.chainId=e,!this.httpProviders[e]){const s=r||Mi(`${this.name}:${e}`,this.namespace);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.events.emit(Si.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var s;e[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const s=this.createHttpProvider(e,r);s&&(this.httpProviders[e]=s)}createHttpProvider(e,r){const s=r||Mi(e,this.namespace);return typeof s>"u"?void 0:new Ii(new qi(s,wt("disableProviderPing")))}}var x5=Object.defineProperty,P5=Object.defineProperties,O5=Object.getOwnPropertyDescriptors,ld=Object.getOwnPropertySymbols,A5=Object.prototype.hasOwnProperty,N5=Object.prototype.propertyIsEnumerable,fd=(n,e,r)=>e in n?x5(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,zo=(n,e)=>{for(var r in e||(e={}))A5.call(e,r)&&fd(n,r,e[r]);if(ld)for(var r of ld(e))N5.call(e,r)&&fd(n,r,e[r]);return n},Qc=(n,e)=>P5(n,O5(e));class Mu{constructor(e){this.events=new lr.exports,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=e,this.logger=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Ze.pino(Ze.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||od})),this.disableProviderPing=(e==null?void 0:e.disableProviderPing)||!1}static async init(e){const r=new Mu(e);return await r.initialize(),r}async request(e,r){const[s,a]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:zo({},e),chainId:`${s}:${a}`,topic:this.session.topic})}sendAsync(e,r,s){this.request(e,s).then(a=>r(null,a)).catch(a=>r(a,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:$t("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}removeListener(e,r){this.events.removeListener(e,r)}off(e,r){this.events.off(e,r)}get isWalletConnect(){return!0}async pair(e){this.shouldAbortPairingAttempt=!1;let r=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(r>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:s,approval:a}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});s&&(this.uri=s,this.events.emit("display_uri",s)),await a().then(l=>{this.session=l,this.namespaces||(this.namespaces=v5(l.namespaces),this.persist("namespaces",this.namespaces))}).catch(l=>{if(l.message!==bp)throw l;r++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(e,r){try{if(!this.session)return;const[s,a]=this.validateChain(e);this.getProvider(s).setDefaultChain(a,r)}catch(s){if(!/Please call connect/.test(s.message))throw s}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if(ni(r)){for(const s of r)e.deletePairings?this.client.core.expirer.set(s.topic,0):await this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const e=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[e]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await Uu.init({logger:this.providerOpts.logger||od,relayUrl:this.providerOpts.relayUrl||i5,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(r=>ws(r)))];Jc("client",this.client),Jc("events",this.events),Jc("disableProviderPing",this.disableProviderPing),e.forEach(r=>{if(!this.session)return;const s=d5(r,this.session),a=Ep(s),l=p5(this.namespaces,this.optionalNamespaces),p=Qc(zo({},l[r]),{accounts:s,chains:a});switch(r){case"eip155":this.rpcProviders[r]=new m5({namespace:p});break;case"solana":this.rpcProviders[r]=new _5({namespace:p});break;case"cosmos":this.rpcProviders[r]=new w5({namespace:p});break;case"polkadot":this.rpcProviders[r]=new y5({namespace:p});break;case"cip34":this.rpcProviders[r]=new b5({namespace:p});break;case"elrond":this.rpcProviders[r]=new E5({namespace:p});break;case"multiversx":this.rpcProviders[r]=new I5({namespace:p});break;case"near":this.rpcProviders[r]=new S5({namespace:p});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{const{params:r}=e,{event:s}=r;if(s.name==="accountsChanged"){const a=s.data;a&&ni(a)&&this.events.emit("accountsChanged",a.map(g5))}else if(s.name==="chainChanged"){const a=r.chainId,l=r.event.data,p=ws(a),f=Yc(a)!==Yc(l)?`${p}:${Yc(l)}`:a;this.onChainChanged(f)}else this.events.emit(s.name,s.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:r})=>{var s;const{namespaces:a}=r,l=(s=this.client)==null?void 0:s.session.get(e);this.session=Qc(zo({},l),{namespaces:a}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:r})}),this.client.on("session_delete",async e=>{await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",Qc(zo({},$t("USER_DISCONNECTED")),{data:e.topic}))}),this.on(Si.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){if(!this.rpcProviders[e])throw new Error(`Provider not found: ${e}`);return this.rpcProviders[e]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var r;this.getProvider(e).updateNamespace((r=this.session)==null?void 0:r.namespaces[e])})}setNamespaces(e){const{namespaces:r,optionalNamespaces:s,sessionProperties:a}=e;r&&Object.keys(r).length&&(this.namespaces=r),s&&Object.keys(s).length&&(this.optionalNamespaces=s),this.sessionProperties=a,this.persist("namespaces",r),this.persist("optionalNamespaces",s)}validateChain(e){const[r,s]=(e==null?void 0:e.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[r,s];if(r&&!Object.keys(this.namespaces||{}).map(p=>ws(p)).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&s)return[r,s];const a=ws(Object.keys(this.namespaces)[0]),l=this.rpcProviders[a].getDefaultChain();return[a,l]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}onChainChanged(e,r=!1){var s;if(!this.namespaces)return;const[a,l]=this.validateChain(e);r||this.getProvider(a).setDefaultChain(l),((s=this.namespaces[a])!=null?s:this.namespaces[`${a}:${l}`]).defaultChain=l,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",l)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(e,r){this.client.core.storage.setItem(`${ad}/${e}`,r)}async getFromStore(e){return await this.client.core.storage.getItem(`${ad}/${e}`)}}const R5=Mu,T5="wc",C5="ethereum_provider",L5=`${T5}@2:${C5}:`,$5="https://rpc.walletconnect.com/v1/",vu=["eth_sendTransaction","personal_sign"],F5=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],yu=["chainChanged","accountsChanged"],D5=["chainChanged","accountsChanged","message","disconnect","connect"];var U5=Object.defineProperty,M5=Object.defineProperties,j5=Object.getOwnPropertyDescriptors,dd=Object.getOwnPropertySymbols,q5=Object.prototype.hasOwnProperty,H5=Object.prototype.propertyIsEnumerable,pd=(n,e,r)=>e in n?U5(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,Es=(n,e)=>{for(var r in e||(e={}))q5.call(e,r)&&pd(n,r,e[r]);if(dd)for(var r of dd(e))H5.call(e,r)&&pd(n,r,e[r]);return n},gd=(n,e)=>M5(n,j5(e));function Xo(n){return Number(n[0].split(":")[1])}function Xc(n){return`0x${n.toString(16)}`}function z5(n){const{chains:e,optionalChains:r,methods:s,optionalMethods:a,events:l,optionalEvents:p,rpcMap:f}=n;if(!ni(e))throw new Error("Invalid chains");const v={chains:e,methods:s||vu,events:l||yu,rpcMap:Es({},e.length?{[Xo(e)]:f[Xo(e)]}:{})},g=l==null?void 0:l.filter(A=>!yu.includes(A)),_=s==null?void 0:s.filter(A=>!vu.includes(A));if(!r&&!p&&!a&&!(g!=null&&g.length)&&!(_!=null&&_.length))return{required:e.length?v:void 0};const I=(g==null?void 0:g.length)&&(_==null?void 0:_.length)||!r,P={chains:[...new Set(I?v.chains.concat(r||[]):r)],methods:[...new Set(v.methods.concat(a!=null&&a.length?a:F5))],events:[...new Set(v.events.concat(p!=null&&p.length?p:D5))],rpcMap:f};return{required:e.length?v:void 0,optional:r.length?P:void 0}}class ju{constructor(){this.events=new lr.exports.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=L5,this.on=(e,r)=>(this.events.on(e,r),this),this.once=(e,r)=>(this.events.once(e,r),this),this.removeListener=(e,r)=>(this.events.removeListener(e,r),this),this.off=(e,r)=>(this.events.off(e,r),this),this.parseAccount=e=>this.isCompatibleChainId(e)?this.parseAccountId(e).address:e,this.signer={},this.rpc={}}static async init(e){const r=new ju;return await r.initialize(e),r}async request(e){return await this.signer.request(e,this.formatChainId(this.chainId))}sendAsync(e,r){this.signer.sendAsync(e,r,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(e){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(e);const{required:r,optional:s}=z5(this.rpc);try{const a=await new Promise(async(p,f)=>{var v;this.rpc.showQrModal&&((v=this.modal)==null||v.subscribeModal(g=>{!g.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),f(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(gd(Es({namespaces:Es({},r&&{[this.namespace]:r})},s&&{optionalNamespaces:{[this.namespace]:s}}),{pairingTopic:e==null?void 0:e.pairingTopic})).then(g=>{p(g)}).catch(g=>{f(new Error(g.message))})});if(!a)return;const l=Tb(a.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:l),this.setAccounts(l),this.events.emit("connect",{chainId:Xc(this.chainId)})}catch(a){throw this.signer.logger.error(a),a}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",e=>{const{params:r}=e,{event:s}=r;s.name==="accountsChanged"?(this.accounts=this.parseAccounts(s.data),this.events.emit("accountsChanged",this.accounts)):s.name==="chainChanged"?this.setChainId(this.formatChainId(s.data)):this.events.emit(s.name,s.data),this.events.emit("session_event",e)}),this.signer.on("chainChanged",e=>{const r=parseInt(e);this.chainId=r,this.events.emit("chainChanged",Xc(this.chainId)),this.persist()}),this.signer.on("session_update",e=>{this.events.emit("session_update",e)}),this.signer.on("session_delete",e=>{this.reset(),this.events.emit("session_delete",e),this.events.emit("disconnect",gd(Es({},$t("USER_DISCONNECTED")),{data:e.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",e=>{var r,s;this.rpc.showQrModal&&((r=this.modal)==null||r.closeModal(),(s=this.modal)==null||s.openModal({uri:e})),this.events.emit("display_uri",e)})}switchEthereumChain(e){this.request({method:"wallet_switchEthereumChain",params:[{chainId:e.toString(16)}]})}isCompatibleChainId(e){return typeof e=="string"?e.startsWith(`${this.namespace}:`):!1}formatChainId(e){return`${this.namespace}:${e}`}parseChainId(e){return Number(e.split(":")[1])}setChainIds(e){const r=e.filter(s=>this.isCompatibleChainId(s)).map(s=>this.parseChainId(s));r.length&&(this.chainId=r[0],this.events.emit("chainChanged",Xc(this.chainId)),this.persist())}setChainId(e){if(this.isCompatibleChainId(e)){const r=this.parseChainId(e);this.chainId=r,this.switchEthereumChain(r)}}parseAccountId(e){const[r,s,a]=e.split(":");return{chainId:`${r}:${s}`,address:a}}setAccounts(e){this.accounts=e.filter(r=>this.parseChainId(this.parseAccountId(r).chainId)===this.chainId).map(r=>this.parseAccountId(r).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(e){var r,s;const a=(r=e==null?void 0:e.chains)!=null?r:[],l=(s=e==null?void 0:e.optionalChains)!=null?s:[],p=a.concat(l);if(!p.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const f=a.length?(e==null?void 0:e.methods)||vu:[],v=a.length?(e==null?void 0:e.events)||yu:[],g=(e==null?void 0:e.optionalMethods)||[],_=(e==null?void 0:e.optionalEvents)||[],I=(e==null?void 0:e.rpcMap)||this.buildRpcMap(p,e.projectId),P=(e==null?void 0:e.qrModalOptions)||void 0;return{chains:a==null?void 0:a.map(A=>this.formatChainId(A)),optionalChains:l.map(A=>this.formatChainId(A)),methods:f,events:v,optionalMethods:g,optionalEvents:_,rpcMap:I,showQrModal:!!(e!=null&&e.showQrModal),qrModalOptions:P,projectId:e.projectId,metadata:e.metadata}}buildRpcMap(e,r){const s={};return e.forEach(a=>{s[a]=this.getRpcUrl(a,r)}),s}async initialize(e){if(this.rpc=this.getRpcConfig(e),this.chainId=this.rpc.chains.length?Xo(this.rpc.chains):Xo(this.rpc.optionalChains),this.signer=await R5.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:e.disableProviderPing,relayUrl:e.relayUrl,storageOptions:e.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let r;try{const{WalletConnectModal:s}=await i_(()=>import("./index.97499309.js").then(a=>a.i),["assets/index.97499309.js","assets/index.eea9c5b1.js","assets/index.66a76054.css"]);r=s}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(r)try{this.modal=new r(Es({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch(s){throw this.signer.logger.error(s),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(e){if(!e)return;const{chains:r,optionalChains:s,rpcMap:a}=e;r&&ni(r)&&(this.rpc.chains=r.map(l=>this.formatChainId(l)),r.forEach(l=>{this.rpc.rpcMap[l]=(a==null?void 0:a[l])||this.getRpcUrl(l)})),s&&ni(s)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=s==null?void 0:s.map(l=>this.formatChainId(l)),s.forEach(l=>{this.rpc.rpcMap[l]=(a==null?void 0:a[l])||this.getRpcUrl(l)}))}getRpcUrl(e,r){var s;return((s=this.rpc.rpcMap)==null?void 0:s[e])||`${$5}?chainId=eip155:${e}&projectId=${r||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const e=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),r=this.session.namespaces[`${this.namespace}:${e}`]?this.session.namespaces[`${this.namespace}:${e}`]:this.session.namespaces[this.namespace];this.setChainIds(e?[this.formatChainId(e)]:r==null?void 0:r.accounts),this.setAccounts(r==null?void 0:r.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(e){return typeof e=="string"||e instanceof String?[this.parseAccount(e)]:e.map(r=>this.parseAccount(r))}}const G5=ju;export{G5 as EthereumProvider,D5 as OPTIONAL_EVENTS,F5 as OPTIONAL_METHODS,yu as REQUIRED_EVENTS,vu as REQUIRED_METHODS,ju as default};
